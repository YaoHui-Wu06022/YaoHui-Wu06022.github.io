<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>ROSåŸºç¡€çŸ¥è¯† | ãŒã‚“ã°ã‚ã†</title><meta name="author" content="ä»Šå¤©ç¡å¤Ÿäº†å—"><meta name="copyright" content="ä»Šå¤©ç¡å¤Ÿäº†å—"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æ³¨æ„æ³¨æ„ï¼šå¯ä»¥ç›´æ¥å­¦ä¹ ROS2ï¼Œä¸ç”¨ä»ROSå¼€å§‹ ä»£ç æ¨¡æ¿c++ æ¨¡æ¿ 12345678910#include &quot;ros/ros.h&quot;int main(int argc, char *argv[]){    setlocale(LC_ALL,&quot;&quot;);    ros::init(argc,argv,&quot;&quot;);    ros::Nod">
<meta property="og:type" content="article">
<meta property="og:title" content="ROSåŸºç¡€çŸ¥è¯†">
<meta property="og:url" content="http://yhblogs.cn/posts/626062709.html">
<meta property="og:site_name" content="ãŒã‚“ã°ã‚ã†">
<meta property="og:description" content="æ³¨æ„æ³¨æ„ï¼šå¯ä»¥ç›´æ¥å­¦ä¹ ROS2ï¼Œä¸ç”¨ä»ROSå¼€å§‹ ä»£ç æ¨¡æ¿c++ æ¨¡æ¿ 12345678910#include &quot;ros/ros.h&quot;int main(int argc, char *argv[]){    setlocale(LC_ALL,&quot;&quot;);    ros::init(argc,argv,&quot;&quot;);    ros::Nod">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/ros-logo.png">
<meta property="article:published_time" content="2025-05-19T15:45:57.000Z">
<meta property="article:modified_time" content="2026-01-31T12:00:30.720Z">
<meta property="article:author" content="ä»Šå¤©ç¡å¤Ÿäº†å—">
<meta property="article:tag" content="ğŸ¤–ROS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/ros-logo.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yhblogs.cn/posts/626062709.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ROSåŸºç¡€çŸ¥è¯†',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2026-01-31 12:00:30'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_3319458_ks437t3n4r.css"><link rel="stylesheet" href="/css/modify.css"><link rel="stylesheet" href="/css/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/b_2a1aef95f351a5f7ef72eb81e6838fd6.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">81</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-rili"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="ãŒã‚“ã°ã‚ã†"><img class="site-icon" src="/img/favicon.png"><span class="site-name">ãŒã‚“ã°ã‚ã†</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-shouye"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw iconfont icon-rili"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> æ ‡ç­¾</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">ROSåŸºç¡€çŸ¥è¯†</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2025-05-19T15:45:57.000Z" title="å‘è¡¨äº 2025-05-19 15:45:57">2025-05-19</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">23.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>96åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ROSåŸºç¡€çŸ¥è¯†"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p><font color="Violetred">æ³¨æ„æ³¨æ„</font>ï¼šå¯ä»¥ç›´æ¥å­¦ä¹ ROS2ï¼Œä¸ç”¨ä»ROSå¼€å§‹</p>
<h2 id="ä»£ç æ¨¡æ¿"><a href="#ä»£ç æ¨¡æ¿" class="headerlink" title="ä»£ç æ¨¡æ¿"></a>ä»£ç æ¨¡æ¿</h2><p>c++ æ¨¡æ¿</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">""</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>python æ¨¡æ¿</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	rospy.init_node(<span class="string">""</span>)</span><br><span class="line">    </span><br></pre></td></tr></tbody></table></figure>

<h2 id="ROSç¯å¢ƒæ­å»ºä¸åˆè®¤è¯†"><a href="#ROSç¯å¢ƒæ­å»ºä¸åˆè®¤è¯†" class="headerlink" title="ROSç¯å¢ƒæ­å»ºä¸åˆè®¤è¯†"></a>ROSç¯å¢ƒæ­å»ºä¸åˆè®¤è¯†</h2><h3 id="ROSå®‰è£…"><a href="#ROSå®‰è£…" class="headerlink" title="ROSå®‰è£…"></a>ROSå®‰è£…</h3><p>å…·ä½“ç»†èŠ‚çœ‹æ•™ç¨‹ <a target="_blank" rel="noopener" href="http://www.autolabor.com.cn/book/ROSTutorials/chapter1/12-roskai-fa-gong-ju-an-zhuang.html">1.2 ROSå®‰è£…</a></p>
<p>é‡‡ç”¨è™šæ‹Ÿæœºå®‰è£… ubuntuï¼Œå†å®‰è£… ROS </p>
<p>è™šæ‹Ÿæœºè½¯ä»¶ï¼š<a target="_blank" rel="noopener" href="https://www.virtualbox.org/wiki/Downloads">virtualbox(å…è´¹)</a>  å®˜ç½‘ä¸‹è½½è½¯ä»¶å®‰è£…åŒ…ä»¥åŠæ‹“å±•åŒ…</p>
<p>ubuntuç‰ˆæœ¬ï¼šubuntu-20.04.6  <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/">é•œåƒæ–‡ä»¶ä¸‹è½½åœ°å€</a></p>
<p>åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦ä¿®æ”¹è½¯ä»¶ä¸æ›´æ–°ä¸­çš„ä¸‹è½½è‡ª(ä»¥åå®‰è£…åº“çš„æ—¶å€™ç»å¸¸ä¼šç¢°ä¸Š)</p>
<p>åœ¨è™šæ‹Ÿæœºä¸­å¦‚æœå‡ºç°å³é”®æ²¡æœ‰ååº”çš„æƒ…å†µï¼ŒæŒ‰ä½shiftå†ç‚¹</p>
<p>ROSç‰ˆæœ¬ï¼šNoetic</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-noetic-desktop-full</span><br></pre></td></tr></tbody></table></figure>

<p>é…ç½®ç¯å¢ƒå˜é‡ï¼Œæ–¹ä¾¿åœ¨ä»»æ„ç»ˆç«¯ä¸­ä½¿ç”¨ ROSï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo "source /opt/ros/noetic/setup.bash" &gt;&gt; ~/.bashrc</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></tbody></table></figure>

<p>å®‰è£…æ„å»ºä¾èµ–ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3-rosdep python3-rosinstall python3-rosinstall-generator python3-wstool build-essential</span><br></pre></td></tr></tbody></table></figure>

<p>æµ‹è¯•ROSå®‰è£…ç¯å¢ƒï¼š</p>
<ol>
<li>å¯åŠ¨ä¸‰ä¸ªå‘½ä»¤è¡Œ(ctrl + alt + T)</li>
<li>å‘½ä»¤è¡Œ1é”®å…¥:<code>roscore</code></li>
<li>å‘½ä»¤è¡Œ2é”®å…¥:<code>rosrun turtlesim turtlesim_node</code>(æ­¤æ—¶ä¼šå¼¹å‡ºå›¾å½¢åŒ–ç•Œé¢)</li>
<li>å‘½ä»¤è¡Œ3é”®å…¥:<code>rosrun turtlesim turtle_teleop_key</code>(å¯ä»¥æ§åˆ¶å°ä¹Œé¾Ÿè¿åŠ¨)</li>
</ol>
<p>ä»¥ä¸‹å‘½ä»¤è¡Œå†…å®¹ä¸­[ ]åŒ…å›´çš„ä¸ºæ›¿æ¢å†…å®¹</p>
<p>è¡¥å……ubuntuåˆ›å»ºå³é”®å¿«æ·é”®æ–¹æ³•ï¼š</p>
<ol>
<li>åœ¨ç”¨æˆ·ä¸»ç›®å½•é‡Œæ‰¾åˆ°â€œæ¨¡æ¿â€œæ–‡ä»¶å¤¹</li>
<li>å³é”®åœ¨ç»ˆç«¯æ‰“å¼€ï¼Œ<code>sudo gedit æ–‡æœ¬æ–‡ä»¶</code></li>
<li>ä¿å­˜ï¼Œå¯åœ¨ä»»ä½•æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºæ–‡æœ¬æ–‡ä»¶äº†</li>
</ol>
<h3 id="ROSé›†æˆå¼€å‘ç¯å¢ƒ"><a href="#ROSé›†æˆå¼€å‘ç¯å¢ƒ" class="headerlink" title="ROSé›†æˆå¼€å‘ç¯å¢ƒ"></a>ROSé›†æˆå¼€å‘ç¯å¢ƒ</h3><p>åœ¨åˆšåˆšçš„è¿‡ç¨‹ä¼šå‘ç°ubuntué¢‘ç¹éœ€è¦å¯†ç ï¼Œæ‰“å¼€terminalï¼Œè¾“å…¥seahorseï¼Œç‚¹å‡»å·¦ä¸Šè§’â•å·ï¼Œæ–°å»ºä¸€ä¸ªç©ºé’¥åŒ™ç¯ï¼Œå»ºç«‹å®Œæˆåè®¾ç½®ä¸ºé»˜è®¤ï¼Œæ‰“å¼€ä¸€äº›è½¯ä»¶ä¸å†æç¤ºè¾“å…¥å¯†ç äº†</p>
<h4 id="ç»ˆç«¯"><a href="#ç»ˆç«¯" class="headerlink" title="ç»ˆç«¯"></a>ç»ˆç«¯</h4><p>åœ¨ ROS ä¸­ï¼Œéœ€è¦é¢‘ç¹çš„ä½¿ç”¨åˆ°ç»ˆç«¯ï¼Œä¸”å¯èƒ½éœ€è¦åŒæ—¶å¼€å¯å¤šä¸ªçª—å£ï¼Œæ¨èä½¿ç”¨<strong>Terminator</strong></p>
<p>å®‰è£…ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install terminator</span><br></pre></td></tr></tbody></table></figure>

<p>å¸¸ç”¨å¿«æ·é”®ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Alt+Up                          //ç§»åŠ¨åˆ°ä¸Šé¢çš„ç»ˆç«¯</span><br><span class="line">Alt+Down                        //ç§»åŠ¨åˆ°ä¸‹é¢çš„ç»ˆç«¯</span><br><span class="line">Alt+Left                        //ç§»åŠ¨åˆ°å·¦è¾¹çš„ç»ˆç«¯</span><br><span class="line">Alt+Right                       //ç§»åŠ¨åˆ°å³è¾¹çš„ç»ˆç«¯</span><br><span class="line">Ctrl+Shift+O                    //æ°´å¹³åˆ†å‰²ç»ˆç«¯</span><br><span class="line">Ctrl+Shift+E                    //å‚ç›´åˆ†å‰²ç»ˆç«¯</span><br></pre></td></tr></tbody></table></figure>

<h4 id="VScode"><a href="#VScode" class="headerlink" title="VScode"></a>VScode</h4><p>ä¸‹è½½ï¼š<a target="_blank" rel="noopener" href="https://code.visualstudio.com/docs?start=true%5B">vscode ä¸‹è½½</a>  é€‰æ‹©é€‚ç”¨äºlinuxç³»ç»Ÿçš„.debæ–‡ä»¶</p>
<p>å®‰è£…ï¼š</p>
<ul>
<li>æ–¹å¼1ï¼šåŒå‡»å®‰è£…å³å¯(æˆ–å³å‡»é€‰æ‹©å®‰è£…) [å¯èƒ½ä¼šå‡ºç°æ²¡ååº”æˆ–é—ªé€€è¡Œä¸º]</li>
<li>æ–¹å¼2ï¼š<code>sudo dpkg -i xxxx.deb</code> å¤åˆ¶å…·ä½“çš„ä¸‹è½½æ–‡ä»¶åç§°</li>
</ul>
<p>vscode ä¸‹è½½æ’ä»¶ï¼šc++ï¼ŒCMakeï¼Œpythonï¼ŒROS</p>
<p>å¿«æ·é”®é…ç½®ï¼šå‘ä¸Šå‘ä¸‹å¤åˆ¶è¡Œï¼›å‘ä¸Šå‘ä¸‹ç§»åŠ¨</p>
<p>vscode ä½¿ç”¨_åŸºæœ¬é…ç½®ï¼š</p>
<ol>
<li><p>åˆ›å»º ROS å·¥ä½œç©ºé—´</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p [å·¥ä½œç©ºé—´åç§°]/src(å¿…é¡»å¾—æœ‰ src)</span><br><span class="line">cd [å·¥ä½œç©ºé—´åç§°]</span><br><span class="line">catkin_make</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>å¯åŠ¨ vscode</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code .</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>vscode ä¸­ç¼–è¯‘ ros</p>
<p>å¿«æ·é”® ctrl + shift + B è°ƒç”¨ç¼–è¯‘ï¼Œé€‰æ‹©<code>catkin_make:build</code>å³è¾¹çš„å°é½¿è½®é…ç½®</p>
<p>ä¿®æ”¹<code>.vscode/tasks.json </code>æ–‡ä»¶</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"version"</span><span class="punctuation">:</span> <span class="string">"2.0.0"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"tasks"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"label"</span><span class="punctuation">:</span> <span class="string">"catkin_make:debug"</span><span class="punctuation">,</span> <span class="comment">//ä»£è¡¨æç¤ºçš„æè¿°æ€§ä¿¡æ¯</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"shell"</span><span class="punctuation">,</span>  <span class="comment">//å¯ä»¥é€‰æ‹©shellæˆ–è€…process,å¦‚æœæ˜¯shellä»£ç æ˜¯åœ¨shellé‡Œé¢è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œå¦‚æœæ˜¯processä»£è¡¨ä½œä¸ºä¸€ä¸ªè¿›ç¨‹æ¥è¿è¡Œ</span></span><br><span class="line">            <span class="attr">"command"</span><span class="punctuation">:</span> <span class="string">"catkin_make"</span><span class="punctuation">,</span><span class="comment">//è¿™ä¸ªæ˜¯æˆ‘ä»¬éœ€è¦è¿è¡Œçš„å‘½ä»¤</span></span><br><span class="line">            <span class="attr">"args"</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="comment">//å¦‚æœéœ€è¦åœ¨å‘½ä»¤åé¢åŠ ä¸€äº›åç¼€ï¼Œå¯ä»¥å†™åœ¨è¿™é‡Œï¼Œæ¯”å¦‚-DCATKIN_WHITELIST_PACKAGES=â€œpac1;pac2â€</span></span><br><span class="line">            <span class="attr">"group"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="attr">"kind"</span><span class="punctuation">:</span><span class="string">"build"</span><span class="punctuation">,</span><span class="attr">"isDefault"</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"presentation"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"reveal"</span><span class="punctuation">:</span> <span class="string">"always"</span><span class="comment">//å¯é€‰alwaysæˆ–è€…silenceï¼Œä»£è¡¨æ˜¯å¦è¾“å‡ºä¿¡æ¯</span></span><br><span class="line">            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"problemMatcher"</span><span class="punctuation">:</span> <span class="string">"$msCompile"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>åˆ›å»º ROS åŠŸèƒ½åŒ…</p>
<p><font color="Violetred">é€‰å®š src å³å‡» â€”&gt; create catkin package</font></p>
<p>è®¾ç½®åŒ…å(helloworld) æ·»åŠ ä¾èµ–(roscpp rospy std_msgs)</p>
</li>
<li><p>C++ å®ç°</p>
<p>åœ¨åŠŸèƒ½åŒ…çš„ src ä¸‹æ–°å»º cpp æ–‡ä»¶</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="comment">// è§£å†³ä¸­æ–‡ä¹±ç </span></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"hello_c"</span>);</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"hello vscode"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>å¦‚æœæ²¡æœ‰ä»£ç æç¤º</p>
<p>ä¿®æ”¹ <code>.vscode/c_cpp_properties.json</code>ï¼Œè®¾ç½® â€œcppStandardâ€: â€œc++17â€</p>
<p>åˆ™ctrl+shift+ç©ºæ ¼æç¤ºå‡½æ•°æ ¼å¼</p>
</li>
<li><p>python å®ç°</p>
<p>åœ¨ åŠŸèƒ½åŒ… ä¸‹æ–°å»º scripts æ–‡ä»¶å¤¹ï¼Œæ·»åŠ  python æ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"hello_p"</span>)</span><br><span class="line">    rospy.loginfo(<span class="string">"hello vscode! it's python"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><font color="Violetred">åœ¨scriptsæ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ç»ˆç«¯</font>å¹¶æ·»åŠ å¯æ‰§è¡Œæƒé™</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x *.py</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>é…ç½® CMakeLists.txt</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">add_executable([è‡ªå®šä¹‰åç§°]</span><br><span class="line">  src/helloworld_c.cpp</span><br><span class="line">)</span><br><span class="line">target_link_libraries([è‡ªå®šä¹‰åç§°]</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">catkin_install_python(PROGRAMS scripts/[æ–‡ä»¶å].py</span><br><span class="line">  DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ç¼–è¯‘æ‰§è¡Œ</p>
<p>ç¼–è¯‘ï¼šctrl + shift + B</p>
<p>æ‰§è¡Œï¼šåœ¨ VScode ä¸­æ·»åŠ ç»ˆç«¯</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roscore</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ./devel/setup.bash</span><br></pre></td></tr></tbody></table></figure>

<p>c++ï¼šrosrun [åŒ…å] [<font color="Violetred">è‡ªå®šä¹‰åç§°</font>]</p>
<p>pythonï¼šrosrun [åŒ…å] [<font color="Violetred">æ–‡ä»¶åç§°</font>]</p>
<p>å¦‚æœä¸ç¼–è¯‘ç›´æ¥æ‰§è¡Œ python æ–‡ä»¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</p>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<ol>
<li>ç¬¬ä¸€è¡Œè§£é‡Šå™¨å£°æ˜ï¼Œå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„å®šä½åˆ° python3 çš„å®‰è£…è·¯å¾„ #! /usr/bin/python3(ä¸å»ºè®®)</li>
<li>åˆ›å»ºä¸€ä¸ªé“¾æ¥ç¬¦å·åˆ° python å‘½ä»¤ï¼š<code>sudo ln -s /usr/bin/python3 /usr/bin/python</code>(å»ºè®®)</li>
</ol>
</li>
</ol>
<h4 id="launchæ–‡ä»¶"><a href="#launchæ–‡ä»¶" class="headerlink" title="launchæ–‡ä»¶"></a>launchæ–‡ä»¶</h4><p>è§£å†³éœ€è¦å¯åŠ¨å¤šä¸ªèŠ‚ç‚¹çš„æ•ˆç‡é—®é¢˜</p>
<p>å®ç°ï¼š</p>
<ol>
<li><p>é€‰å®šåŠŸèƒ½åŒ…å³å‡» â€”&gt; æ·»åŠ  launch æ–‡ä»¶å¤¹</p>
</li>
<li><p>é€‰å®š launch æ–‡ä»¶å¤¹å³å‡» â€”&gt; æ·»åŠ  launch æ–‡ä»¶</p>
</li>
<li><p>ç¼–è¾‘ launch æ–‡ä»¶å†…å®¹</p>
<p>ä»¥å°ä¹Œé¾Ÿç¤ºä¾‹ç¨‹åºå¯åŠ¨ä¸ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- ä¹Œé¾ŸGUI --&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="turtle_GUI" /&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtle_teleop_key" name="turtle_key" /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>node â€”&gt; åŒ…å«çš„æŸä¸ªèŠ‚ç‚¹</li>
<li>pkg â€”â€“&gt; åŠŸèƒ½åŒ…</li>
<li>type â€”-&gt; è¢«è¿è¡Œçš„èŠ‚ç‚¹æ–‡ä»¶</li>
<li>name â€“&gt; ä¸ºèŠ‚ç‚¹å‘½å</li>
<li>output-&gt; è®¾ç½®æ—¥å¿—çš„è¾“å‡ºç›®æ ‡</li>
</ul>
</li>
<li><p>è¿è¡Œ launch æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch [åŠŸèƒ½åŒ…å] [launchæ–‡ä»¶å]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>è¿è¡Œç»“æœï¼šä¸€æ¬¡æ€§å¯åŠ¨äº†å¤šä¸ªèŠ‚ç‚¹</p>
</li>
</ol>
<h3 id="ROSæ¶æ„"><a href="#ROSæ¶æ„" class="headerlink" title="ROSæ¶æ„"></a>ROSæ¶æ„</h3><h4 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h4><img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/ROS_file.jpg" alt="ROS_file">

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">WorkSpace --- è‡ªå®šä¹‰çš„å·¥ä½œç©ºé—´</span><br><span class="line"></span><br><span class="line">    |--- build:ç¼–è¯‘ç©ºé—´ï¼Œç”¨äºå­˜æ”¾CMakeå’Œcatkinçš„ç¼“å­˜ä¿¡æ¯ã€é…ç½®ä¿¡æ¯å’Œå…¶ä»–ä¸­é—´æ–‡ä»¶ã€‚</span><br><span class="line"></span><br><span class="line">    |--- devel:å¼€å‘ç©ºé—´ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘åç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ï¼ŒåŒ…æ‹¬å¤´æ–‡ä»¶ã€åŠ¨æ€&amp;é™æ€é“¾æ¥åº“ã€å¯æ‰§è¡Œæ–‡ä»¶ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">    |--- src: æºç </span><br><span class="line"></span><br><span class="line">        |-- packageï¼šåŠŸèƒ½åŒ…(ROSåŸºæœ¬å•å…ƒ)åŒ…å«å¤šä¸ªèŠ‚ç‚¹ã€åº“ä¸é…ç½®æ–‡ä»¶ï¼ŒåŒ…åæ‰€æœ‰å­—æ¯å°å†™ï¼Œåªèƒ½ç”±å­—æ¯ã€æ•°å­—ä¸ä¸‹åˆ’çº¿ç»„æˆ</span><br><span class="line"></span><br><span class="line">            |-- CMakeLists.txt é…ç½®ç¼–è¯‘è§„åˆ™ï¼Œæ¯”å¦‚æºæ–‡ä»¶ã€ä¾èµ–é¡¹ã€ç›®æ ‡æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- package.xml åŒ…ä¿¡æ¯ï¼Œæ¯”å¦‚:åŒ…åã€ç‰ˆæœ¬ã€ä½œè€…ã€ä¾èµ–é¡¹...(ä»¥å‰ç‰ˆæœ¬æ˜¯ manifest.xml)</span><br><span class="line"></span><br><span class="line">            |-- scripts å­˜å‚¨pythonæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- src å­˜å‚¨C++æºæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- include å¤´æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- msg æ¶ˆæ¯é€šä¿¡æ ¼å¼æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- srv æœåŠ¡é€šä¿¡æ ¼å¼æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- action åŠ¨ä½œæ ¼å¼æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">            |-- launch å¯ä¸€æ¬¡æ€§è¿è¡Œå¤šä¸ªèŠ‚ç‚¹ </span><br><span class="line"></span><br><span class="line">            |-- config é…ç½®ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">        |-- CMakeLists.txt: ç¼–è¯‘çš„åŸºæœ¬é…ç½®</span><br></pre></td></tr></tbody></table></figure>

<h4 id="æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤"><a href="#æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤"></a>æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤</h4><ol>
<li><p>å¢</p>
<p>catkin_create_pkg è‡ªå®šä¹‰åŒ…å ä¾èµ–åŒ… === åˆ›å»ºæ–°çš„ROSåŠŸèƒ½åŒ…</p>
<p>sudo apt install xxx === å®‰è£… ROSåŠŸèƒ½åŒ…</p>
</li>
<li><p>åˆ </p>
<p>sudo apt purge xxx === åˆ é™¤æŸä¸ªåŠŸèƒ½åŒ…</p>
</li>
<li><p>æŸ¥</p>
<p>rospack list === åˆ—å‡ºæ‰€æœ‰åŠŸèƒ½åŒ…</p>
<p>rospack find åŒ…å === æŸ¥æ‰¾æŸä¸ªåŠŸèƒ½åŒ…æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨è¿”å›å®‰è£…è·¯å¾„</p>
<p>roscd åŒ…å === è¿›å…¥æŸä¸ªåŠŸèƒ½åŒ…</p>
<p>rosls åŒ…å === åˆ—å‡ºæŸä¸ªåŒ…ä¸‹çš„æ–‡ä»¶</p>
<p>apt search xxx === æœç´¢æŸä¸ªåŠŸèƒ½åŒ…</p>
</li>
<li><p>rosed åŒ…å æ–‡ä»¶å === ä¿®æ”¹åŠŸèƒ½åŒ…æ–‡ä»¶</p>
<p>éœ€è¦å®‰è£… vim</p>
<p>æ¯”å¦‚:rosed turtlesim Color.msg</p>
</li>
<li><p>æ‰§è¡Œ</p>
<p>roscore === æ˜¯ ROS çš„ç³»ç»Ÿå…ˆå†³æ¡ä»¶èŠ‚ç‚¹å’Œç¨‹åºçš„é›†åˆï¼Œ å¿…é¡»è¿è¡Œ roscore æ‰èƒ½ä½¿ ROS èŠ‚ç‚¹è¿›è¡Œé€šä¿¡</p>
<p>roscore å°†å¯åŠ¨:</p>
<ul>
<li>ros master</li>
<li>ros å‚æ•°æœåŠ¡å™¨</li>
<li>rosout æ—¥å¿—èŠ‚ç‚¹</li>
</ul>
<p>rosrun åŒ…å å¯æ‰§è¡Œæ–‡ä»¶å === è¿è¡ŒæŒ‡å®šçš„ROSèŠ‚ç‚¹</p>
<p>æ¯”å¦‚:<code>rosrun turtlesim turtlesim_node</code></p>
<p>roslaunch åŒ…å launchæ–‡ä»¶å === æ‰§è¡ŒæŸä¸ªåŒ…ä¸‹çš„ launch æ–‡ä»¶</p>
</li>
</ol>
<h4 id="è®¡ç®—å›¾"><a href="#è®¡ç®—å›¾" class="headerlink" title="è®¡ç®—å›¾"></a>è®¡ç®—å›¾</h4><p>rqt_graphèƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªæ˜¾ç¤ºå½“å‰ç³»ç»Ÿè¿è¡Œæƒ…å†µçš„åŠ¨æ€å›¾å½¢</p>
<p>è®¡ç®—å›¾å¯ä»¥ä»¥ç‚¹å¯¹ç‚¹çš„ç½‘ç»œå½¢å¼è¡¨ç°æ•°æ®äº¤äº’è¿‡ç¨‹</p>
<p>è¿è¡Œç¨‹åºåï¼Œå¯åŠ¨æ–°ç»ˆç«¯ï¼Œé”®å…¥:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rqt_graph</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun rqt_graph rqt_graph</span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥çœ‹åˆ°ç½‘ç»œæ‹“æ‰‘å›¾ï¼Œæ˜¾ç¤ºä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»</p>
<h2 id="ROSé€šä¿¡æœºåˆ¶"><a href="#ROSé€šä¿¡æœºåˆ¶" class="headerlink" title="ROSé€šä¿¡æœºåˆ¶"></a>ROSé€šä¿¡æœºåˆ¶</h2><h3 id="è¯é¢˜é€šä¿¡"><a href="#è¯é¢˜é€šä¿¡" class="headerlink" title="è¯é¢˜é€šä¿¡"></a>è¯é¢˜é€šä¿¡</h3><p>è¯é¢˜é€šä¿¡æ˜¯ROSä¸­ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„ä¸€ç§é€šä¿¡æ¨¡å¼ï¼ŒåŸºäº<strong>å‘å¸ƒè®¢é˜…</strong>æ¨¡å¼ï¼Œå³ä¸€ä¸ªèŠ‚ç‚¹å‘å¸ƒæ¶ˆæ¯ï¼Œå¦ä¸€ä¸ªèŠ‚ç‚¹è®¢é˜…è¯¥æ¶ˆæ¯</p>
<p>ä»¥æ¿€å…‰é›·è¾¾ä¿¡æ¯çš„é‡‡é›†å¤„ç†ä¸ºä¾‹ï¼Œåœ¨ ROS ä¸­æœ‰ä¸€ä¸ªèŠ‚ç‚¹éœ€è¦æ—¶æ—¶çš„å‘å¸ƒå½“å‰é›·è¾¾é‡‡é›†åˆ°çš„æ•°æ®ï¼Œå¯¼èˆªæ¨¡å—ä¸­ä¹Ÿæœ‰èŠ‚ç‚¹ä¼šè®¢é˜…å¹¶è§£æé›·è¾¾æ•°æ®</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œåƒé›·è¾¾ã€æ‘„åƒå¤´ã€GPSâ€¦. ç­‰ç­‰ä¸€äº›ä¼ æ„Ÿå™¨æ•°æ®çš„é‡‡é›†éƒ½ä½¿ç”¨äº†è¯é¢˜é€šä¿¡</p>
<p><font color="Violetred">è¯é¢˜é€šä¿¡é€‚ç”¨äºä¸æ–­æ›´æ–°ã€å°‘é€»è¾‘å¤„ç†çš„æ•°æ®ä¼ è¾“åœºæ™¯</font></p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/image-20250519215104543_compressed (1).webp" alt="image-20250519215104543_compressed (1)" style="zoom:67%;">

<ul>
<li>åœ¨å·¥ä½œç©ºé—´ä¸‹åŠŸèƒ½åŒ…ä¸­ï¼ŒåŸºæœ¬æ¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶éƒ½ä¼šåˆå§‹åŒ–ä¸€ä¸ªèŠ‚ç‚¹(node)ï¼Œå¹¶å”¯ä¸€å‘½å</li>
<li>èŠ‚ç‚¹ä¹‹é—´é€šè¿‡è¯é¢˜(topic)è¿›è¡Œé€šä¿¡</li>
<li>è¯é¢˜ç±»å‹å°±æ˜¯å‘å¸ƒçš„æ¶ˆæ¯(msg)</li>
<li>ä¼ è¾“çš„å†…å®¹éœ€è¦å…³æ³¨æ¶ˆæ¯ç±»å‹</li>
</ul>
<h4 id="æ™®é€šæ–‡æœ¬"><a href="#æ™®é€šæ–‡æœ¬" class="headerlink" title="æ™®é€šæ–‡æœ¬"></a>æ™®é€šæ–‡æœ¬</h4><p>éœ€æ±‚: å®ç°åŸºæœ¬çš„è¯é¢˜é€šä¿¡ï¼Œä¸€æ–¹å‘å¸ƒæ•°æ®ï¼Œä¸€æ–¹æ¥æ”¶æ•°æ®</p>
<p><strong>c++å®ç°</strong></p>
<p>åœ¨æ¨¡å‹å®ç°ä¸­ï¼ŒROS master ä¸éœ€è¦å®ç°ï¼Œè€Œè¿æ¥çš„å»ºç«‹ä¹Ÿå·²ç»è¢«å°è£…äº†ï¼Œéœ€è¦å…³æ³¨ï¼š</p>
<ol>
<li>å‘å¸ƒæ–¹</li>
<li>æ¥æ”¶æ–¹</li>
<li>æ•°æ®</li>
</ol>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"std_msgs/String.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    å‘å¸ƒæ–¹å®ç°ï¼š</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶ </span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line"><span class="comment">        3.åˆ›å»ºèŠ‚ç‚¹å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»ºå‘å¸ƒè€…å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.ç¼–å†™å‘å¸ƒé€»è¾‘å¹¶å‘å¸ƒæ•°æ®</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{   </span><br><span class="line">    <span class="comment">// è®¾ç½®ç¼–ç æ ¼å¼</span></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="comment">// 2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"talker"</span>);</span><br><span class="line">    <span class="comment">// 3.åˆ›å»ºèŠ‚ç‚¹å¥æŸ„</span></span><br><span class="line">    ros::NodeHandle nh; <span class="comment">//è¯¥ç±»å°è£…äº† ROS ä¸­çš„ä¸€äº›å¸¸ç”¨åŠŸèƒ½</span></span><br><span class="line">    <span class="comment">// 4.åˆ›å»ºå‘å¸ƒè€…å¯¹è±¡</span></span><br><span class="line">    <span class="comment">//æ³›å‹: å‘å¸ƒçš„æ¶ˆæ¯ç±»å‹</span></span><br><span class="line">    <span class="comment">//å‚æ•°1: è¦å‘å¸ƒåˆ°çš„è¯é¢˜</span></span><br><span class="line">    <span class="comment">//å‚æ•°2: é˜Ÿåˆ—ä¸­æœ€å¤§ä¿å­˜çš„æ¶ˆæ¯æ•°ï¼Œè¶…å‡ºæ­¤é˜€å€¼æ—¶ï¼Œæ—©æ¥å—åˆ°çš„é”€æ¯</span></span><br><span class="line">    ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">"chatter"</span>,<span class="number">10</span>);</span><br><span class="line">    <span class="comment">// 5.ç¼–å†™å‘å¸ƒé€»è¾‘å¹¶å‘å¸ƒæ•°æ®</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºå‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">    std_msgs::String msg;</span><br><span class="line">    <span class="comment">// åˆ†å¸ƒé¢‘ç‡</span></span><br><span class="line">    <span class="function">ros::Rate <span class="title">rate</span> <span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="comment">// è®¾ç½®ç¼–å·</span></span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ç¼–å†™å¾ªç¯</span></span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// å®ç°å­—ç¬¦ä¸²æ‹¼æ¥</span></span><br><span class="line">        std::stringstream ss;</span><br><span class="line">        ss &lt;&lt; <span class="string">"hello ---"</span>&lt;&lt; count;</span><br><span class="line">        msg.data = ss.<span class="built_in">str</span>();</span><br><span class="line">        pub.<span class="built_in">publish</span>(msg);</span><br><span class="line">        <span class="comment">//  æ·»åŠ æ—¥å¿—</span></span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"å‘å¸ƒçš„æ•°æ®: %s"</span>,ss.<span class="built_in">str</span>().<span class="built_in">c_str</span>());</span><br><span class="line">        count++;</span><br><span class="line">        <span class="comment">//æ ¹æ®å‰é¢åˆ¶å®šçš„å‘é€é¢‘ç‡è‡ªåŠ¨ä¼‘çœ </span></span><br><span class="line">        rate.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>(); </span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>æ¥æ”¶æ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"std_msgs/String.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    è®¢é˜…æ–¹å®ç°ï¼š</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶ </span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line"><span class="comment">        3.åˆ›å»ºèŠ‚ç‚¹å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»ºè®¢é˜…è€…å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.å¤„ç†è®¢é˜…æ•°æ®</span></span><br><span class="line"><span class="comment">        6.è®¾ç½®å¾ªç¯è°ƒç”¨å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doMsg</span><span class="params">(<span class="type">const</span> std_msgs::String::ConstPtr&amp; msg)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"æˆ‘å¬è§: %s"</span>,msg-&gt;data.<span class="built_in">c_str</span>());</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="comment">// è®¾ç½®ç¼–ç æ ¼å¼</span></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="comment">// 2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"listener"</span>);</span><br><span class="line">    <span class="comment">// 3.åˆ›å»ºèŠ‚ç‚¹å¥æŸ„</span></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// 4.åˆ›å»ºè®¢é˜…è€…å¯¹è±¡</span></span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>(<span class="string">"chatter"</span>,<span class="number">10</span>,doMsg);</span><br><span class="line">    <span class="comment">// 5.å¤„ç†è®¢é˜…æ•°æ®</span></span><br><span class="line">    ros::<span class="built_in">spin</span>(); <span class="comment">// å¾ªç¯è¯»å–æ¥æ”¶çš„æ•°æ®ï¼Œå¹¶è°ƒç”¨å›è°ƒå‡½æ•°å¤„ç†</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p><code>ConstPtr</code> æ˜¯ <code>boost::shared_ptr</code>ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰ï¼Œå³ <code>msg</code> æ˜¯ä¸€ä¸ª<strong>æŒ‡é’ˆ</strong></p>
<p>å¿…é¡»ç”¨ <code>-&gt;</code> è®¿é—®å…¶æˆå‘˜çš„ <code>data</code> å­—æ®µ</p>
</blockquote>
<p>é…ç½®CmakeList.txt</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">add_executable(demo01_pub src/demo01_pub.cpp)</span><br><span class="line">add_executable(demo02_sub src/demo02_sub.cpp)</span><br><span class="line">target_link_libraries(demo01_pub</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">target_link_libraries(demo02_sub</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p>vscode ä¸­çš„ main å‡½æ•° å£°æ˜ <code>int main(int argc, char const *argv[]){}</code>ï¼Œé»˜è®¤ç”Ÿæˆ argv è¢« const ä¿®é¥°ï¼Œéœ€è¦å»é™¤è¯¥ä¿®é¥°ç¬¦</p>
<p><strong>pythonå®ç°</strong></p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="string">""" </span></span><br><span class="line"><span class="string">å®ç°æµç¨‹:</span></span><br><span class="line"><span class="string">    1.å¯¼åŒ… </span></span><br><span class="line"><span class="string">    2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line"><span class="string">    3.å®ä¾‹åŒ– å‘å¸ƒè€… å¯¹è±¡</span></span><br><span class="line"><span class="string">    4.ç»„ç»‡è¢«å‘å¸ƒçš„æ•°æ®ï¼Œå¹¶ç¼–å†™é€»è¾‘å‘å¸ƒæ•°æ®</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment">#2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line">    rospy.init_node(<span class="string">"talker_p"</span>)</span><br><span class="line">    <span class="comment">#3.å®ä¾‹åŒ– å‘å¸ƒè€… å¯¹è±¡</span></span><br><span class="line">    pub = rospy.Publisher(<span class="string">"chatter_p"</span>,String,queue_size= <span class="number">10</span> )</span><br><span class="line">    <span class="comment">#4.ç»„ç»‡è¢«å‘å¸ƒçš„æ•°æ®ï¼Œå¹¶ç¼–å†™é€»è¾‘å‘å¸ƒæ•°æ®</span></span><br><span class="line">    msg = String()</span><br><span class="line">    <span class="comment">#æŒ‡å®šå‘å¸ƒé¢‘ç‡</span></span><br><span class="line">    rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line">    <span class="comment">#è®¾ç½®è®¡æ•°å™¨</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="comment">#å¾ªç¯å‘å¸ƒæ•°æ®</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        count+=<span class="number">1</span></span><br><span class="line">        msg.data = <span class="string">"hello---"</span>+<span class="built_in">str</span>(count)</span><br><span class="line">        <span class="comment">#å‘å¸ƒæ•°æ®</span></span><br><span class="line">        pub.publish(msg)</span><br><span class="line">        rate.sleep()</span><br><span class="line">        rospy.loginfo(<span class="string">"å†™å…¥çš„æ•°æ®ï¼š%s"</span>,msg.data)</span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="string">""" </span></span><br><span class="line"><span class="string">    å®ç°æµç¨‹:</span></span><br><span class="line"><span class="string">        1.å¯¼åŒ… </span></span><br><span class="line"><span class="string">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line"><span class="string">        3.å®ä¾‹åŒ– è®¢é˜…è€… å¯¹è±¡</span></span><br><span class="line"><span class="string">        4.å¤„ç†è®¢é˜…çš„æ¶ˆæ¯(å›è°ƒå‡½æ•°)</span></span><br><span class="line"><span class="string">        5.è®¾ç½®å¾ªç¯è°ƒç”¨å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="string"> """</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doMsg</span>(<span class="params">msg</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">"I heard:%s"</span>,msg.data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment"># 2.åˆå§‹åŒ– ROS èŠ‚ç‚¹:å‘½å(å”¯ä¸€)</span></span><br><span class="line">    rospy.init_node(<span class="string">"listener_p"</span>)</span><br><span class="line">    <span class="comment"># 3.å®ä¾‹åŒ– è®¢é˜…è€… å¯¹è±¡</span></span><br><span class="line">    sub = rospy.Subscriber(<span class="string">"chatter_p"</span>,String,doMsg,queue_size=<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># 4.å¤„ç†è®¢é˜…çš„æ¶ˆæ¯(å›è°ƒå‡½æ•°)  </span></span><br><span class="line">    <span class="comment"># 5.è®¾ç½®å¾ªç¯è°ƒç”¨å›è°ƒå‡½æ•°   </span></span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>æ·»åŠ å¯æ‰§è¡Œæƒé™</p>
<p>ç»ˆç«¯ä¸‹è¿›å…¥ scripts æ‰§è¡Œï¼š<code>chmod +x *.py</code></p>
<p>é…ç½® CMakeLists.txtï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">catkin_install_python(PROGRAMS</span><br><span class="line">  scripts/demo01_pub_p.py</span><br><span class="line">  scripts/demo02_sub_p.py</span><br><span class="line">  DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="è‡ªå®šä¹‰msg"><a href="#è‡ªå®šä¹‰msg" class="headerlink" title="è‡ªå®šä¹‰msg"></a>è‡ªå®šä¹‰msg</h4><p>msgsåªæ˜¯ç®€å•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ¯è¡Œå…·æœ‰å­—æ®µç±»å‹å’Œå­—æ®µåç§°</p>
<p>å¦‚æœéœ€è¦è‡ªå®šä¹‰æ¶ˆæ¯ç±»å‹ï¼Œåˆ™éœ€è¦è‡ªå®šä¹‰msg</p>
<p>æµç¨‹ï¼š</p>
<ol>
<li>æŒ‰ç…§å›ºå®šæ ¼å¼åˆ›å»º msg æ–‡ä»¶</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶</li>
<li>ç¼–è¯‘ç”Ÿæˆå¯ä»¥è¢« Python æˆ– C++ è°ƒç”¨çš„ä¸­é—´æ–‡ä»¶</li>
</ol>
<p>åˆ›å»ºè‡ªå®šä¹‰æ¶ˆæ¯</p>
<ol>
<li><p>å®šä¹‰msgæ–‡ä»¶</p>
<p>åŠŸèƒ½åŒ…ä¸‹æ–°å»º msg ç›®å½•ï¼Œæ·»åŠ æ–‡ä»¶ Person.msg</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string name</span><br><span class="line">uint16 age</span><br><span class="line">float64 height</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ç¼–è¾‘é…ç½®æ–‡ä»¶</p>
<p><strong>package.xml</strong>ä¸­æ·»åŠ ç¼–è¯‘ä¾èµ–ä¸æ‰§è¡Œä¾èµ–</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;</span><br><span class="line">&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>CMakeLists.txt</strong>ç¼–è¾‘ msg ç›¸å…³é…ç½®</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  message_generation</span><br><span class="line">)</span><br><span class="line"># éœ€è¦åŠ å…¥ message_generation,å¿…é¡»æœ‰ std_msgs</span><br><span class="line">...</span><br><span class="line"># é…ç½® msg æºæ–‡ä»¶</span><br><span class="line">add_message_files(</span><br><span class="line">  FILES</span><br><span class="line">  Person.msg</span><br><span class="line">)</span><br><span class="line">...</span><br><span class="line"># æ‰§è¡Œæ—¶ä¾èµ–</span><br><span class="line">catkin_package(</span><br><span class="line">#  INCLUDE_DIRS include</span><br><span class="line">#  LIBRARIES demo02_talker_listener</span><br><span class="line">  CATKIN_DEPENDS roscpp rospy std_msgs message_runtime</span><br><span class="line">#  DEPENDS system_lib</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p>ç¼–è¯‘ä¾èµ–find_packageå†…çš„åŒ…</p>
<p>find_packageä¾èµ–catkin_packageå†…çš„åŒ…</p>
<p>å¦‚æœcatkin_packageå†…çš„åŒ…ä¸å¯¹ï¼Œå¯èƒ½ç¼–è¯‘æˆåŠŸä½†è¿è¡Œå¤±è´¥</p>
</li>
<li><p>ç¼–è¯‘</p>
<p>ç¼–è¯‘åæŸ¥çœ‹</p>
<p>C++ éœ€è¦è°ƒç”¨çš„ä¸­é—´æ–‡ä»¶(â€¦/å·¥ä½œç©ºé—´/devel/include/åŒ…å/xxx.h)</p>
<p>Python éœ€è¦è°ƒç”¨çš„ä¸­é—´æ–‡ä»¶(â€¦/å·¥ä½œç©ºé—´/devel/lib/python3/msg/xxx.py)</p>
</li>
</ol>
<p><strong>c++å®ç°</strong></p>
<p>éœ€è¦å…ˆé…ç½® vscodeï¼Œå°†å‰é¢ç”Ÿæˆçš„ head æ–‡ä»¶è·¯å¾„é…ç½®è¿› c_cpp_properties.json çš„ includepathå±æ€§</p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_pub_sub/Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"å‘å¸ƒæ–¹ï¼š"</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"talker_person"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;plumbing_pub_sub::Person&gt;(<span class="string">"chatter_person"</span>,<span class="number">1000</span>);</span><br><span class="line">    plumbing_pub_sub::Person p;</span><br><span class="line">    p.name = <span class="string">"å­™æ‚Ÿç©º"</span>;</span><br><span class="line">    p.age = <span class="number">2000</span>;</span><br><span class="line">    p.height = <span class="number">1.45</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        pub.<span class="built_in">publish</span>(p);</span><br><span class="line">        p.age += <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"æˆ‘å«:%s,ä»Šå¹´%då²,é«˜%.2fç±³"</span>, p.name.<span class="built_in">c_str</span>(), p.age, p.height);</span><br><span class="line"></span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_pub_sub/Person.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPerson</span><span class="params">(<span class="type">const</span> plumbing_pub_sub::Person::ConstPtr&amp; person)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"è®¢é˜…çš„äººä¿¡æ¯:%s,%d,%.2f"</span>,person-&gt;name.<span class="built_in">c_str</span>(),person-&gt;age,person-&gt;height);</span><br><span class="line">} </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"è®¢é˜…æ–¹ï¼š"</span>);</span><br><span class="line"></span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"listener_person"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>(<span class="string">"chatter_person"</span>,<span class="number">1000</span>,doPerson);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>é…ç½®CMakeListï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">add_executable(person_talker src/person_talker.cpp)</span><br><span class="line">add_executable(person_listener src/person_listener.cpp)</span><br><span class="line"></span><br><span class="line">// é¢å¤–é…ç½®ï¼Œé¿å…ç¼–è¯‘æŠ¥é”™</span><br><span class="line">## Add cmake target dependencies of the executable</span><br><span class="line">## same as for the library above</span><br><span class="line">add_dependencies(person_talker ${PROJECT_NAME}_generate_messages_cpp)</span><br><span class="line">add_dependencies(person_listener ${PROJECT_NAME}_generate_messages_cpp)</span><br><span class="line"></span><br><span class="line">target_link_libraries(person_talker</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br><span class="line">target_link_libraries(person_listener</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>add_dependencieså¦‚æœè€ƒè™‘ç®€å•ï¼Œå¯ä»¥ä»…å°†æ³¨é‡Šçš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># add_dependencies(${PROJECT_NAME}_node ${${PROJECT_NAME}_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS})</span><br></pre></td></tr></tbody></table></figure>

<p>ä¸­<code>${PROJECT_NAME}_node</code>å¤„æ”¹ä¸ºèŠ‚ç‚¹åç§°ï¼Œå…¶å®ƒä¿ç•™åŸæ¥æ ¼å¼ä¹Ÿæ˜¯å¯ä»¥çš„</p>
</blockquote>
<p><strong>pythonå®ç°</strong></p>
<p>å°†å‰é¢ç”Ÿæˆçš„ python æ–‡ä»¶è·¯å¾„é…ç½®è¿› settings.json</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"python.autoComplete.extraPaths"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">"/opt/ros/noetic/lib/python3/dist-packages"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">"/home/ros/demo03_ws/devel/lib/python3/dist-packages"</span> <span class="comment">//æ·»åŠ çš„</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></tbody></table></figure>

<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> plumbing_pub_sub.msg <span class="keyword">import</span>  Person</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"talker_person_p"</span>)</span><br><span class="line">    pub = rospy.Publisher(<span class="string">"chatter_person"</span>,Person,queue_size=<span class="number">1000</span>)</span><br><span class="line">    p = Person()</span><br><span class="line">    p.name = <span class="string">"è‘«èŠ¦å¨ƒ"</span></span><br><span class="line">    p.age = <span class="number">18</span></span><br><span class="line">    p.height =<span class="number">0.75</span></span><br><span class="line"></span><br><span class="line">    rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        pub.publish(p)</span><br><span class="line">        rate.sleep()</span><br><span class="line">        rospy.loginfo(<span class="string">"å§“å:%s, å¹´é¾„:%d, èº«é«˜:%.2f"</span>,p.name,p.age,p.height)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> plumbing_pub_sub.msg <span class="keyword">import</span>  Person</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doPerson</span>(<span class="params">p</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">"è®¢é˜…ä¿¡æ¯ï¼š%s,%d,%.2f"</span>,p.name,p.age,p.height)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"listener_person_p"</span>)</span><br><span class="line">    sub = rospy.Subscriber(<span class="string">"chatter_person"</span>,Person,doPerson,queue_size=<span class="number">1000</span>)</span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>ç»ˆç«¯ä¸‹è¿›å…¥ scripts æ‰§è¡Œ:<code>chmod +x *.py</code></p>
<p>é…ç½® CMakeLists.txtï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">catkin_install_python(PROGRAMS</span><br><span class="line">  scripts/talker_p.py</span><br><span class="line">  scripts/listener_p.py</span><br><span class="line">  scripts/person_talker.py</span><br><span class="line">  scripts/person_listener.py</span><br><span class="line">  DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="æœåŠ¡é€šä¿¡"><a href="#æœåŠ¡é€šä¿¡" class="headerlink" title="æœåŠ¡é€šä¿¡"></a>æœåŠ¡é€šä¿¡</h3><p>æœåŠ¡é€šä¿¡ä¹Ÿæ˜¯ROSä¸­ä¸€ç§æå…¶å¸¸ç”¨çš„é€šä¿¡æ¨¡å¼ï¼ŒæœåŠ¡é€šä¿¡æ˜¯åŸºäº<strong>è¯·æ±‚å“åº”</strong>æ¨¡å¼çš„ï¼Œæ˜¯ä¸€ç§åº”ç­”æœºåˆ¶</p>
<p>å³ä¸€ä¸ªèŠ‚ç‚¹Aå‘å¦ä¸€ä¸ªèŠ‚ç‚¹Bå‘é€è¯·æ±‚ï¼ŒBæ¥æ”¶å¤„ç†è¯·æ±‚å¹¶äº§ç”Ÿå“åº”ç»“æœè¿”å›ç»™A</p>
<p>æœåŠ¡é€šä¿¡æ›´é€‚ç”¨äºå¯¹æ—¶æ—¶æ€§æœ‰è¦æ±‚ã€å…·æœ‰ä¸€å®šé€»è¾‘å¤„ç†çš„åº”ç”¨åœºæ™¯</p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/Snipaste_2025-05-22_16-29-54_compressed.webp" alt="Snipaste_2025-05-22_16-29-54_compressed" style="zoom: 67%;">

<p>æ¡ˆä¾‹ï¼š</p>
<p>å®ç°ä¸¤ä¸ªæ•°å­—çš„æ±‚å’Œï¼Œå®¢æˆ·ç«¯èŠ‚ç‚¹ï¼Œè¿è¡Œä¼šå‘æœåŠ¡å™¨å‘é€ä¸¤ä¸ªæ•°å­—ï¼ŒæœåŠ¡å™¨ç«¯èŠ‚ç‚¹æ¥æ”¶ä¸¤ä¸ªæ•°å­—æ±‚å’Œå¹¶å°†ç»“æœå“åº”å›å®¢æˆ·ç«¯</p>
<h4 id="è‡ªå®šä¹‰srv"><a href="#è‡ªå®šä¹‰srv" class="headerlink" title="è‡ªå®šä¹‰srv"></a>è‡ªå®šä¹‰srv</h4><p>srv æ–‡ä»¶å†…çš„å¯ç”¨æ•°æ®ç±»å‹ä¸ msg æ–‡ä»¶ä¸€è‡´ï¼Œä¸”å®šä¹‰ srv å®ç°æµç¨‹ä¸è‡ªå®šä¹‰ msg å®ç°æµç¨‹ç±»ä¼¼:</p>
<ol>
<li>æŒ‰ç…§å›ºå®šæ ¼å¼åˆ›å»ºsrvæ–‡ä»¶</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶</li>
<li>ç¼–è¯‘ç”Ÿæˆä¸­é—´æ–‡ä»¶</li>
</ol>
<p>æµç¨‹ï¼š</p>
<ol>
<li><p>å®šä¹‰srvæ–‡ä»¶</p>
<p>åŠŸèƒ½åŒ…ä¸‹æ–°å»º srv ç›®å½•ï¼Œæ·»åŠ  xxx.srv æ–‡ä»¶ï¼Œè¯·æ±‚å’Œå“åº”æ•°æ®ç±»å‹ä¹‹é—´ç”¨<code>---</code>åˆ†å¼€</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># å®¢æˆ·ç«¯è¯·æ±‚æ—¶å‘é€çš„ä¸¤ä¸ªæ•°å­—</span><br><span class="line">int32 num1</span><br><span class="line">int32 num2</span><br><span class="line">---</span><br><span class="line"># æœåŠ¡å™¨å“åº”å‘é€çš„æ•°æ®</span><br><span class="line">int32 sum</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ç¼–è¯‘é…ç½®æ–‡ä»¶</p>
<p><strong>package.xml</strong>ä¸­æ·»åŠ ç¼–è¯‘ä¾èµ–ä¸æ‰§è¡Œä¾èµ–</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;build_depend&gt;message_generation&lt;/build_depend&gt;</span><br><span class="line">&lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>åŒè¯é¢˜é€šä¿¡è‡ªå®šä¹‰</p>
<p><strong>CMakeLists.txt</strong>ç¼–è¾‘ srv ç›¸å…³é…ç½®</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  message_generation</span><br><span class="line">)</span><br><span class="line"># éœ€è¦åŠ å…¥ message_generation,å¿…é¡»æœ‰ std_msgs</span><br><span class="line"></span><br><span class="line">add_service_files(</span><br><span class="line">  FILES</span><br><span class="line">  AddInts.srv</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">generate_messages(</span><br><span class="line">  DEPENDENCIES</span><br><span class="line">  std_msgs</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p>å®˜ç½‘ç¤ºä¾‹æ²¡æœ‰åœ¨ catkin_package ä¸­é…ç½® message_runtimeï¼Œç»æµ‹è¯•é…ç½®ä¹Ÿå¯ä»¥</p>
</li>
<li><p>ç¼–è¯‘ï¼ŒæŸ¥çœ‹åŒ…æ–¹å¼åŒä¹‹å‰</p>
</li>
</ol>
<p>éœ€è¦å…ˆé…ç½® vscodeï¼Œå°†å‰é¢ç”Ÿæˆçš„ head æ–‡ä»¶è·¯å¾„é…ç½®è¿› c_cpp_properties.json çš„ includepathå±æ€§</p>
<pre><code>  "includePath": [
    "/opt/ros/noetic/include/**",
    "/usr/include/**",
    "/home/ros/demo03_ws/devel/include/**" //å¢åŠ çš„
  ],
</code></pre>
<p><strong>c++</strong></p>
<p>æœåŠ¡ç«¯ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    æœåŠ¡å™¨å®ç°:</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">        3.åˆ›å»º ROS å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»º æœåŠ¡ å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.å›è°ƒå‡½æ•°å¤„ç†è¯·æ±‚å¹¶äº§ç”Ÿå“åº”</span></span><br><span class="line"><span class="comment">        6.ç”±äºè¯·æ±‚æœ‰å¤šä¸ªï¼Œéœ€è¦è°ƒç”¨ ros::spin()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_server_client/AddInts.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">doNums</span><span class="params">(plumbing_server_client::AddInts::Request &amp;req,</span></span></span><br><span class="line"><span class="params"><span class="function">            plumbing_server_client::AddInts::Response &amp;resp)</span></span>{</span><br><span class="line">    <span class="type">int</span> num1 = req.num1;</span><br><span class="line">    <span class="type">int</span> num2 = req.num2;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ•°æ®ä¸º: num1 = %d,num2 = %d"</span>,num1,num2);</span><br><span class="line">    <span class="type">int</span> sum = num1 + num2 ;</span><br><span class="line">    resp.sum = sum;</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"å¤„ç†ç»“æœ: sum = %d"</span>,sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"æœåŠ¡å™¨å¯åŠ¨"</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"AddInts_Server"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::ServiceServer server = nh.<span class="built_in">advertiseService</span>(<span class="string">"AddInts"</span>,doNums);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<blockquote>
<p>æœåŠ¡ç«¯çš„å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ <code>demo03_server_client::AddInts::Request&amp; req</code>ï¼Œæ²¡æœ‰<code>ConstPtr</code>ï¼Œ <code>req</code> æ˜¯è¯·æ±‚å¯¹è±¡çš„<strong>å¼•ç”¨</strong>ï¼Œä¸æ˜¯æŒ‡é’ˆ</p>
<p>å¼•ç”¨ (<code>req</code>) çš„è¡Œä¸ºå’Œå¯¹è±¡å®ä¾‹ä¸€è‡´ï¼Œç›´æ¥ç”¨ <code>.</code> è®¿é—®æˆå‘˜ï¼Œå› ä¸ºæœåŠ¡æ˜¯â€œä¸€é—®ä¸€ç­”â€æ¨¡å¼ï¼Œä¸éœ€è¦å…±äº«æ‰€æœ‰æƒï¼Œç›´æ¥ä¿®æ”¹ä¼ å…¥çš„è¯·æ±‚å’Œå“åº”å¯¹è±¡å³å¯</p>
<p>è¯é¢˜é€šä¿¡ä¸­å°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯å°è£…ä¸º <code>boost::shared_ptr</code>ï¼ˆæ™ºèƒ½æŒ‡é’ˆï¼‰ä¼ é€’ç»™å›è°ƒå‡½æ•°ï¼Œç›®çš„æ˜¯ä¸ºäº†é«˜æ•ˆç®¡ç†å†…å­˜ï¼ˆé¿å…æ‹·è´ï¼‰</p>
</blockquote>
<p>å®¢æˆ·ç«¯ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    æœåŠ¡å™¨å®ç°:</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">        3.åˆ›å»º ROS å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»º å®¢æˆ·ç«¯ å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.è¯·æ±‚æœåŠ¡ï¼Œæ¥æ”¶å“åº”</span></span><br><span class="line"><span class="comment">    å®ç°å‚æ•°çš„åŠ¨æ€æäº¤ï¼š</span></span><br><span class="line"><span class="comment">        1. æ ¼å¼ rosrun ..... (å‚æ•°)</span></span><br><span class="line"><span class="comment">        2. èŠ‚ç‚¹æ‰§è¡Œæ—¶ï¼Œéœ€è¦è·å–å‘½ä»¤ä¸­çš„å‚æ•°ï¼Œå¹¶ç»„ç»‡è¿› request</span></span><br><span class="line"><span class="comment">    é—®é¢˜ï¼š</span></span><br><span class="line"><span class="comment">        å¦‚æœå…ˆå¯åŠ¨å®¢æˆ·ç«¯ï¼Œä¼šè¯·æ±‚å¼‚å¸¸</span></span><br><span class="line"><span class="comment">    éœ€æ±‚ï¼š</span></span><br><span class="line"><span class="comment">        å…ˆå¯åŠ¨å®¢æˆ·ç«¯ï¼Œä¸ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼ŒæŒ‚èµ·ï¼Œç­‰å¾…æœåŠ¡å™¨å¯åŠ¨å†è¯·æ±‚</span></span><br><span class="line"><span class="comment">    è§£å†³ï¼š</span></span><br><span class="line"><span class="comment">        ROSä¸­å†…ç½®å‡½æ•°ï¼Œå¯ä»¥è®©å®¢æˆ·ç«¯å¯åŠ¨åæŒ‚èµ·ç­‰å¾…</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_server_client/AddInts.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    <span class="comment">// ä¼˜åŒ–å®ç°ï¼Œè·å–å‘½ä»¤ä¸­çš„å‚æ•°</span></span><br><span class="line">    <span class="comment">// å¦‚æœä¸ä¼ é€’ä»»ä½•ROSå‚æ•°ï¼Œargc çš„å€¼ä¸º 1ï¼ˆåªæœ‰ç¨‹åºåæœ¬èº«ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">3</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"æäº¤çš„å‚æ•°ä¸ªæ•°ä¸å¯¹"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"AddInts_Client"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::ServiceClient client = nh.<span class="built_in">serviceClient</span>&lt;plumbing_server_client::AddInts&gt;(<span class="string">"AddInts"</span>);</span><br><span class="line">    <span class="comment">// 5.è¯·æ±‚æœåŠ¡ï¼Œæ¥æ”¶å“åº”</span></span><br><span class="line">    plumbing_server_client::AddInts ai;</span><br><span class="line">    <span class="comment">// ç»„ç»‡è¯·æ±‚</span></span><br><span class="line">    ai.request.num1 = <span class="built_in">atoi</span>(argv[<span class="number">1</span>]);</span><br><span class="line">    ai.request.num2 = <span class="built_in">atoi</span>(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="comment">// å¤„ç†å“åº”</span></span><br><span class="line">    <span class="comment">// å‡½æ•°1ï¼Œç­‰åˆ°æœåŠ¡å¯åŠ¨åæ‰ç»§ç»­</span></span><br><span class="line">    <span class="comment">// client.waitForExistence();</span></span><br><span class="line">    <span class="comment">// å‡½æ•°2ï¼Œéœ€è¦ä¼ å…¥å…·ä½“çš„æœåŠ¡è¯é¢˜</span></span><br><span class="line">    ros::service::<span class="built_in">waitForService</span>(<span class="string">"AddInts"</span>); </span><br><span class="line">    <span class="type">bool</span> flag = client.<span class="built_in">call</span>(ai);</span><br><span class="line">    <span class="keyword">if</span>(flag)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"å“åº”æˆåŠŸ"</span>);</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"å“åº”ç»“æœ = %d"</span>,ai.response.sum);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"å“åº”å¤±è´¥"</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>é…ç½®CMakeLists</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">add_executable(AddInts_Server src/AddInts_Server.cpp)</span><br><span class="line">add_executable(AddInts_Client src/AddInts_Client.cpp)</span><br><span class="line"></span><br><span class="line">add_dependencies(AddInts_Server ${PROJECT_NAME}_gencpp)</span><br><span class="line">add_dependencies(AddInts_Client ${PROJECT_NAME}_gencpp)</span><br><span class="line"></span><br><span class="line">target_link_libraries(AddInts_Server</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br><span class="line">target_link_libraries(AddInts_Client</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<p>æœåŠ¡ç«¯ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> plumbing_server_client.srv <span class="keyword">import</span> AddInts,AddIntsRequest,AddIntsResponse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doReq</span>(<span class="params">req</span>):</span><br><span class="line">    num1 = req.num1</span><br><span class="line">    num2 = req.num2</span><br><span class="line">    <span class="built_in">sum</span> = num1 + num2</span><br><span class="line">    resp = AddIntsResponse()</span><br><span class="line">    resp.<span class="built_in">sum</span> = <span class="built_in">sum</span></span><br><span class="line">    rospy.loginfo(<span class="string">"æœåŠ¡å™¨è§£æç»“æœ:%d"</span>,<span class="built_in">sum</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"AddInts_Server_p"</span>)</span><br><span class="line">    server = rospy.Service(<span class="string">"AddInts"</span>,AddInts,doReq)</span><br><span class="line">    rospy.loginfo(<span class="string">"æœåŠ¡å™¨å¯åŠ¨"</span>)</span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>å®¢æˆ·ç«¯ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> plumbing_server_client.srv <span class="keyword">import</span> AddInts,AddIntsRequest,AddIntsResponse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="comment">#ä¼˜åŒ–å®ç°</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        rospy.logerr(<span class="string">"è¯·æ­£ç¡®æäº¤å‚æ•°"</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    rospy.init_node(<span class="string">"AddInts_Client_p"</span>)</span><br><span class="line">    client = rospy.ServiceProxy(<span class="string">"AddInts"</span>,AddInts)</span><br><span class="line">    client.wait_for_service()</span><br><span class="line">    req = AddIntsRequest()</span><br><span class="line">    req.num1 = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>])</span><br><span class="line">    req.num2 = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">    resp = client.call(req)</span><br><span class="line">    rospy.loginfo(<span class="string">"å“åº”ç»“æœ:%d"</span>,resp.<span class="built_in">sum</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>é…ç½®CMakeLists</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">catkin_install_python(PROGRAMS</span><br><span class="line">  scripts/demo01_server_p.py</span><br><span class="line">  scripts/demo02_client_p.py</span><br><span class="line">  DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="å‚æ•°æœåŠ¡å™¨"><a href="#å‚æ•°æœåŠ¡å™¨" class="headerlink" title="å‚æ•°æœåŠ¡å™¨"></a>å‚æ•°æœåŠ¡å™¨</h3><p>ä»¥å…±äº«çš„æ–¹å¼å®ç°ä¸åŒèŠ‚ç‚¹ä¹‹é—´æ•°æ®äº¤äº’çš„é€šä¿¡æ¨¡å¼ï¼Œå­˜å‚¨ä¸€äº›å¤šèŠ‚ç‚¹å…±äº«çš„æ•°æ®ï¼Œç±»ä¼¼äºå…¨å±€å˜é‡ã€‚</p>
<p>æ¡ˆä¾‹ï¼šå®ç°å‚æ•°å¢åˆ æ”¹æŸ¥æ“ä½œ</p>
<p>ROS Master ä½œä¸ºä¸€ä¸ªå…¬å…±å®¹å™¨ä¿å­˜å‚æ•°ï¼ŒTalker å¯ä»¥å‘å®¹å™¨ä¸­è®¾ç½®å‚æ•°ï¼ŒListener å¯ä»¥è·å–å‚æ•°</p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/03ROSé€šä¿¡æœºåˆ¶03_å‚æ•°æœåŠ¡å™¨.jpg" alt="03ROSé€šä¿¡æœºåˆ¶03_å‚æ•°æœåŠ¡å™¨" style="zoom: 67%;">

<blockquote>
<p>æ³¨æ„ï¼šå‚æ•°æœåŠ¡å™¨ä¸æ˜¯ä¸ºé«˜æ€§èƒ½è€Œè®¾è®¡çš„ï¼Œå› æ­¤æœ€å¥½ç”¨äºå­˜å‚¨é™æ€çš„éäºŒè¿›åˆ¶çš„ç®€å•æ•°æ®</p>
</blockquote>
<p><strong>c++</strong></p>
<ul>
<li>å‚æ•°æœåŠ¡å™¨æ–°å¢(ä¿®æ”¹)å‚æ•°</li>
</ul>
<p>å®ç°å‚æ•°æœåŠ¡å™¨æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼Œå¯ä»¥é€šè¿‡ä¸¤å¥— API å®ç°:</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*   </span></span><br><span class="line"><span class="comment">	ros::NodeHandle</span></span><br><span class="line"><span class="comment">        setParam("é”®","å€¼")</span></span><br><span class="line"><span class="comment">    ros::param</span></span><br><span class="line"><span class="comment">        set("é”®","å€¼")</span></span><br><span class="line"><span class="comment">*/</span>        </span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"set_param_c"</span>);</span><br><span class="line">    std::vector&lt;std::string&gt; stus;</span><br><span class="line">    stus.<span class="built_in">push_back</span>(<span class="string">"zhangsan"</span>);</span><br><span class="line">    stus.<span class="built_in">push_back</span>(<span class="string">"lisi"</span>);</span><br><span class="line"></span><br><span class="line">    std::map&lt;std::string,std::string&gt; friends;</span><br><span class="line">    friends[<span class="string">"guo"</span>] = <span class="string">"huang"</span>;</span><br><span class="line">    friends[<span class="string">"yuang"</span>] = <span class="string">"xiao"</span>;</span><br><span class="line">    <span class="comment">//NodeHandle--------------------------------------------------------</span></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_int"</span>,<span class="number">10</span>); <span class="comment">//æ•´å‹</span></span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_double"</span>,<span class="number">3.14</span>); <span class="comment">//æµ®ç‚¹å‹</span></span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_bool"</span>,<span class="literal">true</span>); <span class="comment">//bool</span></span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_string"</span>,<span class="string">"hello NodeHandle"</span>); <span class="comment">//å­—ç¬¦ä¸²</span></span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_vector"</span>,stus); <span class="comment">// vector</span></span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"nh_map"</span>,friends); <span class="comment">// map</span></span><br><span class="line">    <span class="comment">//param--------------------------------------------------------</span></span><br><span class="line">    ros::param::<span class="built_in">set</span>(<span class="string">"param_int"</span>,<span class="number">20</span>);</span><br><span class="line">    ros::param::<span class="built_in">set</span>(<span class="string">"param_double"</span>,<span class="number">3.14</span>);</span><br><span class="line">    ros::param::<span class="built_in">set</span>(<span class="string">"param_string"</span>,<span class="string">"Hello Param"</span>);</span><br><span class="line">    ros::param::<span class="built_in">set</span>(<span class="string">"param_bool"</span>,<span class="literal">false</span>);</span><br><span class="line">    ros::param::<span class="built_in">set</span>(<span class="string">"param_vector"</span>,stus);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å‚æ•°æœåŠ¡å™¨è·å–å‚æ•°</li>
</ul>
<p>åœ¨ roscpp ä¸­æä¾›äº†ä¸¤å¥— API å®ç°å‚æ•°æ“ä½œ</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">	ros::NodeHandle</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        param(é”®,é»˜è®¤å€¼) </span></span><br><span class="line"><span class="comment">            å­˜åœ¨ï¼Œè¿”å›å¯¹åº”ç»“æœï¼Œå¦åˆ™è¿”å›é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">				int res1 = nh.param("nh_int",100); </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        getParam(é”®,å­˜å‚¨ç»“æœçš„å˜é‡)</span></span><br><span class="line"><span class="comment">            å­˜åœ¨,è¿”å› true,ä¸”å°†å€¼èµ‹å€¼ç»™å‚æ•°2</span></span><br><span class="line"><span class="comment">            å¦‚æœé”®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¸º falseï¼Œä¸”ä¸ä¸ºå‚æ•°2èµ‹å€¼</span></span><br><span class="line"><span class="comment">				nh.getParam("nh_int",nh_int_value);</span></span><br><span class="line"><span class="comment">			</span></span><br><span class="line"><span class="comment">        getParamCached(é”®,å­˜å‚¨ç»“æœçš„å˜é‡)--æé«˜å˜é‡è·å–æ•ˆç‡</span></span><br><span class="line"><span class="comment">            å­˜åœ¨,è¿”å› true,ä¸”å°†å€¼èµ‹å€¼ç»™å‚æ•°2</span></span><br><span class="line"><span class="comment">            å¦‚æœé”®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¸º falseï¼Œä¸”ä¸ä¸ºå‚æ•°2èµ‹å€¼</span></span><br><span class="line"><span class="comment">			    nh.getParamCached("nh_int",nh_int_value);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        getParamNames(std::vector&lt;std::string&gt;)</span></span><br><span class="line"><span class="comment">            è·å–æ‰€æœ‰çš„é”®,å¹¶å­˜å‚¨åœ¨å‚æ•° vector ä¸­ </span></span><br><span class="line"><span class="comment">                std::vector&lt;std::string&gt; param_names;</span></span><br><span class="line"><span class="comment">                nh.getParamNames(param_names);</span></span><br><span class="line"><span class="comment">                for (auto &amp;&amp;name : param_names)</span></span><br><span class="line"><span class="comment">                {</span></span><br><span class="line"><span class="comment">                    ROS_INFO("åç§°è§£æname = %s",name.c_str());   </span></span><br><span class="line"><span class="comment">                }</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        hasParam(é”®)</span></span><br><span class="line"><span class="comment">        æ˜¯å¦åŒ…å«æŸä¸ªé”®ï¼Œå­˜åœ¨è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">			ROS_INFO("å­˜åœ¨ nh_int å—? %d",nh.hasParam("nh_int"));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        searchParam(å‚æ•°1ï¼Œå‚æ•°2)</span></span><br><span class="line"><span class="comment">            æœç´¢é”®ï¼Œå‚æ•°1æ˜¯è¢«æœç´¢çš„é”®ï¼Œå‚æ•°2å­˜å‚¨æœç´¢ç»“æœçš„å˜é‡</span></span><br><span class="line"><span class="comment">                nh.searchParam("nh_int",key);</span></span><br><span class="line"><span class="comment">                ROS_INFO("æœç´¢é”®:%s",key.c_str());</span></span><br><span class="line"><span class="comment">                -&gt; æœç´¢é”®:/nh_int</span></span><br><span class="line"><span class="comment">                </span></span><br><span class="line"><span class="comment">    ros::param ----- ä¸ NodeHandle ç±»ä¼¼</span></span><br><span class="line"><span class="comment">*/</span> </span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å‚æ•°æœåŠ¡å™¨åˆ é™¤å‚æ•°</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    ros::NodeHandle</span></span><br><span class="line"><span class="comment">        deleteParam("é”®")</span></span><br><span class="line"><span class="comment">        æ ¹æ®é”®åˆ é™¤å‚æ•°ï¼Œåˆ é™¤æˆåŠŸï¼Œè¿”å› trueï¼Œå¦åˆ™(å‚æ•°ä¸å­˜åœ¨)ï¼Œè¿”å› false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    ros::param</span></span><br><span class="line"><span class="comment">        del("é”®")</span></span><br><span class="line"><span class="comment">        æ ¹æ®é”®åˆ é™¤å‚æ•°ï¼Œåˆ é™¤æˆåŠŸï¼Œè¿”å› trueï¼Œå¦åˆ™(å‚æ•°ä¸å­˜åœ¨)ï¼Œè¿”å› false</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<ul>
<li>å‚æ•°æœåŠ¡å™¨æ–°å¢(ä¿®æ”¹)å‚æ•°</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"set_update_paramter_p"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½®å„ç§ç±»å‹å‚æ•°</span></span><br><span class="line">    rospy.set_param(<span class="string">"p_int"</span>,<span class="number">10</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"p_double"</span>,<span class="number">3.14</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"p_bool"</span>,<span class="literal">True</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"p_string"</span>,<span class="string">"hello python"</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"p_list"</span>,[<span class="string">"hello"</span>,<span class="string">"haha"</span>,<span class="string">"xixi"</span>])</span><br><span class="line">    rospy.set_param(<span class="string">"p_dict"</span>,{<span class="string">"name"</span>:<span class="string">"hulu"</span>,<span class="string">"age"</span>:<span class="number">8</span>})</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿®æ”¹</span></span><br><span class="line">    rospy.set_param(<span class="string">"p_int"</span>,<span class="number">100</span>)</span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å‚æ•°æœåŠ¡å™¨è·å–å‚æ•°</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">	rospy.init_node("get_param_p")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    å‚æ•°æœåŠ¡å™¨æ“ä½œä¹‹æŸ¥è¯¢_Pythonå®ç°:    </span></span><br><span class="line"><span class="string">        get_param(é”®,é»˜è®¤å€¼)</span></span><br><span class="line"><span class="string">            å½“é”®å­˜åœ¨æ—¶ï¼Œè¿”å›å¯¹åº”çš„å€¼ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›é»˜è®¤å€¼</span></span><br><span class="line"><span class="string">            	int_value = rospy.get_param("p_int",10000)</span></span><br><span class="line"><span class="string">            	</span></span><br><span class="line"><span class="string">        get_param_cached(é”®,é»˜è®¤å€¼)--æé«˜å˜é‡è·å–æ•ˆç‡</span></span><br><span class="line"><span class="string">        		int_cached = rospy.get_param_cached("p_int")</span></span><br><span class="line"><span class="string">        		</span></span><br><span class="line"><span class="string">        get_param_names--è·å–æ‰€æœ‰çš„é”®</span></span><br><span class="line"><span class="string">            names = rospy.get_param_names()</span></span><br><span class="line"><span class="string">            for name in names:</span></span><br><span class="line"><span class="string">                rospy.loginfo("name = %s",name)</span></span><br><span class="line"><span class="string">                </span></span><br><span class="line"><span class="string">        has_param</span></span><br><span class="line"><span class="string">        	æ˜¯å¦åŒ…å«æŸä¸ªé”®ï¼Œå­˜åœ¨è¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="string">        		    flag = rospy.has_param("p_int")</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        search_param--å¯»æ‰¾æŸä¸ªé”®ï¼Œå¹¶è¿”å›å®Œæ•´çš„è·¯å¾„</span></span><br><span class="line"><span class="string">        	key = rospy.search_param("p_int")</span></span><br><span class="line"><span class="string">    		rospy.loginfo("æœç´¢çš„é”® = %s",key)</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>

<ul>
<li>å‚æ•°æœåŠ¡å™¨åˆ é™¤å‚æ•°</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="string">"""</span></span><br><span class="line"><span class="string">    rospy.delete_param("é”®")</span></span><br><span class="line"><span class="string">    é”®å­˜åœ¨æ—¶ï¼Œå¯ä»¥åˆ é™¤æˆåŠŸï¼Œé”®ä¸å­˜åœ¨æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    rospy.init_node("delete_param_p")</span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        rospy.delete_param("p_int")</span></span><br><span class="line"><span class="string">    except Exception as e:</span></span><br><span class="line"><span class="string">        rospy.loginfo("åˆ é™¤å¤±è´¥")</span></span><br><span class="line"><span class="string">"""</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><p>å’Œä¹‹å‰ä»‹ç»çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œå‘½ä»¤æ¯”è¾ƒï¼Œæ–‡ä»¶æ“ä½œå‘½ä»¤æ˜¯é™æ€çš„ï¼Œæ“ä½œçš„æ˜¯ç£ç›˜ä¸Šçš„æ–‡ä»¶ï¼Œè€Œä¸Šè¿°å‘½ä»¤æ˜¯åŠ¨æ€çš„ï¼Œåœ¨ROSç¨‹åºå¯åŠ¨åï¼Œå¯ä»¥åŠ¨æ€çš„è·å–è¿è¡Œä¸­çš„èŠ‚ç‚¹æˆ–å‚æ•°çš„ç›¸å…³ä¿¡æ¯</p>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/ROS/CommandLineTools">ROS/CommandLineTools - ROS Wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/rosnode">rosnode - ROS Wiki</a>   ç”¨äºè·å–èŠ‚ç‚¹ä¿¡æ¯çš„å‘½ä»¤</p>
<ul>
<li>rosnode list        åˆ—å‡ºæ‰€æœ‰çš„æ´»åŠ¨èŠ‚ç‚¹</li>
<li>rosnode ping [node_name]        æµ‹è¯•åˆ°èŠ‚ç‚¹çš„è¿æ¥çŠ¶æ€</li>
<li>rosnode info [node_name]         æ‰“å°èŠ‚ç‚¹ä¿¡æ¯</li>
<li>rosnode machine [machine_name]        åˆ—å‡ºæŒ‡å®šè®¾å¤‡ä¸Šçš„èŠ‚ç‚¹</li>
<li>rosnode kill [node_name]        æ€æ­»æŸä¸ªèŠ‚ç‚¹</li>
<li>rosnode cleanup        æ¸…é™¤æ— ç”¨èŠ‚ç‚¹ï¼Œæ¯”å¦‚å°ä¹Œé¾Ÿç¤ºä¾‹</li>
</ul>
<hr>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/rostopic">rostopic - ROS Wiki</a>   ç”¨äºæ˜¾ç¤ºæœ‰å…³ROSè¯é¢˜çš„è°ƒè¯•ä¿¡æ¯ï¼ŒåŒ…æ‹¬å‘å¸ƒè€…ï¼Œè®¢é˜…è€…ï¼Œå‘å¸ƒé¢‘ç‡å’ŒROSæ¶ˆæ¯</p>
<ul>
<li><p>rostopic list        æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨çŠ¶æ€ä¸‹çš„è¯é¢˜</p>
</li>
<li><p>rostpic echo [topic-name]        è·å–æŒ‡å®šè¯é¢˜å½“å‰å‘å¸ƒçš„æ¶ˆæ¯</p>
</li>
<li><p>rostopic pub        ç›´æ¥è°ƒç”¨å‘½ä»¤å‘è®¢é˜…è€…å‘å¸ƒæ¶ˆæ¯ [è¿™ç±»æŒ‡ä»¤éƒ½éœ€è¦å…ˆsource ä¸€ä¸‹]</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rostopic pub -r [é¢‘ç‡] /è¯é¢˜åç§° æ¶ˆæ¯ç±»å‹ æ¶ˆæ¯å†…å®¹</span><br><span class="line">rostopic pub -r 10 chatter_person plumbing_pub_sub/Person [æŒ‰ä¸¤æ¬¡Tabè¡¥é½]</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>rostopic info [topic-name]        è·å–å½“å‰è¯é¢˜çš„ç›¸å…³ä¿¡æ¯</p>
</li>
<li><p>rostopic type [topic-name]       æ‰“å°è¯é¢˜ç±»å‹</p>
</li>
<li><p>rostopic hz [topic-name]         æ˜¾ç¤ºè¯é¢˜çš„å‘å¸ƒé¢‘ç‡</p>
</li>
</ul>
<hr>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/rosmsg">rosmsg - ROS Wiki</a>   ç”¨äºæ˜¾ç¤ºæœ‰å…³ ROSæ¶ˆæ¯ç±»å‹çš„å·¥å…·</p>
<ul>
<li><p>rosmsg list        åˆ—å‡ºæ‰€æœ‰æ¶ˆæ¯</p>
</li>
<li><p>rosmsg list | grep -i [æ¶ˆæ¯ç§ç±»]      æ˜¾ç¤ºæ¶ˆæ¯çš„å…·ä½“è·¯å¾„</p>
</li>
<li><p>rosmsg show [æ¶ˆæ¯ç§ç±»]        æ˜¾ç¤ºæ¶ˆæ¯æè¿°</p>
</li>
<li><p>rosmsg info [æ¶ˆæ¯ç§ç±»]        ä½œç”¨ä¸ rosmsg show ä¸€æ ·</p>
</li>
</ul>
<hr>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/rosservice">rosservice - ROS Wiki</a>   ç”¨äºåˆ—å‡ºå’ŒæŸ¥è¯¢ROS <a target="_blank" rel="noopener" href="http://wiki.ros.org/Services">Services</a>çš„å·¥å…·</p>
<ul>
<li>rosservice list         åˆ—å‡ºæ‰€æœ‰æ´»åŠ¨çš„æœåŠ¡</li>
<li>rosservice call [service-name]       ä½¿ç”¨æä¾›çš„å‚æ•°è°ƒç”¨æœåŠ¡</li>
<li>rosservice info [service-name]       æ‰“å°æœ‰å…³æœåŠ¡çš„ä¿¡æ¯</li>
<li>rosservice type [service-name]      æ‰“å°æœåŠ¡ç±»å‹</li>
</ul>
<p>rossrvæ˜¯ç”¨äºæ˜¾ç¤ºæœ‰å…³ROSæœåŠ¡ç±»å‹çš„ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸ rosmsg ä½¿ç”¨è¯­æ³•é«˜åº¦ä¸€è‡´</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/rosparam">rosparam - ROS Wiki</a>  ç”¨äºä½¿ç”¨YAMLç¼–ç æ–‡ä»¶åœ¨å‚æ•°æœåŠ¡å™¨ä¸Šè·å–å’Œè®¾ç½®ROSå‚æ•°</p>
<ul>
<li><p>rosparam list        åˆ—å‡ºæ‰€æœ‰å‚æ•°</p>
</li>
<li><p>rosparam set       è®¾ç½®å‚æ•° [å‚æ•°å] [å‚æ•°å€¼]</p>
</li>
<li><p>rosparam get       è·å–å‚æ•°</p>
</li>
<li><p>rosparam delete   åˆ é™¤å‚æ•°</p>
</li>
<li><p>rosparam dump    å°†å‚æ•°å†™å‡ºåˆ°å¤–éƒ¨æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosparam dump xxx.yaml</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>rosparam load [yamlæ–‡ä»¶]  ä»å¤–éƒ¨æ–‡ä»¶åŠ è½½å‚æ•°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosparam load xxx.yaml</span><br></pre></td></tr></tbody></table></figure></li>
</ul>
<h3 id="é€šä¿¡æœºåˆ¶å®æ“"><a href="#é€šä¿¡æœºåˆ¶å®æ“" class="headerlink" title="é€šä¿¡æœºåˆ¶å®æ“"></a>é€šä¿¡æœºåˆ¶å®æ“</h3><h4 id="å®æ“1-è¯é¢˜å‘å¸ƒ"><a href="#å®æ“1-è¯é¢˜å‘å¸ƒ" class="headerlink" title="å®æ“1 è¯é¢˜å‘å¸ƒ"></a>å®æ“1 è¯é¢˜å‘å¸ƒ</h4><p>éœ€æ±‚æè¿°ï¼šç¼–ç å®ç°ä¹Œé¾Ÿè¿åŠ¨æ§åˆ¶ï¼Œè®©å°ä¹Œé¾Ÿåšåœ†å‘¨è¿åŠ¨</p>
<p>å®ç°åˆ†æï¼š</p>
<ol>
<li>ä¹Œé¾Ÿè¿åŠ¨æ§åˆ¶å®ç°ï¼Œå…³é”®èŠ‚ç‚¹æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä¹Œé¾Ÿè¿åŠ¨æ˜¾ç¤ºèŠ‚ç‚¹ turtlesim_nodeï¼Œå¦ä¸€ä¸ªæ˜¯æ§åˆ¶èŠ‚ç‚¹ï¼ŒäºŒè€…æ˜¯è®¢é˜…å‘å¸ƒæ¨¡å¼å®ç°é€šä¿¡çš„ï¼Œä¹Œé¾Ÿè¿åŠ¨æ˜¾ç¤ºèŠ‚ç‚¹ç›´æ¥è°ƒç”¨å³å¯ï¼Œè¿åŠ¨æ§åˆ¶èŠ‚ç‚¹ä¹‹å‰æ˜¯ä½¿ç”¨çš„ turtle_teleop_key é€šè¿‡é”®ç›˜æ§åˆ¶ï¼Œç°åœ¨éœ€è¦è‡ªå®šä¹‰æ§åˆ¶èŠ‚ç‚¹</li>
<li>æ§åˆ¶èŠ‚ç‚¹è‡ªå®ç°æ—¶ï¼Œé¦–å…ˆéœ€è¦äº†è§£æ§åˆ¶èŠ‚ç‚¹ä¸æ˜¾ç¤ºèŠ‚ç‚¹é€šä¿¡ä½¿ç”¨çš„è¯é¢˜ä¸æ¶ˆæ¯ï¼Œå¯ä»¥ä½¿ç”¨roså‘½ä»¤ç»“åˆè®¡ç®—å›¾æ¥è·å–</li>
<li>äº†è§£äº†è¯é¢˜ä¸æ¶ˆæ¯ä¹‹åï¼Œé€šè¿‡ C++ æˆ– Python ç¼–å†™è¿åŠ¨æ§åˆ¶èŠ‚ç‚¹ï¼Œé€šè¿‡æŒ‡å®šçš„è¯é¢˜ï¼ŒæŒ‰ç…§ä¸€å®šçš„é€»è¾‘å‘å¸ƒæ¶ˆæ¯å³å¯</li>
</ol>
<p>å®ç°æµç¨‹ï¼š</p>
<ol>
<li>é€šè¿‡è®¡ç®—å›¾ç»“åˆroså‘½ä»¤è·å–è¯é¢˜ä¸æ¶ˆæ¯ä¿¡æ¯</li>
<li>ç¼–ç å®ç°è¿åŠ¨æ§åˆ¶èŠ‚ç‚¹</li>
<li>å¯åŠ¨ roscoreã€turtlesim_node ä»¥åŠè‡ªå®šä¹‰çš„æ§åˆ¶èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹è¿è¡Œç»“æœ</li>
</ol>
<p><strong>è¯é¢˜ä¸æ¶ˆæ¯è·å–</strong></p>
<p>å…ˆå¯åŠ¨é”®ç›˜æ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨æ¡ˆä¾‹</p>
<ol>
<li><p>è¯é¢˜è·å–</p>
<p>é€šè¿‡ rostopic åˆ—å‡ºè¯é¢˜</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rostopic list</span><br></pre></td></tr></tbody></table></figure>

<p>æˆ–è€…é€šè¿‡è®¡ç®—å›¾æŸ¥çœ‹è¯é¢˜ï¼Œå¯åŠ¨è®¡ç®—å›¾</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rqt_graph</span><br></pre></td></tr></tbody></table></figure>



<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/image-20250523203511067.png" alt="image-20250523203511067" style="zoom: 67%;">

<p>-&gt; /turtle1/cmd_vel ä¼ é€’è¿åŠ¨æŒ‡ä»¤</p>
</li>
<li><p>æ¶ˆæ¯è·å–</p>
<p>è·å–æ¶ˆæ¯ç±»å‹ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rostopic type /turtle1/cmd_vel</span><br><span class="line">// rostopic info /turtle1/cmd_vel</span><br></pre></td></tr></tbody></table></figure>

<p>info å‘½ä»¤ä¸‹ä¹Ÿæ˜¾ç¤ºtype</p>
<p>type: geometry_msgs/Twist</p>
</li>
<li><p>è·å–æ¶ˆæ¯æ ¼å¼</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosmsg info geometry_msgs/Twist</span><br></pre></td></tr></tbody></table></figure>

<p>è¾“å‡º: </p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">geometry_msgs/Vector3 linear</span><br><span class="line">  float64 x</span><br><span class="line">  float64 y</span><br><span class="line">  float64 z</span><br><span class="line">geometry_msgs/Vector3 angular</span><br><span class="line">  float64 x</span><br><span class="line">  float64 y</span><br><span class="line">  float64 z</span><br></pre></td></tr></tbody></table></figure>

<p>inear(çº¿é€Ÿåº¦) ï¼šxyzåˆ†åˆ«å¯¹åº”åœ¨xã€yå’Œzæ–¹å‘ä¸Šçš„é€Ÿåº¦(å•ä½æ˜¯ m/s)</p>
<p>angular(è§’é€Ÿåº¦)ï¼šxyzåˆ†åˆ«å¯¹åº”xè½´ä¸Šçš„ç¿»æ»šrollã€yè½´ä¸Špitchå’Œzè½´ä¸Šåèˆªyawçš„é€Ÿåº¦(å•ä½æ˜¯rad/s)</p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/æ¬§æ‹‰è§’1.webp" alt="æ¬§æ‹‰è§’1" style="zoom: 67%;">

<blockquote>
<p>å¼§åº¦ï¼šå•ä½å¼§åº¦å®šä¹‰ä¸ºåœ†å¼§é•¿åº¦ç­‰äºåŠå¾„æ—¶çš„åœ†å¿ƒè§’</p>
<p>åœ¨rosä¸­é¡ºæ—¶é’ˆå¼§åº¦ä¸º - ï¼Œé€†æ—¶é’ˆä¸º +ï¼Œå€¼çš„èŒƒå›´åœ¨[-Ï€,Ï€]</p>
</blockquote>
</li>
</ol>
<p>äºæ˜¯å¯ä»¥é€šè¿‡ç›´æ¥å‘å¸ƒæŒ‡ä»¤åšåˆ°ç®€å•å®ç°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rostopic pub -r 10 /turtle1/cmd_vel [TABè¡¥é½]</span><br></pre></td></tr></tbody></table></figure>

<p><strong>å®ç°å‘å¸ƒèŠ‚ç‚¹</strong></p>
<p>åˆ›å»ºåŠŸèƒ½åŒ…éœ€è¦ä¾èµ–çš„åŠŸèƒ½åŒ…: roscpp rospy std_msgs geometry_msgs(å°è£…åæ ‡)</p>
<p><strong>c++</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	topic(å·²çŸ¥: /turtle1/cmd_vel)</span></span><br><span class="line"><span class="comment">    æ¶ˆæ¯ç±»å‹(å·²çŸ¥: geometry_msgs/Twist)</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    å®ç°æµç¨‹:</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">        3.åˆ›å»ºèŠ‚ç‚¹å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»ºå‘å¸ƒè€…å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.å‘å¸ƒé€»è¾‘</span></span><br><span class="line"><span class="comment">        6.spinOnce()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/Twist.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"circle_control"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">"/turtle1/cmd_vel"</span>,<span class="number">1000</span>);</span><br><span class="line">    geometry_msgs::Twist msg;</span><br><span class="line"></span><br><span class="line">    msg.linear.x = <span class="number">1.0</span>;</span><br><span class="line">    msg.linear.y = <span class="number">1.0</span>;</span><br><span class="line">    msg.linear.z = <span class="number">0.0</span>;</span><br><span class="line">    msg.angular.x = <span class="number">0.0</span>;</span><br><span class="line">    msg.angular.y = <span class="number">0.0</span>;</span><br><span class="line">    msg.angular.z = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        pub.<span class="built_in">publish</span>(msg);</span><br><span class="line">        rate.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    rospy.init_node(<span class="string">"circle_control_p"</span>)</span><br><span class="line">    pub = rospy.Publisher(<span class="string">"/turtle1/cmd_vel"</span>,Twist,queue_size=<span class="number">1000</span>)</span><br><span class="line">    rate = rospy.Rate(<span class="number">10</span>)</span><br><span class="line">    msg = Twist()  // æ³¨æ„è¿™é‡Œè¦()</span><br><span class="line"></span><br><span class="line">    msg.linear.x = <span class="number">1.0</span></span><br><span class="line">    msg.linear.y = <span class="number">0.0</span></span><br><span class="line">    msg.linear.z = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">    msg.angular.x = <span class="number">0.0</span></span><br><span class="line">    msg.angular.y = <span class="number">0.0</span></span><br><span class="line">    msg.angular.z = <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        pub.publish(msg)</span><br><span class="line">        rate.sleep</span><br></pre></td></tr></tbody></table></figure>

<h4 id="å®æ“2-è¯é¢˜è®¢é˜…"><a href="#å®æ“2-è¯é¢˜è®¢é˜…" class="headerlink" title="å®æ“2 è¯é¢˜è®¢é˜…"></a>å®æ“2 è¯é¢˜è®¢é˜…</h4><p>éœ€æ±‚æè¿°ï¼šturtlesimä¸­çš„ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹ï¼Œä¼šå‘å¸ƒå½“å‰ä¹Œé¾Ÿçš„ä½å§¿(çª—ä½“ä¸­ä¹Œé¾Ÿçš„åæ ‡ä»¥åŠæœå‘)ï¼Œè¦æ±‚æ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨ï¼Œå¹¶æ—¶æ—¶æ‰“å°å½“å‰ä¹Œé¾Ÿçš„ä½å§¿</p>
<p>å®ç°åˆ†æï¼š</p>
<ol>
<li>é¦–å…ˆï¼Œéœ€è¦å¯åŠ¨ä¹Œé¾Ÿæ˜¾ç¤ºä»¥åŠè¿åŠ¨æ§åˆ¶èŠ‚ç‚¹å¹¶æ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨</li>
<li>è¦é€šè¿‡ROSå‘½ä»¤ï¼Œæ¥è·å–ä¹Œé¾Ÿä½å§¿å‘å¸ƒçš„è¯é¢˜ä»¥åŠæ¶ˆæ¯</li>
<li>ç¼–å†™è®¢é˜…èŠ‚ç‚¹ï¼Œè®¢é˜…å¹¶æ‰“å°ä¹Œé¾Ÿçš„ä½å§¿</li>
</ol>
<p>å®ç°æµç¨‹:</p>
<ol>
<li>é€šè¿‡roså‘½ä»¤è·å–è¯é¢˜ä¸æ¶ˆæ¯ä¿¡æ¯</li>
<li>ç¼–ç å®ç°ä½å§¿è·å–èŠ‚ç‚¹</li>
<li>å¯åŠ¨ roscoreã€turtlesim_node ã€æ§åˆ¶èŠ‚ç‚¹ä»¥åŠä½å§¿è®¢é˜…èŠ‚ç‚¹ï¼Œæ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨å¹¶è¾“å‡ºä¹Œé¾Ÿçš„ä½å§¿</li>
</ol>
<p><strong>è¯é¢˜ä¸æ¶ˆæ¯è·å–</strong></p>
<p>å…ˆå¯åŠ¨é”®ç›˜æ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨æ¡ˆä¾‹</p>
<ol>
<li><p>è¯é¢˜è·å–</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rostopic list</span><br></pre></td></tr></tbody></table></figure>

<p>-&gt; /turtle1/pose  å­˜å‚¨ä¹Œé¾Ÿä½ç½®</p>
</li>
<li><p>è·å–æ¶ˆæ¯ç±»å‹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rostopic info  /turtle1/pose</span><br></pre></td></tr></tbody></table></figure>

<p>-&gt; type: turtlesim/Pose</p>
</li>
<li><p>è·å–æ¶ˆæ¯æ ¼å¼</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosmsg info turtlesim/Pose</span><br></pre></td></tr></tbody></table></figure>

<p>å“åº”ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">float32 x</span><br><span class="line">float32 y</span><br><span class="line">float32 theta</span><br><span class="line">float32 linear_velocity</span><br><span class="line">float32 angular_velocity</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<p><strong>å®ç°è®¢é˜…èŠ‚ç‚¹</strong></p>
<p>éœ€è¦å¢æ·»åŠŸèƒ½åŒ…turtlesim</p>
<p>åœ¨package.xmlä¸­å¢æ·»</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build_depend</span>&gt;</span>turtlesim<span class="tag">&lt;/<span class="name">build_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>sturtlesim<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨CMakeLsit.txtä¸­å¢æ·»</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find_package(catkin REQUIRED COMPONENTS</span><br><span class="line">  geometry_msgs</span><br><span class="line">  roscpp</span><br><span class="line">  rospy</span><br><span class="line">  std_msgs</span><br><span class="line">  turtlesim //å¢æ·»åŒ…</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>c++</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    è¯é¢˜åç§° /turtle1/pose</span></span><br><span class="line"><span class="comment">    æ¶ˆæ¯ç±»å‹ turtlesim/Pose</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    å®ç°æµç¨‹:</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ROS èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">        3.åˆ›å»º ROS å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»ºè®¢é˜…è€…å¯¹è±¡</span></span><br><span class="line"><span class="comment">        5.å›è°ƒå‡½æ•°å¤„ç†è®¢é˜…çš„æ•°æ®</span></span><br><span class="line"><span class="comment">        6.spin</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"turtlesim/Pose.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPose</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr &amp;pose)</span></span>{</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"ä¹Œé¾Ÿçš„ä½å§¿ä¿¡æ¯: \nåæ ‡(%.2f,%.2f)\næœå‘(%.2f)\nçº¿é€Ÿåº¦:%.2f\nè§’é€Ÿåº¦:%.2f"</span>,</span><br><span class="line">    pose-&gt;x,pose-&gt;y,pose-&gt;theta,pose-&gt;linear_velocity,pose-&gt;angular_velocity);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"sub_pose"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>(<span class="string">"/turtle1/pose"</span>,<span class="number">1000</span>,doPose);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.msg <span class="keyword">import</span> Pose</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doPose</span>(<span class="params">pose</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">"ä¹Œé¾Ÿçš„ä½å§¿ä¿¡æ¯: \nåæ ‡(%.2f,%.2f)\næœå‘(%.2f)\nçº¿é€Ÿåº¦:%.2f\nè§’é€Ÿåº¦:%.2f"</span>,</span><br><span class="line">                pose.x,pose.y,pose.theta,pose.linear_velocity,pose.angular_velocity)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"sub_pose_p"</span>)</span><br><span class="line">    sub = rospy.Subscriber(<span class="string">"/turtle1/pose"</span>,Pose,doPose,queue_size=<span class="number">1000</span>)</span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>ä»£ç ä¸­å®¹æ˜“é”™è¯¯çš„åœ°æ–¹ï¼šè¯é¢˜åæ˜¯/turtle1/pose ï¼Œæ³¨æ„è¿™ä¸ª1</p>
<h4 id="å®æ“3-æœåŠ¡è°ƒç”¨"><a href="#å®æ“3-æœåŠ¡è°ƒç”¨" class="headerlink" title="å®æ“3 æœåŠ¡è°ƒç”¨"></a>å®æ“3 æœåŠ¡è°ƒç”¨</h4><p>éœ€æ±‚æè¿°ï¼šç¼–ç å®ç°å‘ turtlesim å‘é€è¯·æ±‚ï¼Œåœ¨ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹çš„çª—ä½“æŒ‡å®šä½ç½®ç”Ÿæˆä¸€ä¹Œé¾Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªæœåŠ¡è¯·æ±‚æ“ä½œ</p>
<p>å®ç°åˆ†æ:</p>
<ol>
<li>é¦–å…ˆï¼Œéœ€è¦å¯åŠ¨ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹</li>
<li>è¦é€šè¿‡ROSå‘½ä»¤ï¼Œæ¥è·å–ä¹Œé¾Ÿç”ŸæˆæœåŠ¡çš„æœåŠ¡åç§°ä»¥åŠæœåŠ¡æ¶ˆæ¯ç±»å‹</li>
<li>ç¼–å†™æœåŠ¡è¯·æ±‚èŠ‚ç‚¹ï¼Œç”Ÿæˆæ–°çš„ä¹Œé¾Ÿ</li>
</ol>
<p>å®ç°æµç¨‹:</p>
<ol>
<li>é€šè¿‡roså‘½ä»¤è·å–æœåŠ¡ä¸æœåŠ¡æ¶ˆæ¯ä¿¡æ¯</li>
<li>ç¼–ç å®ç°æœåŠ¡è¯·æ±‚èŠ‚ç‚¹</li>
<li>å¯åŠ¨ roscoreã€turtlesim_node ã€ä¹Œé¾Ÿç”ŸæˆèŠ‚ç‚¹ï¼Œç”Ÿæˆæ–°çš„ä¹Œé¾Ÿ</li>
</ol>
<p><strong>æœåŠ¡åç§°ä¸æœåŠ¡æ¶ˆæ¯è·å–</strong></p>
<ol>
<li><p>è·å–è¯é¢˜</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosservice list</span><br></pre></td></tr></tbody></table></figure>

<p>-&gt; /spawn</p>
</li>
<li><p>è·å–æœåŠ¡æ¶ˆæ¯ç±»å‹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosservice info /spawn</span><br></pre></td></tr></tbody></table></figure>

<p>type: turtlesim/Spawn</p>
<p>Args: x y theta name</p>
</li>
<li><p>è·å–æœåŠ¡æ¶ˆæ¯æ ¼å¼</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rossrv info turtlesim/Spawn</span><br></pre></td></tr></tbody></table></figure>

<p>å“åº”ç»“æœ:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">float32 x</span><br><span class="line">float32 y</span><br><span class="line">float32 theta</span><br><span class="line">string name</span><br><span class="line">---</span><br><span class="line">string name</span><br></pre></td></tr></tbody></table></figure></li>
</ol>
<p>ä¹Ÿå¯ä»¥ç®€å•å®ç°å¢æ·»ä¹Œé¾Ÿ</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosservice call /spawn [TABè¡¥é½]</span><br></pre></td></tr></tbody></table></figure>

<p><strong>c++</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    æœåŠ¡è¯é¢˜ /spawn</span></span><br><span class="line"><span class="comment">    æœåŠ¡æ¶ˆæ¯ç±»å‹ turtlesim/Spawn</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    å®ç°æµç¨‹:</span></span><br><span class="line"><span class="comment">        1.åŒ…å«å¤´æ–‡ä»¶</span></span><br><span class="line"><span class="comment">          éœ€è¦åŒ…å« turtlesim åŒ…ä¸‹èµ„æºï¼Œæ³¨æ„åœ¨ package.xml é…ç½®</span></span><br><span class="line"><span class="comment">        2.åˆå§‹åŒ– ros èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">        3.åˆ›å»º ros å¥æŸ„</span></span><br><span class="line"><span class="comment">        4.åˆ›å»º service å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="comment">        5.ç­‰å¾…æœåŠ¡å¯åŠ¨</span></span><br><span class="line"><span class="comment">        6.å‘é€è¯·æ±‚</span></span><br><span class="line"><span class="comment">        7.å¤„ç†å“åº”</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"turtlesim/Spawn.h"</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"service_call"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    ros::ServiceClient client = nh.<span class="built_in">serviceClient</span>&lt;turtlesim::Spawn&gt;(<span class="string">"/spawn"</span>);</span><br><span class="line">    turtlesim::Spawn spawn;</span><br><span class="line">    spawn.request.x = <span class="number">1.0</span>;</span><br><span class="line">    spawn.request.y = <span class="number">4.0</span>;</span><br><span class="line">    spawn.request.theta = <span class="number">1.57</span>;</span><br><span class="line">    spawn.request.name = <span class="string">"turtlec"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ros::service::waitForService("/spawn");</span></span><br><span class="line">    client.<span class="built_in">waitForExistence</span>();</span><br><span class="line">    <span class="type">bool</span> flag = client.<span class="built_in">call</span>(spawn);</span><br><span class="line">    <span class="comment">// 7.å¤„ç†å“åº”ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> (flag)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"æ–°çš„ä¹Œé¾Ÿç”Ÿæˆ,åå­—:%s"</span>,spawn.response.name.<span class="built_in">c_str</span>());</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"ä¹Œé¾Ÿç”Ÿæˆå¤±è´¥ï¼ï¼ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.srv <span class="keyword">import</span> Spawn,SpawnRequest,SpawnResponse </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	</span><br><span class="line">    rospy.init_node(<span class="string">"service_call_p"</span>)</span><br><span class="line">    client = rospy.ServiceProxy(<span class="string">"/spawn"</span>,Spawn)</span><br><span class="line">    request = SpawnRequest()</span><br><span class="line">    request.x = <span class="number">4.0</span></span><br><span class="line">    request.y = <span class="number">1.0</span></span><br><span class="line">    request.theta = <span class="number">1.57</span></span><br><span class="line">    request.name = <span class="string">"turtlep"</span></span><br><span class="line">    client.wait_for_service()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = client.call(request)</span><br><span class="line">        rospy.loginfo(<span class="string">"ä¹Œé¾Ÿåˆ›å»ºæˆåŠŸ!ï¼Œå«:%s"</span>,response.name)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        rospy.loginfo(<span class="string">"æœåŠ¡è°ƒç”¨å¤±è´¥"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>å¯èƒ½ä¼šå‡ºç°å› ä¸ºé‡å¤å‘½åçš„å¼‚å¸¸</p>
<h4 id="å®æ“4-å‚æ•°è®¾ç½®"><a href="#å®æ“4-å‚æ•°è®¾ç½®" class="headerlink" title="å®æ“4 å‚æ•°è®¾ç½®"></a>å®æ“4 å‚æ•°è®¾ç½®</h4><p>éœ€æ±‚æè¿°: ä¿®æ”¹turtlesimä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹çª—ä½“çš„èƒŒæ™¯è‰²ï¼Œå·²çŸ¥èƒŒæ™¯è‰²æ˜¯é€šè¿‡å‚æ•°æœåŠ¡å™¨çš„æ–¹å¼ä»¥ rgb æ–¹å¼è®¾ç½®çš„</p>
<p>å®ç°åˆ†æ:</p>
<ol>
<li>é¦–å…ˆï¼Œéœ€è¦å¯åŠ¨ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹[æ³¨æ„è¿™é‡Œä¸å¯åŠ¨launchæ–‡ä»¶]</li>
<li>è¦é€šè¿‡ROSå‘½ä»¤ï¼Œæ¥è·å–å‚æ•°æœåŠ¡å™¨ä¸­è®¾ç½®èƒŒæ™¯è‰²çš„å‚æ•°</li>
<li>ç¼–å†™å‚æ•°è®¾ç½®èŠ‚ç‚¹ï¼Œä¿®æ”¹å‚æ•°æœåŠ¡å™¨ä¸­çš„å‚æ•°å€¼</li>
</ol>
<p>å®ç°æµç¨‹:</p>
<ol>
<li>é€šè¿‡roså‘½ä»¤è·å–å‚æ•°</li>
<li>ç¼–ç å®ç°æœå‚æ•°è®¾ç½®èŠ‚ç‚¹</li>
<li>å¯åŠ¨ roscoreã€turtlesim_node ä¸å‚æ•°è®¾ç½®èŠ‚ç‚¹ï¼ŒæŸ¥çœ‹è¿è¡Œç»“æœ</li>
</ol>
<p><strong>å‚æ•°åè·å–</strong></p>
<p>è·å–å‚æ•°åˆ—è¡¨ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosparam list</span><br></pre></td></tr></tbody></table></figure>

<p>å“åº”ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/turtle1/background_b</span><br><span class="line">/turtle1/background_g</span><br><span class="line">/turtle1/background_r</span><br><span class="line">/turtlesim/background_b</span><br><span class="line">/turtlesim/background_g</span><br><span class="line">/turtlesim/background_r</span><br></pre></td></tr></tbody></table></figure>

<p>æ–¹å¼1ï¼šå‘½ä»¤è¡Œå®ç°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rosparam set /turtlesim/background_r è‡ªå®šä¹‰æ•°å€¼</span><br><span class="line">rosparam set /turtlesim/background_g è‡ªå®šä¹‰æ•°å€¼</span><br><span class="line">rosparam set /turtlesim/background_b è‡ªå®šä¹‰æ•°å€¼</span><br></pre></td></tr></tbody></table></figure>

<p>ä¿®æ”¹ç›¸å…³å‚æ•°åï¼Œé‡å¯ turtlesim_node èŠ‚ç‚¹ï¼ŒèƒŒæ™¯è‰²å°±ä¼šå‘ç”Ÿæ”¹å˜äº†</p>
<p>æ–¹å¼2ï¼šä»£ç </p>
<p><strong>c++</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"color"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"/turtlesim/background_r"</span>,<span class="number">0</span>);</span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"/turtlesim/background_g"</span>,<span class="number">0</span>);</span><br><span class="line">    nh.<span class="built_in">setParam</span>(<span class="string">"/turtlesim/background_b"</span>,<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ros::NodeHandle nh("turtlesim"); //åŠ ä¸Šå‘½åç©ºé—´</span></span><br><span class="line">	<span class="comment">// nh.setParam("background_r",0);</span></span><br><span class="line">    <span class="comment">// nh.setParam("background_g",0);</span></span><br><span class="line">    <span class="comment">// nh.setParam("background_b",0);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"color_p"</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"/turtlesim/background_r"</span>,<span class="number">255</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"/turtlesim/background_g"</span>,<span class="number">255</span>)</span><br><span class="line">    rospy.set_param(<span class="string">"/turtlesim/background_b"</span>,<span class="number">255</span>)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="é€šä¿¡æœºåˆ¶æ¯”è¾ƒ"><a href="#é€šä¿¡æœºåˆ¶æ¯”è¾ƒ" class="headerlink" title="é€šä¿¡æœºåˆ¶æ¯”è¾ƒ"></a>é€šä¿¡æœºåˆ¶æ¯”è¾ƒ</h3><p>ä¸‰ç§é€šä¿¡æœºåˆ¶ä¸­</p>
<p>å‚æ•°æœåŠ¡å™¨æ˜¯ä¸€ç§æ•°æ®å…±äº«æœºåˆ¶ï¼Œå¯ä»¥åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¹‹é—´å…±äº«æ•°æ®</p>
<p>è¯é¢˜é€šä¿¡ä¸æœåŠ¡é€šä¿¡æ˜¯åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¹‹é—´ä¼ é€’æ•°æ®çš„</p>
<p>è¯é¢˜é€šä¿¡ï¼šPublisherâ†’Subscriber [Topic] [msg]</p>
<p>æœåŠ¡é€šä¿¡ï¼šClientâ†’Server [Service] [srv]</p>
<p>äºŒè€…çš„å®ç°æµç¨‹ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹é€šè¿‡è¯é¢˜å…³è”åˆ°ä¸€èµ·ï¼Œå¹¶ä½¿ç”¨æŸç§ç±»å‹çš„æ•°æ®è½½ä½“å®ç°æ•°æ®ä¼ è¾“</p>
<table>
<thead>
<tr>
<th></th>
<th>Topic(è¯é¢˜)</th>
<th>Service(æœåŠ¡)</th>
</tr>
</thead>
<tbody><tr>
<td>é€šä¿¡æ¨¡å¼</td>
<td>å‘å¸ƒ/è®¢é˜…</td>
<td>è¯·æ±‚/å“åº”</td>
</tr>
<tr>
<td>åŒæ­¥æ€§</td>
<td>å¼‚æ­¥(æ— åº)</td>
<td>åŒæ­¥(æœ‰åº)</td>
</tr>
<tr>
<td>åº•å±‚åè®®</td>
<td>ROSTCP/ROSUDP</td>
<td>ROSTCP/ROSUDP</td>
</tr>
<tr>
<td>ç¼“å†²åŒº</td>
<td>æœ‰(queue_size é˜Ÿåˆ—)</td>
<td>æ— </td>
</tr>
<tr>
<td>æ—¶æ—¶æ€§</td>
<td>å¼±</td>
<td>å¼º</td>
</tr>
<tr>
<td>èŠ‚ç‚¹å…³ç³»</td>
<td>å¤šå¯¹å¤š</td>
<td>ä¸€å¯¹å¤š(ä¸€ä¸ª Server)</td>
</tr>
<tr>
<td>é€šä¿¡æ•°æ®</td>
<td>msg</td>
<td>srv</td>
</tr>
<tr>
<td>ä½¿ç”¨åœºæ™¯</td>
<td>è¿ç»­é«˜é¢‘çš„æ•°æ®å‘å¸ƒä¸æ¥æ”¶ï¼šé›·è¾¾ã€é‡Œç¨‹è®¡</td>
<td>å¶å°”è°ƒç”¨æˆ–æ‰§è¡ŒæŸä¸€é¡¹ç‰¹å®šåŠŸèƒ½ï¼šæ‹ç…§ã€è¯­éŸ³è¯†åˆ«</td>
</tr>
</tbody></table>
<h2 id="ROSé€šä¿¡æœºåˆ¶è¿›é˜¶"><a href="#ROSé€šä¿¡æœºåˆ¶è¿›é˜¶" class="headerlink" title="ROSé€šä¿¡æœºåˆ¶è¿›é˜¶"></a>ROSé€šä¿¡æœºåˆ¶è¿›é˜¶</h2><p><a target="_blank" rel="noopener" href="https://docs.ros.org/en/api/roscpp/html/">roscpp</a>	<a target="_blank" rel="noopener" href="https://wiki.ros.org/rospy">rospy</a></p>
<h3 id="å¸¸ç”¨API"><a href="#å¸¸ç”¨API" class="headerlink" title="å¸¸ç”¨API"></a>å¸¸ç”¨API</h3><p>å»ºè®®å‚è€ƒå®˜æ–¹APIæ–‡æ¡£æˆ–å‚è€ƒæºç </p>
<p>åœ¨è¿è¡Œç¨‹åºæ—¶rosrun åæ¥ç€å†™ _[å‚æ•°å] = [å‚æ•°å€¼] å¯ä»¥ç»™èŠ‚ç‚¹ </p>
<h4 id="åˆå§‹åŒ–å‡½æ•°"><a href="#åˆå§‹åŒ–å‡½æ•°" class="headerlink" title="åˆå§‹åŒ–å‡½æ•°"></a>åˆå§‹åŒ–å‡½æ•°</h4><p>ros::init(argc, argv, â€œnameâ€, [options])</p>
<ol>
<li><p>argc â€” å°è£…å®å‚çš„ä¸ªæ•°(n+1)</p>
</li>
<li><p>argv â€” å°è£…å‚æ•°çš„æ•°ç»„</p>
</li>
<li><p>name â€” ä¸ºèŠ‚ç‚¹å‘½å(å”¯ä¸€æ€§)</p>
</li>
<li><p>options â€” èŠ‚ç‚¹å¯åŠ¨é€‰é¡¹  ros::init_options::AnonymousName  </p>
<blockquote>
<p>ç»™å‰é¢çš„èŠ‚ç‚¹å‘½ååå¢åŠ ä¸€ä¸ªéšæœºæ•°ï¼Œä½¿å¾—åŒä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿé‡å¤å¯åŠ¨</p>
<p>å¦åˆ™é‡åæƒ…å†µä¸‹ï¼Œç¬¬äºŒæ¬¡å¯åŠ¨æ—¶ç¬¬ä¸€æ¬¡ä¼šè‡ªåŠ¨åœæ­¢</p>
</blockquote>
</li>
</ol>
<p>è¿”å›å€¼: void</p>
<p>rospy.init_node(name, argv=None, anonymous=False) </p>
<ol>
<li>name â€” èŠ‚ç‚¹åç§°</li>
<li>argv â€” å°è£…èŠ‚ç‚¹è°ƒç”¨æ—¶ä¼ é€’çš„å‚æ•°</li>
<li>anonymous â€” å–å€¼ä¸º true æ—¶ï¼Œä¸ºèŠ‚ç‚¹åç§°åç¼€éšæœºç¼–å·</li>
</ol>
<h4 id="è¯é¢˜ä¸æœåŠ¡"><a href="#è¯é¢˜ä¸æœåŠ¡" class="headerlink" title="è¯é¢˜ä¸æœåŠ¡"></a>è¯é¢˜ä¸æœåŠ¡</h4><p>åœ¨ roscpp ä¸­ï¼Œè¯é¢˜å’ŒæœåŠ¡çš„ç›¸å…³å¯¹è±¡ä¸€èˆ¬ç”± ros::NodeHandle nh åˆ›å»ºï¼Œpythonä¸­ä¸ç”¨ä¸“é—¨åˆ›å»ºNodeHandle  </p>
<p><strong>å‘å¸ƒå¯¹è±¡</strong></p>
<p>ros::Publisher pub = nh.advertise&lt; type &gt;(â€œtopicâ€, queue_size, [latch])</p>
<ol>
<li><p>type â€” æ¶ˆæ¯ç±»å‹</p>
</li>
<li><p>topic â€” è¯é¢˜åç§°</p>
</li>
<li><p>queue_size â€” é˜Ÿåˆ—é•¿åº¦</p>
</li>
<li><p>latch â€” è®¾ç½®ä¸ºtureæ—¶ï¼Œè¯¥è¯é¢˜å‘å¸ƒçš„æœ€åä¸€æ¡æ¶ˆæ¯å°†è¢«ä¿å­˜ï¼Œå¹¶ä¸”å½“æœ‰è®¢é˜…è€…è¿æ¥æ—¶ä¼šå°†è¯¥æ¶ˆæ¯å‘é€ç»™è®¢é˜…è€…</p>
<p>ä»¥é™æ€åœ°å›¾å‘é€ä¸ºä¾‹(çŸ­æ—¶é—´ä¸å˜çš„æ•°æ®)</p>
<p>æ–¹æ¡ˆ1ï¼šå¯ä»¥ä½¿ç”¨å›ºå®šé¢‘ç‡å‘é€åœ°å›¾æ•°æ®ï¼Œä½†æ˜¯æ•ˆç‡ä½</p>
<p>æ–¹æ¡ˆ2ï¼šå¯ä»¥å°†åœ°å›¾å‘å¸ƒå¯¹è±¡çš„latchè®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”å‘å¸ƒæ–¹åªå‘é€ä¸€æ¬¡æ•°æ®ï¼Œæ¯å½“è®¢é˜…è€…è¿æ¥æ—¶ï¼Œå°†åœ°å›¾æ•°æ®å‘é€ç»™è®¢é˜…è€…(åªå‘é€ä¸€æ¬¡)ï¼Œè¿™æ ·æé«˜äº†æ•°æ®çš„å‘é€æ•ˆç‡</p>
</li>
</ol>
<p>pub = rospy.Publisher(â€œtopicâ€, type, queue_size, [lathc])</p>
<p><strong>è®¢é˜…å¯¹è±¡</strong>  </p>
<p>ros::Subscriber sub = nh.subscribe(â€œtopicâ€, queue_size, callback);</p>
<blockquote>
<p>void callback(const std_msgs::String::ConstPtr &amp;msg)</p>
</blockquote>
<p>sub = rospy.Subscriber(â€œtopicâ€, type, callback, queue_size)</p>
<blockquote>
<p>def callback(msg):</p>
</blockquote>
<p><strong>æœåŠ¡å¯¹è±¡</strong></p>
<p>ros::ServiceServer server = nh.advertiseService(â€œserviceâ€, callback);</p>
<blockquote>
<p>bool callback(srv type::Request &amp;req, srv type::Response &amp;resp)</p>
</blockquote>
<p>server = rospy.Service(â€œserviceâ€, srv type, callback)</p>
<blockquote>
<p>def callback(req):</p>
<p>return resp</p>
</blockquote>
<p><strong>å®¢æˆ·ç«¯å¯¹è±¡</strong></p>
<p>ros::ServiceClient client = nh.serviceClient&lt; srv type &gt;(â€œserviceâ€);</p>
<p>ç­‰å¾…æœåŠ¡å‡½æ•°1  ros::service::waitForService(â€œserviceâ€)</p>
<p>ç­‰å¾…æœåŠ¡å‡½æ•°2  client.waitForExistence();</p>
<p>è¯·æ±‚å†™å…¥ï¼šsrv type req; req.request.input1 = atoi(argv[1]); (ç±»æ¨å†™å®Œè¾“å…¥)</p>
<p>client = rospy.ServiceProxy(â€œserviceâ€, srv type)</p>
<p>ç­‰å¾…æœåŠ¡å‡½æ•°    client.wait_for_service()</p>
<p>è¯·æ±‚å†™å…¥ï¼šreq = srv typeRequets() req.input1 = sys.argv[1] (ç±»æ¨å†™å®Œè¾“å…¥)</p>
<h4 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h4><p>spinOnce()  å¤„ç†ä¸€è½®å›è°ƒï¼Œä¸€èˆ¬ç”¨äºå¾ªç¯ä½“å†…</p>
<p>spin() è¿›å…¥å¾ªç¯å»å¤„ç†å›è°ƒ</p>
<p>ä¸åŒç‚¹ï¼šåœ¨ros::spin() åçš„è¯­å¥ä¸ä¼šæ‰§è¡Œåˆ°ï¼Œè€Œ ros::spinOnce() åçš„è¯­å¥å¯ä»¥æ‰§è¡Œ</p>
<p>python åªæœ‰ rospy.spin()</p>
<h4 id="æ—¶é—´"><a href="#æ—¶é—´" class="headerlink" title="æ—¶é—´"></a>æ—¶é—´</h4><p><strong>æ—¶åˆ»</strong> </p>
<p>è·å–æ—¶åˆ»ï¼Œæˆ–æ˜¯è®¾ç½®æŒ‡å®šæ—¶åˆ»</p>
<p>ros::Time::now()</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"hello_time"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// è·å–å½“å‰æ—¶åˆ»ï¼šnow è¢«è°ƒç”¨æ‰§è¡Œçš„é‚£ä¸€åˆ»</span></span><br><span class="line">    <span class="comment">// å‚è€ƒç³»ï¼š1970å¹´01æœˆ01æ—¥ 00:00:00</span></span><br><span class="line">    ros::Time current_time = ros::Time::<span class="built_in">now</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–è·ç¦» 1970å¹´01æœˆ01æ—¥ 00:00:00 çš„ç§’æ•°</span></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"å½“å‰æ—¶åˆ»:%.2f"</span>,current_time.<span class="built_in">toSec</span>()); <span class="comment">// æµ®ç‚¹å‹</span></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"å½“å‰æ—¶åˆ»:%d"</span>,current_time.sec);  <span class="comment">// æ•´å‹    </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è½¬åŒ–ä¸ºå¹´æœˆæ—¥æ—¶åˆ†ç§’æ ¼å¼</span></span><br><span class="line">    std::<span class="type">time_t</span> raw_time = current_time.<span class="built_in">toSec</span>(); <span class="comment">// è½¬æ¢ä¸ºç§’</span></span><br><span class="line">    std::tm* time_info = std::<span class="built_in">localtime</span>(&amp;raw_time); <span class="comment">// è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´</span></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦UTCæ—¶é—´ä½¿ç”¨ std::gmtime</span></span><br><span class="line">    <span class="type">char</span> buffer[<span class="number">80</span>];</span><br><span class="line">    std::<span class="built_in">strftime</span>(buffer, <span class="built_in">sizeof</span>(buffer), <span class="string">"%Y-%m-%d %H:%M:%S"</span>, time_info); <span class="comment">// æ ¼å¼åŒ–æ—¶é—´</span></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"å½“å‰æ—¶é—´: %s"</span>,buffer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®æŒ‡å®šæ—¶åˆ»</span></span><br><span class="line">    <span class="function">ros::Time <span class="title">t1</span><span class="params">(<span class="number">100</span>,<span class="number">100000000</span>)</span></span>; <span class="comment">// å‚æ•°1:ç§’æ•°  å‚æ•°2:çº³ç§’</span></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"æ—¶åˆ»:%.2f"</span>,t<span class="number">1.</span><span class="built_in">toSec</span>()); </span><br><span class="line">    <span class="function">ros::Time <span class="title">t2</span><span class="params">(<span class="number">100.1</span>)</span></span>; <span class="comment">// ä¼ å…¥æµ®ç‚¹å‹</span></span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"æ—¶åˆ»:%.2f"</span>,t<span class="number">2.</span><span class="built_in">toSec</span>()); </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>å‘½åå¢åŠ æ—¶é—´æˆ³æ–¹æ³•ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="type">time_t</span> raw_time = ros::Time::<span class="built_in">now</span>().<span class="built_in">toSec</span>(); <span class="comment">// è½¬æ¢ä¸ºç§’</span></span><br><span class="line">std::tm* time_info = std::<span class="built_in">localtime</span>(&amp;raw_time); <span class="comment">// è½¬æ¢ä¸ºæœ¬åœ°æ—¶é—´</span></span><br><span class="line"><span class="comment">// å¦‚æœéœ€è¦UTCæ—¶é—´ä½¿ç”¨ std::gmtime</span></span><br><span class="line"><span class="type">char</span> buffer[<span class="number">80</span>];</span><br><span class="line">std::<span class="built_in">strftime</span>(buffer, <span class="built_in">sizeof</span>(buffer), <span class="string">"%Y%m%d_%H%M%S"</span>, time_info); <span class="comment">// æ ¼å¼åŒ–æ—¶é—´</span></span><br></pre></td></tr></tbody></table></figure>

<p>åç»­ç›´æ¥+bufferå³å¯</p>
<p>rospy.Time.now()</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">current_time = rospy.Time.now()</span><br><span class="line">rospy.loginfo(<span class="string">"å½“å‰æ—¶åˆ»:%.2f"</span>,right_now.to_sec()) <span class="comment"># æµ®ç‚¹å‹</span></span><br><span class="line">rospy.loginfo(<span class="string">"å½“å‰æ—¶åˆ»:%.2f"</span>,right_now.to_nsec()) <span class="comment"># æ•´å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æŒ‡å®šæ—¶åˆ»</span></span><br><span class="line">time1 = rospy.Time(<span class="number">100</span>,<span class="number">100000000</span>)  <span class="comment"># å‚æ•°1:ç§’æ•°  å‚æ•°2:çº³ç§’</span></span><br><span class="line">time2 = rospy.Time(<span class="number">100.1</span>)</span><br><span class="line">time3 = rospy.Time.from_sec(<span class="number">100.1</span>)</span><br><span class="line">rospy.loginfo(<span class="string">"è®¾ç½®æ—¶åˆ»1:%.2f"</span>,time1.to_sec())</span><br><span class="line">rospy.loginfo(<span class="string">"è®¾ç½®æ—¶åˆ»2:%.2f"</span>,time2.to_sec())</span><br><span class="line">rospy.loginfo(<span class="string">"è®¾ç½®æ—¶åˆ»2:%.2f"</span>,time3.to_sec())</span><br></pre></td></tr></tbody></table></figure>

<p><strong>æŒç»­æ—¶é—´</strong></p>
<p>è®¾ç½®ä¸€ä¸ªæ—¶é—´åŒºé—´(é—´éš”)</p>
<p>ros::Duration du()</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">"å¼€å§‹ä¼‘çœ :%.2f"</span>,ros::Time::<span class="built_in">now</span>().<span class="built_in">toSec</span>());</span><br><span class="line"><span class="function">ros::Duration <span class="title">du</span><span class="params">(<span class="number">4.5</span>)</span></span>;<span class="comment">//æŒç»­4.5ç§’,doubleç±»å‹ï¼Œä»¥ç§’ä¸ºå•ä½</span></span><br><span class="line">du.<span class="built_in">sleep</span>();</span><br><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">"ç»“æŸä¼‘çœ :%.2f"</span>,ros::Time::<span class="built_in">now</span>().<span class="built_in">toSec</span>());</span><br></pre></td></tr></tbody></table></figure>

<p>du = rospy.Duration()</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rospy.loginfo(<span class="string">"æŒç»­æ—¶é—´æµ‹è¯•å¼€å§‹....."</span>)</span><br><span class="line">du = rospy.Duration(<span class="number">3.3</span>)</span><br><span class="line">rospy.sleep(du) <span class="comment">#ä¼‘çœ å‡½æ•°</span></span><br><span class="line">rospy.loginfo(<span class="string">"æŒç»­æ—¶é—´æµ‹è¯•ç»“æŸ....."</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>æ—¶åˆ»è¿ç®—</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ros::Time begin = ros::Time::<span class="built_in">now</span>();</span><br><span class="line"><span class="function">ros::Duration <span class="title">du1</span><span class="params">(<span class="number">5</span>)</span></span>;     <span class="comment">// æ¨¡æ‹Ÿè¿è¡Œæ—¶é—´</span></span><br><span class="line">ros::Time stop = begin + du1;</span><br><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">"å¼€å§‹æ—¶åˆ»:%.2f"</span>,begin.<span class="built_in">toSec</span>());</span><br><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">"ç»“æŸæ—¶åˆ»:%.2f"</span>,stop.<span class="built_in">toSec</span>());</span><br></pre></td></tr></tbody></table></figure>

<p>time ä¸ duration å¯ä»¥+/-ï¼Œduration ä¹‹é—´ä¹Ÿå¯ä»¥+/-</p>
<p>ä½†time ä¹‹é—´åªå¯ä»¥ - ï¼Œä¸å¯ä»¥ + ï¼Œè¿”å›çš„æ˜¯ ros::Duration ç±»å‹</p>
<p>pythonä¸c++ç›¸åŒ</p>
<p><strong>è®¾ç½®è¿è¡Œé¢‘ç‡</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ros::Rate <span class="title">rate</span><span class="params">(<span class="number">1</span>)</span></span>;<span class="comment">//æŒ‡å®šé¢‘ç‡</span></span><br><span class="line">   <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">   {</span><br><span class="line">       rate.<span class="built_in">sleep</span>(); <span class="comment">// è¦æ”¾åœ¨å¾ªç¯é‡Œ</span></span><br><span class="line">   }</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">    rate.sleep() <span class="comment">#ä¼‘çœ ï¼Œè¦æ”¾åœ¨å¾ªç¯é‡Œ</span></span><br><span class="line">    rospy.loginfo(<span class="string">"+++++++++++++++"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p><strong>å®šæ—¶å™¨</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">cb</span><span class="params">(<span class="type">const</span> ros::TimerEvent &amp;event)</span></span>{</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"----"</span>);</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"è°ƒç”¨æ—¶åˆ»:%.2f"</span>,event.current_real.<span class="built_in">toSec</span>());</span><br><span class="line">}</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    Timer createTimer(ros::Duration(period), // æ—¶é—´é—´éš”</span></span><br><span class="line"><span class="comment">        const TimerCallback&amp; callback,      // å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">        bool oneshot = false,               // æ˜¯å¦ä¸€æ¬¡æ€§</span></span><br><span class="line"><span class="comment">        bool autostart = true ï¼‰            // æ˜¯å¦è‡ªåŠ¨å¯åŠ¨ï¼Œè®¾ç½®ä¸ºfalseæ—¶éœ€è¦æ‰‹åŠ¨å¯åŠ¨ time.start()</span></span><br><span class="line"><span class="comment">    å®šæ—¶å™¨å¯åŠ¨éœ€è¦ros::spin() å› ä¸ºæœ‰å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">    ros::Timer timer = nh.<span class="built_in">createTimer</span>(ros::<span class="built_in">Duration</span>(<span class="number">1</span>),cb);</span><br><span class="line">    <span class="comment">// ros::Timer timer = nh.createTimer(ros::Duration(1),cb,false,false);</span></span><br><span class="line">    <span class="comment">// timer.start(); // æ‰‹åŠ¨å¯åŠ¨</span></span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cb</span>(<span class="params">event</span>):</span><br><span class="line">    rospy.loginfo(<span class="string">"+++++++++++"</span>)</span><br><span class="line">    rospy.loginfo(<span class="string">"å½“å‰æ—¶åˆ»:%.2f"</span>,event.current_real.to_sec())</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">	rospy.Timer(rospy.Duration(period), // æ—¶é—´é—´éš”</span></span><br><span class="line"><span class="string">				callback,				// å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="string">				oneshot=False,			// æ˜¯å¦ä¸€æ¬¡æ€§</span></span><br><span class="line"><span class="string">                reset=False)			</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">    rospy.Timer(rospy.Duration(<span class="number">1</span>),cb)</span><br><span class="line">	<span class="comment"># rospy.Timer(rospy.Duration(1),cb,True) # åªæ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">	rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<h4 id="å…¶å®ƒå‡½æ•°"><a href="#å…¶å®ƒå‡½æ•°" class="headerlink" title="å…¶å®ƒå‡½æ•°"></a>å…¶å®ƒå‡½æ•°</h4><p>åœ¨å‘å¸ƒå®ç°æ—¶ï¼Œä¸€èˆ¬ä¼šå¾ªç¯å‘å¸ƒæ¶ˆæ¯ï¼Œå¾ªç¯çš„åˆ¤æ–­æ¡ä»¶ä¸€èˆ¬ç”±èŠ‚ç‚¹çŠ¶æ€æ¥æ§åˆ¶</p>
<p>C++ä¸­å¯ä»¥é€šè¿‡ ros::ok() æ¥åˆ¤æ–­èŠ‚ç‚¹çŠ¶æ€æ˜¯å¦æ­£å¸¸ï¼Œè€Œ python ä¸­åˆ™é€šè¿‡ rospy.is_shutdown() æ¥å®ç°åˆ¤æ–­ï¼Œå¯¼è‡´èŠ‚ç‚¹é€€å‡ºçš„åŸå› ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>èŠ‚ç‚¹æ¥æ”¶åˆ°äº†å…³é—­ä¿¡æ¯ï¼Œæ¯”å¦‚å¸¸ç”¨çš„ ctrl + c(z) å¿«æ·é”®å°±æ˜¯å…³é—­èŠ‚ç‚¹çš„ä¿¡å·</li>
<li>åŒåèŠ‚ç‚¹å¯åŠ¨ï¼Œå¯¼è‡´ç°æœ‰èŠ‚ç‚¹é€€å‡º</li>
<li>ç¨‹åºä¸­çš„å…¶ä»–éƒ¨åˆ†è°ƒç”¨äº†èŠ‚ç‚¹å…³é—­ç›¸å…³çš„API(C++ä¸­æ˜¯ros::shutdown()ï¼Œpythonä¸­æ˜¯rospy.signal_shutdown())</li>
</ul>
<p>æ—¥å¿—å‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ROS_DEBUG</span>(<span class="string">"hello,DEBUG"</span>); <span class="comment">//ä¸ä¼šè¾“å‡º</span></span><br><span class="line"><span class="built_in">ROS_INFO</span>(<span class="string">"hello,INFO"</span>); <span class="comment">//é»˜è®¤ç™½è‰²å­—ä½“</span></span><br><span class="line"><span class="built_in">ROS_WARN</span>(<span class="string">"Hello,WARN"</span>); <span class="comment">//é»˜è®¤é»„è‰²å­—ä½“</span></span><br><span class="line"><span class="built_in">ROS_ERROR</span>(<span class="string">"hello,ERROR"</span>);<span class="comment">//é»˜è®¤çº¢è‰²å­—ä½“</span></span><br><span class="line"><span class="built_in">ROS_FATAL</span>(<span class="string">"hello,FATAL"</span>);<span class="comment">//é»˜è®¤çº¢è‰²å­—ä½“</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rospy.logdebug(<span class="string">"hello,debug"</span>)  <span class="comment">#ä¸ä¼šè¾“å‡º</span></span><br><span class="line">rospy.loginfo(<span class="string">"hello,info"</span>)  <span class="comment">#é»˜è®¤ç™½è‰²å­—ä½“</span></span><br><span class="line">rospy.logwarn(<span class="string">"hello,warn"</span>)  <span class="comment">#é»˜è®¤é»„è‰²å­—ä½“</span></span><br><span class="line">rospy.logerr(<span class="string">"hello,error"</span>)  <span class="comment">#é»˜è®¤çº¢è‰²å­—ä½“</span></span><br><span class="line">rospy.logfatal(<span class="string">"hello,fatal"</span>) <span class="comment">#é»˜è®¤çº¢è‰²å­—ä½“</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶"><a href="#å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶" class="headerlink" title="å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶"></a>å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶</h3><p>æ ¸å¿ƒå†…å®¹åœ¨äºCMakeLists.txtæ–‡ä»¶çš„é…ç½®</p>
<h4 id="è‡ªå®šä¹‰å¤´æ–‡ä»¶è°ƒç”¨"><a href="#è‡ªå®šä¹‰å¤´æ–‡ä»¶è°ƒç”¨" class="headerlink" title="è‡ªå®šä¹‰å¤´æ–‡ä»¶è°ƒç”¨"></a>è‡ªå®šä¹‰å¤´æ–‡ä»¶è°ƒç”¨</h4><p>æµç¨‹: </p>
<ol>
<li>ç¼–å†™å¤´æ–‡ä»¶ï¼›</li>
<li>ç¼–å†™å¯æ‰§è¡Œæ–‡ä»¶(åŒæ—¶ä¹Ÿæ˜¯æºæ–‡ä»¶)ï¼›</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶å¹¶æ‰§è¡Œã€‚</li>
</ol>
<p><strong>å¤´æ–‡ä»¶</strong></p>
<p>åœ¨åŠŸèƒ½åŒ…ä¸‹çš„<code>include/åŠŸèƒ½åŒ…å</code>ç›®å½•ä¸‹æ–°å»ºå¤´æ–‡ä»¶: hello.h</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _HELLO_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _HELLO_H</span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    å£°æ˜namespace</span></span><br><span class="line"><span class="comment">        |-- class</span></span><br><span class="line"><span class="comment">            |- run</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> hello_ns{</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyHello</span>{</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">run</span><span class="params">()</span></span>;</span><br><span class="line">};</span><br><span class="line">    </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></tbody></table></figure>

<p>ä¸ºäº†åç»­åŒ…å«å¤´æ–‡ä»¶æ—¶ä¸æŠ›å‡ºå¼‚å¸¸ï¼Œé…ç½® .vscode ä¸‹ _cpp_properties.json çš„ includepathå±æ€§ï¼ˆå’Œä¹‹å‰é…ç½®æœåŠ¡srvæ–‡ä»¶ç”Ÿæˆçš„å¤´æ–‡ä»¶è¿‡ç¨‹ç›¸ä¼¼ï¼‰</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">"includePath"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">		...</span><br><span class="line">        <span class="string">"/home/ros/demo03_ws/src/plumbing_head/include/**"</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>æºæ–‡ä»¶</strong></p>
<p>srcç›®å½•ä¸‹æ–°å»º hello.cpp</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_head/hello.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> hello_ns{</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MyHello::run</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">ROS_INFO</span>(<span class="string">"runå‡½æ•°æ‰§è¡Œ...."</span>);</span><br><span class="line">}    </span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"hello_head"</span>);</span><br><span class="line">    hello_ns::MyHello myhello;</span><br><span class="line">    myhello.<span class="built_in">run</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>é…ç½®æ–‡ä»¶</strong></p>
<p>ä¸ä¹‹å‰é…ç½®å¤šä¸€æ­¥</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">include_directories(</span><br><span class="line">include // è¿™é‡Œè§£é™¤æ³¨é‡Š</span><br><span class="line">  ${catkin_INCLUDE_DIRS}</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">add_executable(hello src/hello.cpp)</span><br><span class="line"></span><br><span class="line">add_dependencies(hello ${${PROJECT_NAME}_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS})</span><br><span class="line"></span><br><span class="line">target_link_libraries(hello</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h4 id="è‡ªå®šä¹‰æºæ–‡ä»¶è°ƒç”¨"><a href="#è‡ªå®šä¹‰æºæ–‡ä»¶è°ƒç”¨" class="headerlink" title="è‡ªå®šä¹‰æºæ–‡ä»¶è°ƒç”¨"></a>è‡ªå®šä¹‰æºæ–‡ä»¶è°ƒç”¨</h4><p>æµç¨‹:</p>
<ol>
<li>ç¼–å†™å¤´æ–‡ä»¶ï¼›</li>
<li>ç¼–å†™æºæ–‡ä»¶ï¼›</li>
<li>ç¼–å†™å¯æ‰§è¡Œæ–‡ä»¶ï¼›</li>
<li>ç¼–è¾‘é…ç½®æ–‡ä»¶å¹¶æ‰§è¡Œã€‚</li>
</ol>
<p><strong>å¯æ‰§è¡Œæ–‡ä»¶</strong></p>
<p>srcç›®å½•ä¸‹æ–°å»º use_head.cpp</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"plumbing_head/hello.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"hello_head_src"</span>);</span><br><span class="line">    hello_ns::MyHello my;</span><br><span class="line">    my.<span class="built_in">run</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>é…ç½®æ–‡ä»¶</strong></p>
<p>å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶ç›¸å…³é…ç½®ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">include_directories(</span><br><span class="line">include // è¿™é‡Œè§£é™¤æ³¨é‡Š</span><br><span class="line">  ${catkin_INCLUDE_DIRS}</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">## å£°æ˜C++åº“</span><br><span class="line">## Declare a C++ library</span><br><span class="line"># add_library(${PROJECT_NAME}</span><br><span class="line">#   src/${PROJECT_NAME}/plumbing_pub_sub.cpp</span><br><span class="line"># )</span><br><span class="line">add_library(head_src</span><br><span class="line">  include/${PROJECT_NAME}/hello.h</span><br><span class="line">  src/hello.cpp</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">add_dependencies(head_src ${${PROJECT_NAME}_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS})</span><br><span class="line"></span><br><span class="line">target_link_libraries(head_src</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<p>å¯æ‰§è¡Œæ–‡ä»¶é…ç½®:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">add_executable(use_hello src/use_hello.cpp)</span><br><span class="line"></span><br><span class="line">add_dependencies(use_hello ${${PROJECT_NAME}_EXPORTED_TARGETS} ${catkin_EXPORTED_TARGETS})</span><br><span class="line"></span><br><span class="line">#æ­¤å¤„éœ€è¦æ·»åŠ ä¹‹å‰è®¾ç½®çš„åº“</span><br><span class="line">target_link_libraries(use_hello</span><br><span class="line">  head_src // åº“å£°æ˜</span><br><span class="line">  ${catkin_LIBRARIES}</span><br><span class="line">)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Pythonæ¨¡å—å¯¼å…¥"><a href="#Pythonæ¨¡å—å¯¼å…¥" class="headerlink" title="Pythonæ¨¡å—å¯¼å…¥"></a>Pythonæ¨¡å—å¯¼å…¥</h3><p>å®ç°:</p>
<ol>
<li>æ–°å»ºä¸¤ä¸ªPythonæ–‡ä»¶ï¼Œä½¿ç”¨ import å®ç°å¯¼å…¥å…³ç³»ï¼›</li>
<li>æ·»åŠ å¯æ‰§è¡Œæƒé™ã€ç¼–è¾‘é…ç½®æ–‡ä»¶å¹¶æ‰§è¡ŒUseA</li>
</ol>
<p>tool.pyæ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line">num = <span class="number">1000</span></span><br></pre></td></tr></tbody></table></figure>

<p>use_tool.pyæ–‡ä»¶</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸´æ—¶ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="comment"># sys.path.insert(0,"/home/ros/demo03_ws/src/plumbing_pub_sub/scripts")</span></span><br><span class="line"><span class="comment"># è·¯å¾„åŠ¨æ€ï¼Œä¿è¯ç§»æ¤å¯æ‰§è¡Œ</span></span><br><span class="line">path = os.path.abspath(<span class="string">"."</span>)</span><br><span class="line">sys.path.insert(<span class="number">0</span>,path + <span class="string">"/src/plumbing_head/scripts"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tool</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"tool"</span>)</span><br><span class="line">    <span class="comment"># å¼‚å¸¸ï¼šModuleNotFoundError:No module named'tools'</span></span><br><span class="line">    <span class="string">""" </span></span><br><span class="line"><span class="string">        åŸå› : rosrun æ‰§è¡Œæ—¶ï¼Œå‚è€ƒè·¯å¾„æ˜¯å·¥ä½œç©ºé—´çš„è·¯å¾„ï¼Œåœ¨å·¥ä½œç©ºé—´ä¸‹æ— æ³•æŸ¥æ‰¾ä¾èµ–çš„æ¨¡å— </span></span><br><span class="line"><span class="string">        è§£å†³ï¼šå¯ä»¥å£°æ˜pythonçš„ç¯å¢ƒå˜é‡,å½“ä¾èµ–æŸä¸ªæ¨¡å—æ—¶,å…ˆå»æŒ‡å®šç¯å¢ƒå˜é‡ä¸­æŸ¥æ‰¾ä¾èµ–</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    rospy.loginfo(<span class="string">"num=%d"</span>,tool.num)</span><br></pre></td></tr></tbody></table></figure>

<h2 id="ROSè¿è¡Œç®¡ç†"><a href="#ROSè¿è¡Œç®¡ç†" class="headerlink" title="ROSè¿è¡Œç®¡ç†"></a>ROSè¿è¡Œç®¡ç†</h2><h3 id="å…ƒåŠŸèƒ½åŒ…"><a href="#å…ƒåŠŸèƒ½åŒ…" class="headerlink" title="å…ƒåŠŸèƒ½åŒ…"></a>å…ƒåŠŸèƒ½åŒ…</h3><p>å®ŒæˆROSä¸­ä¸€ä¸ªç³»ç»Ÿæ€§çš„åŠŸèƒ½ï¼Œå¯èƒ½æ¶‰åŠåˆ°å¤šä¸ªåŠŸèƒ½åŒ…ï¼Œé€ä¸€å®‰è£…åŠŸèƒ½åŒ…çš„æ•ˆç‡ä½ä¸‹ï¼Œåœ¨ROSä¸­ï¼Œæä¾›äº†ä¸€ç§æ–¹å¼å¯ä»¥å°†ä¸åŒçš„åŠŸèƒ½åŒ…æ‰“åŒ…æˆä¸€ä¸ªåŠŸèƒ½åŒ…ï¼Œå½“å®‰è£…æŸä¸ªåŠŸèƒ½æ¨¡å—æ—¶ï¼Œç›´æ¥è°ƒç”¨æ‰“åŒ…åçš„åŠŸèƒ½åŒ…å³å¯ï¼Œè¯¥åŒ…åˆç§°ä¹‹ä¸ºå…ƒåŠŸèƒ½åŒ…</p>
<p><code>MetaPackage</code>æ˜¯Linuxçš„ä¸€ä¸ªæ–‡ä»¶ç®¡ç†ç³»ç»Ÿçš„æ¦‚å¿µï¼Œæ˜¯ROSä¸­çš„ä¸€ä¸ªè™šåŒ…ï¼Œé‡Œé¢æ²¡æœ‰å®è´¨æ€§çš„å†…å®¹ï¼Œä½†æ˜¯å®ƒä¾èµ–äº†å…¶ä»–çš„è½¯ä»¶åŒ…ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥æŠŠå…¶ä»–åŒ…ç»„åˆèµ·æ¥ï¼Œå¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€æœ¬ä¹¦çš„ç›®å½•ç´¢å¼•ï¼Œå‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªåŒ…é›†åˆä¸­æœ‰å“ªäº›å­åŒ…ï¼Œå¹¶ä¸”è¯¥å»å“ªé‡Œä¸‹è½½</p>
<p>ä¾‹å¦‚ï¼šsudo apt install ros-noetic-desktop-full å‘½ä»¤å®‰è£…rosæ—¶å°±ä½¿ç”¨äº†å…ƒåŠŸèƒ½åŒ…</p>
<p><strong>å®ç°</strong></p>
<p>æ–°å»ºä¸€ä¸ªåŠŸèƒ½åŒ…ï¼Œä¸éœ€è¦æ·»åŠ ä¾èµ–ï¼Œä¿®æ”¹package.xml</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">buildtool_depend</span>&gt;</span>catkin<span class="tag">&lt;/<span class="name">buildtool_depend</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ·»åŠ ä¾èµ–çš„åŠŸèƒ½åŒ…å --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>plumbing_pub_sub<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>plumbing_server_client<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">exec_depend</span>&gt;</span>plumbing_param_server<span class="tag">&lt;/<span class="name">exec_depend</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- The export tag contains other, unspecified, tags --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">export</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">metapackage</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">export</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>ä¿®æ”¹ CMakeLists.txt</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cmake_minimum_required(VERSION 3.0.2)</span><br><span class="line">project(plumbing_my)</span><br><span class="line">find_package(catkin REQUIRED)</span><br><span class="line">catkin_metapackage()</span><br></pre></td></tr></tbody></table></figure>

<p><font color="Violetred">ä¸èƒ½å‡ºç°æ¢è¡Œä»¥åŠæ³¨é‡Š</font></p>
<p><a target="_blank" rel="noopener" href="https://wiki.ros.org/catkin/package.xml#Metapackages">catkin/package.xml - ROS Wiki</a></p>
<h3 id="launchæ–‡ä»¶-1"><a href="#launchæ–‡ä»¶-1" class="headerlink" title="launchæ–‡ä»¶"></a>launchæ–‡ä»¶</h3><p>åœ¨åŠŸèƒ½åŒ…ä¸‹æ·»åŠ  launchç›®å½•, ç›®å½•ä¸‹æ–°å»º xxxx.launch æ–‡ä»¶ï¼Œç¼–è¾‘ launch æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node"     name="myTurtle" output="screen" /&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtle_teleop_key"  name="myTurtleContro" output="screen" /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>è°ƒç”¨ launch æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch åŒ…å xxx.launch</span><br></pre></td></tr></tbody></table></figure>

<p>roslaunch å‘½ä»¤æ‰§è¡Œlaunchæ–‡ä»¶æ—¶ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æ˜¯å¦å¯åŠ¨äº† roscoreï¼Œå¦‚æœå¯åŠ¨äº†ï¼Œåˆ™ä¸å†å¯åŠ¨ï¼Œå¦åˆ™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ roscore</p>
<p><strong>launchæ ‡ç­¾</strong></p>
<p><code>&lt;launch&gt;</code>æ ‡ç­¾æ˜¯æ‰€æœ‰ launch æ–‡ä»¶çš„æ ¹æ ‡ç­¾ï¼Œå……å½“å…¶ä»–æ ‡ç­¾çš„å®¹å™¨</p>
<p>deprecated å‘ŠçŸ¥ç”¨æˆ·å½“å‰ launch æ–‡ä»¶å·²ç»å¼ƒç”¨</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch deprecated="æ­¤æ–‡ä»¶å¯èƒ½è¿‡æ—¶ï¼"&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>nodeæ ‡ç­¾</strong></p>
<p><code>&lt;node&gt;</code>æ ‡ç­¾ç”¨äºæŒ‡å®š ROS èŠ‚ç‚¹ï¼Œæ˜¯æœ€å¸¸è§çš„æ ‡ç­¾ï¼Œä½† roslaunch å‘½ä»¤ä¸èƒ½ä¿è¯æŒ‰ç…§ node çš„å£°æ˜é¡ºåºæ¥å¯åŠ¨èŠ‚ç‚¹(èŠ‚ç‚¹çš„å¯åŠ¨æ˜¯å¤šè¿›ç¨‹çš„)</p>
<ul>
<li><p>pkg=â€åŒ…åâ€</p>
<p>èŠ‚ç‚¹æ‰€å±çš„åŠŸèƒ½åŒ…</p>
</li>
<li><p>type=â€nodeTypeâ€  </p>
<p>èŠ‚ç‚¹ç±»å‹ï¼Œå³ä¸ä¹‹ç›¸åŒåç§°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œpythonæ–‡ä»¶éœ€è¦å¸¦ä¸Š<code>.py</code>ï¼Œcppæ–‡ä»¶ä¸éœ€è¦ï¼Œç±»ä¼¼CMakeListé…ç½®</p>
</li>
<li><p>name=â€nodeNameâ€</p>
<p>èŠ‚ç‚¹åç§°ï¼Œåœ¨ ROS ç½‘ç»œæ‹“æ‰‘ä¸­èŠ‚ç‚¹çš„åç§°</p>
</li>
<li><p>machine=â€æœºå™¨åâ€</p>
<p>åœ¨æŒ‡å®šæœºå™¨ä¸Šå¯åŠ¨èŠ‚ç‚¹</p>
</li>
<li><p>respawn=â€true | falseâ€ (å¯é€‰)</p>
<p>å¦‚æœèŠ‚ç‚¹é€€å‡ºï¼Œæ˜¯å¦è‡ªåŠ¨é‡å¯</p>
</li>
<li><p>respawn_delay=â€ Nâ€ (å¯é€‰)</p>
<p>å¦‚æœ respawn ä¸º trueï¼Œé‚£ä¹ˆå»¶è¿Ÿ N ç§’åå¯åŠ¨èŠ‚ç‚¹</p>
</li>
<li><p>required=â€true | falseâ€ (å¯é€‰)</p>
<p>å¦‚æœä¸º trueï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹é€€å‡ºï¼Œå°†æ€æ­»æ•´ä¸ª roslaunchï¼Œä¸èƒ½å’Œrespawnä¸€èµ·ç”¨ï¼Œä¼šæŠ¥é”™</p>
</li>
<li><p>ns=â€xxxâ€ (å¯é€‰)</p>
<p>åœ¨æŒ‡å®šå‘½åç©ºé—´ xxx ä¸­å¯åŠ¨èŠ‚ç‚¹ ï¼Œä¸»è¦ç”¨æ¥é¿å…é‡å</p>
<p>node list -&gt;  /å‘½åç©ºé—´/name </p>
</li>
<li><p>output=â€log | screenâ€ (å¯é€‰)</p>
<p>é»˜è®¤logï¼Œä½†ä¸€èˆ¬æ”¹æˆscreen</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;node pkg="turtlesim" type="turtlesim_node" name="myTurtle" output="screen"/&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>includeæ ‡ç­¾</strong></p>
<p>ç”¨äºå°†å¦ä¸€ä¸ª xml æ ¼å¼çš„ launch æ–‡ä»¶å¯¼å…¥åˆ°å½“å‰æ–‡ä»¶</p>
<p>file=â€$(find åŒ…å)/xxx/xxx.launchâ€</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- åŒ…å« --&gt;</span><br><span class="line">    &lt;include file = "$(find launch01_basic)/launch/start_turtle.launch"/&gt;</span><br><span class="line">    &lt;!-- å…¶ä»–èŠ‚ç‚¹ --&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>ç”¨äºå¤ç”¨</p>
<p><strong>remapæ ‡ç­¾</strong></p>
<p>ç”¨äºè¯é¢˜é‡å‘½å</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;node pkg="turtlesim" type="turtlesim_node"  name="myTurtle" output="screen"&gt;</span><br><span class="line">    &lt;remap from="/turtle1/cmd_vel" to = "/cmd_vel" /&gt;</span><br><span class="line">&lt;/node&gt;</span><br><span class="line">&lt;!-- åœ¨launchä¸­çš„è¯­æ³•æ˜¯æ¯ä¸ªæ ‡ç­¾ç»“æŸåæ‰æ ‡æ–œæ ï¼Œæ²¡ç»“æŸè¿˜æœ‰å­æ ‡ç­¾çš„è¯å°±ä¸æ ‡ --&gt;</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>from = â€œåŸå§‹è¯é¢˜åç§°â€ to = â€œç›®æ ‡è¯é¢˜åç§°â€</p>
<p>æ­¤æ—¶åŸæ¥çš„æ§åˆ¶å¤±æ•ˆï¼Œå› ä¸ºturtle_teleop_key æ˜¯ä»¥/turtle1/cmd_vel å‘å¸ƒ</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;node pkg="turtlesim" type="turtle_teleop_key"  name="myTurtleContro" output="screen" /&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™é‡Œéœ€è¦ä¸‹è½½ä¸€ä¸ªæ§åˆ¶åŒ…</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-noetic-teleop-twist-keyboard</span><br></pre></td></tr></tbody></table></figure>

<p><strong>paramæ ‡ç­¾</strong></p>
<p><code>&lt;param&gt;</code>æ ‡ç­¾ä¸»è¦ç”¨äºåœ¨å‚æ•°æœåŠ¡å™¨ä¸Šè®¾ç½®å‚æ•°</p>
<p>åœ¨<code>&lt;node&gt;</code>æ ‡ç­¾ä¸­æ—¶ï¼Œç›¸å½“äºç§æœ‰å‚æ•°</p>
<p>åœ¨<code>&lt;node&gt;</code>æ ‡ç­¾å¤–æ—¶ï¼Œç›¸å½“äºå…¨å±€å‚æ•°</p>
<ul>
<li><p>name=â€[å‘½åç©ºé—´]/å‚æ•°åâ€</p>
<p>å‚æ•°åç§°ï¼Œå¯ä»¥åŒ…å«å‘½åç©ºé—´</p>
</li>
<li><p>value=â€xxxâ€ (å¯é€‰)</p>
<p>å®šä¹‰å‚æ•°å€¼ï¼Œå¦‚æœæ­¤å¤„çœç•¥ï¼Œå¿…é¡»æŒ‡å®šå¤–éƒ¨æ–‡ä»¶ä½œä¸ºå‚æ•°æº</p>
</li>
<li><p>type=â€str | int | double | bool | yamlâ€ (å¯é€‰)</p>
<p>æŒ‡å®šå‚æ•°ç±»å‹ï¼Œå¦‚æœæœªæŒ‡å®šï¼Œroslaunch ä¼šå°è¯•ç¡®å®šå‚æ•°ç±»å‹ï¼Œè§„åˆ™å¦‚ä¸‹:</p>
<ul>
<li>å¦‚æœåŒ…å« â€˜.â€™ çš„æ•°å­—è§£ææœªæµ®ç‚¹å‹ï¼Œå¦åˆ™ä¸ºæ•´å‹</li>
<li>â€œtrueâ€ å’Œ â€œfalseâ€ æ˜¯ bool å€¼(ä¸åŒºåˆ†å¤§å°å†™)</li>
<li>å…¶ä»–æ˜¯å­—ç¬¦ä¸²</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;param name="param_A" type = "int" value ="100" /&gt;</span><br><span class="line">&lt;node pkg="turtlesim" type="turtlesim_node" name="myTurtle" output="screen"&gt;</span><br><span class="line">    &lt;remap from="/turtle1/cmd_vel" to = "/cmd_vel" /&gt;</span><br><span class="line">    &lt;param name="param_B" type = "double" value ="3.14" /&gt;</span><br><span class="line">&lt;/node&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>rosparamæ ‡ç­¾</strong></p>
<p><code>&lt;rosparam&gt;</code>æ ‡ç­¾å¯ä»¥ä» YAML æ–‡ä»¶å¯¼å…¥å‚æ•°ï¼Œæˆ–å°†å‚æ•°å¯¼å‡ºåˆ° YAML æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥åˆ é™¤å‚æ•°</p>
<ul>
<li>command=â€load | dump | deleteâ€ (å¯é€‰ï¼Œé»˜è®¤ load)</li>
<li>file=â€$(find åŠŸèƒ½åŒ…)/xxx/yyyâ€¦.â€</li>
<li>param=â€å‚æ•°åç§°â€</li>
<li>ns=â€å‘½åç©ºé—´â€ (å¯é€‰)</li>
</ul>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- å¯¼å…¥å‚æ•° --&gt;</span><br><span class="line">&lt;rosparam command = "load" file = "$(find launch01_basic)/launch/param.yaml"/&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>ç”±äºlaunchæ–‡ä»¶ä¹Ÿä¸æ˜¯æŒ‰é¡ºåºè¿›è¡Œï¼Œå¯¼å‡ºè™½ç„¶å†™åœ¨launchæ–‡ä»¶è¾ƒåçš„ä½ç½®ä¹Ÿå¯èƒ½æ— æ³•æ­£å¸¸å¯¼å‡ºï¼Œæ‰€ä»¥æœ€å¥½åˆ†ä¸¤ä¸ªlaunchæ–‡ä»¶ï¼Œåœ¨å®Œæˆåå†è¿›è¡Œå¯¼å‡º</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;!-- å¯¼å‡ºå‚æ•° --&gt;</span><br><span class="line">    &lt;rosparam command = "dump" file = "$(find launch01_basic)/launch/param_out.yaml"/&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>åˆ é™¤æ“ä½œï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;rosparam command = "delete" param = "bg_B" /&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>groupæ ‡ç­¾</strong></p>
<p><code>&lt;group&gt;</code>æ ‡ç­¾å¯ä»¥å¯¹èŠ‚ç‚¹åˆ†ç»„ï¼Œå…·æœ‰ ns å±æ€§ï¼Œå¯ä»¥è®©èŠ‚ç‚¹å½’å±æŸä¸ªå‘½åç©ºé—´</p>
<ul>
<li><p>clear_params=â€true | falseâ€ (å¯é€‰)</p>
<p>å¯åŠ¨å‰ï¼Œæ˜¯å¦åˆ é™¤ç»„åç§°ç©ºé—´çš„æ‰€æœ‰å‚æ•°(æ…ç”¨â€¦.æ­¤åŠŸèƒ½å±é™©)</p>
</li>
</ul>
<p>è¿™ä¸ªæ—¶å€™å³ä½¿åœ¨nodeä¸­nameå±æ€§ç›¸åŒä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºgroupä½¿å¾—å‰é¢åŠ ä¸Šå‰ç¼€ï¼Œä¸ä¼šäº§ç”Ÿç›¸åŒçš„èŠ‚ç‚¹åç§°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch &gt;</span><br><span class="line">    &lt;group ns = "first"&gt;</span><br><span class="line">        &lt;node pkg="turtlesim" type="turtlesim_node" name="myTurtle" output="screen" /&gt;</span><br><span class="line">        &lt;node pkg="turtlesim" type="turtle_teleop_key"  name="myTurtleContro" output="screen" /&gt;</span><br><span class="line">    &lt;/group&gt; </span><br><span class="line">    &lt;group ns = "second"&gt;</span><br><span class="line">        &lt;node pkg="turtlesim" type="turtlesim_node" name="myTurtle" output="screen" /&gt;</span><br><span class="line">        &lt;node pkg="turtlesim" type="turtle_teleop_key"  name="myTurtleContro" output="screen" /&gt;</span><br><span class="line">    &lt;/group&gt; </span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p><strong>argæ ‡ç­¾</strong></p>
<p><code>&lt;arg&gt;</code>æ ‡ç­¾æ˜¯ç”¨äºåŠ¨æ€ä¼ å‚ï¼Œç±»ä¼¼äºå‡½æ•°çš„å‚æ•°</p>
<ul>
<li><p>name=â€å‚æ•°åç§°â€</p>
</li>
<li><p>default=â€é»˜è®¤å€¼â€ (å¯é€‰)</p>
</li>
<li><p>value=â€æ•°å€¼â€ (å¯é€‰)</p>
<p>ä¸å¯ä»¥ä¸ default å¹¶å­˜</p>
</li>
<li><p>doc=â€æè¿°â€</p>
</li>
</ul>
<p>å‘½ä»¤è¡Œè°ƒç”¨ä¼ å‚</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roslaunch hello.launch xxx:=å€¼</span><br></pre></td></tr></tbody></table></figure>

<h3 id="å·¥ä½œç©ºé—´è¦†ç›–"><a href="#å·¥ä½œç©ºé—´è¦†ç›–" class="headerlink" title="å·¥ä½œç©ºé—´è¦†ç›–"></a>å·¥ä½œç©ºé—´è¦†ç›–</h3><p>æ‰€è°“å·¥ä½œç©ºé—´è¦†ç›–ï¼Œæ˜¯æŒ‡ä¸åŒå·¥ä½œç©ºé—´ä¸­ï¼Œå­˜åœ¨é‡åçš„åŠŸèƒ½åŒ…çš„æƒ…å½¢</p>
<p>æ¯”å¦‚ï¼šè‡ªå®šä¹‰å·¥ä½œç©ºé—´Aå­˜åœ¨åŠŸèƒ½åŒ… turtlesimï¼Œè‡ªå®šä¹‰å·¥ä½œç©ºé—´Bä¹Ÿå­˜åœ¨åŠŸèƒ½åŒ… turtlesimï¼Œå½“ç„¶ç³»ç»Ÿå†…ç½®ç©ºé—´ä¹Ÿå­˜åœ¨turtlesimï¼Œå¦‚æœè°ƒç”¨turtlesimåŒ…ï¼Œä¼šè°ƒç”¨å“ªä¸ªå·¥ä½œç©ºé—´ä¸­çš„å‘¢</p>
<ol>
<li><p>æ–°å»ºå·¥ä½œç©ºé—´Aä¸å·¥ä½œç©ºé—´Bï¼Œä¸¤ä¸ªå·¥ä½œç©ºé—´ä¸­éƒ½åˆ›å»ºåŠŸèƒ½åŒ…: turtlesim</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include "ros/ros.h"</span><br><span class="line"></span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">    ros::init(argc,argv,"hello_ws1");</span><br><span class="line">    ROS_INFO("demo01_ws");</span><br><span class="line">    return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>ä¸ºäº†åœ¨ä»»ä½•å·¥ä½œç©ºé—´ä¸‹è°ƒç”¨demo01_wså’Œdemo02_wsï¼Œéœ€è¦åœ¨æ ¹ç›®å½•ä¸‹çš„.bashrcæ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">source /opt/ros/noetic/setup.bash</span><br><span class="line"># æ–°å¢</span><br><span class="line">source /home/ros/demo01_ws/devel/setup.bash</span><br><span class="line">source /home/ros/demo02_ws/devel/setup.bash</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>åˆ·æ–°ç¯å¢ƒå˜é‡</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source .bashrc</span><br></pre></td></tr></tbody></table></figure>

<p>è¿è¡Œ</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim [TAB]</span><br></pre></td></tr></tbody></table></figure>

<p>ä¼šå‘ç°ç›´æ¥è·³å‡ºhello_ws2 </p>
<p>æ˜¯å› ä¸ºåœ¨.bashrcä¸­ååˆ·æ–°çš„ä¼šè¦†ç›–å‰é¢çš„</p>
</li>
<li><p>æŸ¥çœ‹ROSç¯å¢ƒç¯å¢ƒå˜é‡</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $ROS_PACKAGE_PATH</span><br></pre></td></tr></tbody></table></figure>

<p>ROS_PACKAGE_PATH ä¸­çš„å€¼ï¼Œå’Œ .bashrc çš„é…ç½®é¡ºåºç›¸åâ€”&gt;åé…ç½®çš„ä¼˜å…ˆçº§æ›´é«˜</p>
</li>
</ol>
<p>åŠŸèƒ½åŒ…é‡åæ—¶ï¼Œä¼šæŒ‰ç…§ ROS_PACKAGE_PATH æŸ¥æ‰¾ï¼Œé…ç½®åœ¨å‰çš„ä¼šä¼˜å…ˆæ‰§è¡Œ</p>
<p><strong>éšæ‚£</strong></p>
<p>æ¯”å¦‚å½“å‰å·¥ä½œç©ºé—´Bä¼˜å…ˆçº§æ›´é«˜ï¼Œæ„å‘³ç€å½“ç¨‹åºè°ƒç”¨ turtlesim æ—¶ï¼Œä¸ä¼šè°ƒç”¨å·¥ä½œç©ºé—´Aä¹Ÿä¸ä¼šè°ƒç”¨ç³»ç»Ÿå†…ç½®çš„ turtlesimï¼Œå¦‚æœå·¥ä½œç©ºé—´Aåœ¨å®ç°æ—¶æœ‰å…¶ä»–åŠŸèƒ½åŒ…ä¾èµ–äºè‡ªèº«çš„ turtlesimï¼Œè€ŒæŒ‰ç…§ROSå·¥ä½œç©ºé—´è¦†ç›–çš„æ¶‰åŠåŸåˆ™ï¼Œé‚£ä¹ˆå®é™…æ‰§è¡Œæ—¶å°†ä¼šè°ƒç”¨å·¥ä½œç©ºé—´Bçš„turtlesimï¼Œä»è€Œå¯¼è‡´æ‰§è¡Œå¼‚å¸¸ï¼Œå‡ºç°å®‰å…¨éšæ‚£</p>
<p>BUG è¯´æ˜:</p>
<blockquote>
<p>åœ¨ .bashrc æ–‡ä»¶ä¸­ source å¤šä¸ªå·¥ä½œç©ºé—´åï¼Œå¯èƒ½å‡ºç°åœ¨ ROS PACKAGE PATH ä¸­åªåŒ…å«ä¸¤ä¸ªå·¥ä½œç©ºé—´ï¼Œå¯ä»¥åˆ é™¤è‡ªå®šä¹‰å·¥ä½œç©ºé—´çš„ build ä¸ devel ç›®å½•ï¼Œé‡æ–° catkin_makeï¼Œç„¶åé‡æ–°è½½å…¥ .bashrc æ–‡ä»¶ï¼Œé—®é¢˜è§£å†³</p>
</blockquote>
<p>ç›®å‰æ²¡æœ‰ç‰¹åˆ«çš„è§£å†³æ–¹æ¡ˆ</p>
<h3 id="èŠ‚ç‚¹åç§°é‡å"><a href="#èŠ‚ç‚¹åç§°é‡å" class="headerlink" title="èŠ‚ç‚¹åç§°é‡å"></a>èŠ‚ç‚¹åç§°é‡å</h3><p>ros::init(argc,argv,â€â€)   rospy.init_node(â€œâ€)  å®šä¹‰èŠ‚ç‚¹åç§°</p>
<p>åœ¨ROSçš„ç½‘ç»œæ‹“æ‰‘ä¸­ï¼Œæ˜¯ä¸å¯ä»¥å‡ºç°é‡åçš„èŠ‚ç‚¹çš„ï¼Œä¹Ÿä¸å¯ä»¥å¯åŠ¨é‡åèŠ‚ç‚¹æˆ–è€…åŒä¸€ä¸ªèŠ‚ç‚¹å¤šæ¬¡</p>
<p>åœ¨ROSä¸­ç»™å‡ºçš„è§£å†³ç­–ç•¥æ˜¯ä½¿ç”¨å‘½åç©ºé—´æˆ–åç§°é‡æ˜ å°„</p>
<p>å‘½åç©ºé—´å°±æ˜¯ä¸ºåç§°æ·»åŠ å‰ç¼€ï¼Œåç§°é‡æ˜ å°„æ˜¯ä¸ºåç§°èµ·åˆ«å</p>
<h4 id="rosrunå®ç°"><a href="#rosrunå®ç°" class="headerlink" title="rosrunå®ç°"></a>rosrunå®ç°</h4><p><strong>rosrunè®¾ç½®å‘½åç©ºé—´</strong></p>
<p>è¯­æ³•: rosrun åŒ…å èŠ‚ç‚¹å __ns:=æ–°åç§°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node __ns:=t1</span><br><span class="line">rosrun turtlesim turtlesim_node __ns:=t2</span><br><span class="line"># æ³¨æ„ï¼Œè¿™é‡Œ=åé¢ä¸å¯ä»¥æœ‰ç©ºæ ¼</span><br></pre></td></tr></tbody></table></figure>

<p>rosnode list </p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/t1/turtlesim</span><br><span class="line">/t2/turtlesim</span><br></pre></td></tr></tbody></table></figure>

<p><strong>rosrunåç§°é‡æ˜ å°„</strong></p>
<p>è¯­æ³•: rosrun åŒ…å èŠ‚ç‚¹å __name:=æ–°åç§°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim  turtlesim_node __name:=t1</span><br><span class="line">rosrun turtlesim  turtlesim_node __name:=t2</span><br></pre></td></tr></tbody></table></figure>

<p><strong>è®¾ç½®å‘½åç©ºé—´åŒæ—¶åç§°é‡æ˜ å°„</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node __ns:=w1 __name:=t1</span><br></pre></td></tr></tbody></table></figure>

<p>ä½¿ç”¨ç¯å¢ƒå˜é‡ä¹Ÿå¯ä»¥è®¾ç½®å‘½åç©ºé—´ï¼Œå¯åŠ¨èŠ‚ç‚¹å‰åœ¨ç»ˆç«¯é”®å…¥å¦‚ä¸‹å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export ROS_NAMESPACE=sw1</span><br><span class="line">rosrun turtlesim turtlesim_node</span><br></pre></td></tr></tbody></table></figure>

<h4 id="launchå®ç°"><a href="#launchå®ç°" class="headerlink" title="launchå®ç°"></a>launchå®ç°</h4><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch &gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="turtlesim" output="screen"/&gt;</span><br><span class="line">    &lt;!-- åç§°é‡æ˜ å°„ --&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="t1" output="screen"/&gt;</span><br><span class="line">    &lt;!-- å‘½åç©ºé—´ --&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="turtlesim" output="screen" ns="p1" /&gt;</span><br><span class="line">    &lt;!-- å‘½åç©ºé—´ + ç§°é‡æ˜ å°„ --&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="t2" output="screen" ns="p2" /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨ node æ ‡ç­¾ä¸­ï¼Œname å±æ€§æ˜¯å¿…é¡»çš„ï¼Œns å¯é€‰</p>
<p><code>rosnode list</code>æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/p1/turtlesim</span><br><span class="line">/p2/t2</span><br><span class="line">/rosout</span><br><span class="line">/t1</span><br><span class="line">/turtlesim</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ç¼–ç å®ç°"><a href="#ç¼–ç å®ç°" class="headerlink" title="ç¼–ç å®ç°"></a>ç¼–ç å®ç°</h4><p><strong>c++</strong></p>
<p>é‡æ˜ å°„ï¼š(è®¾ç½®åˆ«å)</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros::init(argc,argv,"name",ros::init_options::AnonymousName)ï¼›</span><br></pre></td></tr></tbody></table></figure>

<p>åœ¨åç§°åé¢æ·»åŠ æ—¶é—´æˆ³</p>
<p>å‘½åç©ºé—´ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">std::map&lt;std::string, std::string&gt; map;</span><br><span class="line">map["__ns"] = "name";</span><br><span class="line">ros::init(map,"");</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<p>é‡æ˜ å°„ï¼š(è®¾ç½®åˆ«å)</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rospy.init_node("name",anonymous=True)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="è¯é¢˜åç§°é‡å"><a href="#è¯é¢˜åç§°é‡å" class="headerlink" title="è¯é¢˜åç§°é‡å"></a>è¯é¢˜åç§°é‡å</h3><h4 id="rosrunå®ç°-1"><a href="#rosrunå®ç°-1" class="headerlink" title="rosrunå®ç°"></a>rosrunå®ç°</h4><p>è¯­æ³•: rorun åŒ…å èŠ‚ç‚¹å è¯é¢˜å:=æ–°è¯é¢˜åç§°</p>
<p>å®ç°teleop_twist_keyboardä¸ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹é€šä¿¡æ–¹æ¡ˆ</p>
<p>æ–¹æ¡ˆ1ï¼šå°† teleop_twist_keyboard èŠ‚ç‚¹çš„è¯é¢˜è®¾ç½®ä¸º<code>/turtle1/cmd_vel</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun teleop_twist_keyboard teleop_twist_keyboard.py /cmd_vel:=/turtle1/cmd_vel</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™ä¸ªæ—¶å€™<code>rosrun turtlesim turtle_teleop_key</code> ä¹Ÿèƒ½æ­£å¸¸æ§åˆ¶ï¼Œç›¸å½“äºä¸¤ä¸ªå‘å¸ƒ</p>
<p>æ–¹æ¡ˆ2ï¼šå°†ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹çš„è¯é¢˜è®¾ç½®ä¸º <code>/cmd_vel</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node /turtle1/cmd_vel:=/cmd_vel</span><br></pre></td></tr></tbody></table></figure>

<h4 id="launchå®ç°-1"><a href="#launchå®ç°-1" class="headerlink" title="launchå®ç°"></a>launchå®ç°</h4><p>åœ¨ä¹‹å‰launchæ–‡ä»¶æ ‡ç­¾é‚£é‡Œè®²è¿‡ï¼Œè¿™é‡Œå°±ç»™ä¸ªä»£ç </p>
<p>è¯­æ³•<code>&lt;remap from="åŸè¯é¢˜" to="æ–°è¯é¢˜" /&gt;</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="t1" /&gt;</span><br><span class="line">    &lt;node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" name="key"&gt;</span><br><span class="line">        &lt;remap from="/cmd_vel" to="/turtle1/cmd_vel" /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="t1"&gt;</span><br><span class="line">        &lt;remap from="/turtle1/cmd_vel" to="/cmd_vel" /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line">    &lt;node pkg="teleop_twist_keyboard" type="teleop_twist_keyboard.py" name="key" /&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ç¼–ç å®ç°-1"><a href="#ç¼–ç å®ç°-1" class="headerlink" title="ç¼–ç å®ç°"></a>ç¼–ç å®ç°</h4><p>è¯é¢˜çš„åç§°ä¸èŠ‚ç‚¹çš„å‘½åç©ºé—´ã€èŠ‚ç‚¹çš„åç§°æ˜¯æœ‰ä¸€å®šå…³ç³»çš„ï¼Œè¯é¢˜åç§°å¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç§ç±»å‹:</p>
<ul>
<li>å…¨å±€(è¯é¢˜å‚è€ƒROSç³»ç»Ÿï¼Œä¸èŠ‚ç‚¹å‘½åç©ºé—´å¹³çº§)</li>
<li>ç›¸å¯¹(è¯é¢˜å‚è€ƒçš„æ˜¯èŠ‚ç‚¹çš„å‘½åç©ºé—´ï¼Œä¸èŠ‚ç‚¹åç§°å¹³çº§)</li>
<li>ç§æœ‰(è¯é¢˜å‚è€ƒèŠ‚ç‚¹åç§°ï¼Œæ˜¯èŠ‚ç‚¹åç§°çš„å­çº§)</li>
</ul>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/Snipaste_2025-05-30_21-27-59.webp" alt="Snipaste_2025-05-30_21-27-59" style="zoom: 50%;">

<p><strong>c++</strong>ï¼š</p>
<p>å…¨å±€åç§°ï¼šä»¥<code>/</code>å¼€å¤´ï¼Œå’ŒèŠ‚ç‚¹åç§°æ— å…³</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">"/chatter"</span>,<span class="number">1000</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>ç›¸å¯¹åç§°ï¼šé<code>/</code>å¼€å¤´ï¼Œå‚è€ƒå‘½åç©ºé—´(ä¸èŠ‚ç‚¹åç§°å¹³çº§)æ¥ç¡®å®šè¯é¢˜åç§°</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">"chatter"</span>,<span class="number">1000</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>__ns:=è®¾ç½®å‘½åç©ºé—´åï¼Œåˆ™è¯é¢˜ä½äº /name/chatter</p>
<p>ç§æœ‰åç§°ï¼šä»¥<code>~</code>å¼€å¤´çš„åç§°</p>
<p>éœ€è¦åœ¨èŠ‚ç‚¹handleåˆ›å»ºæ—¶å€™åšå‡ºäº›æ”¹å˜</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ros::NodeHandle <span class="title">nh</span><span class="params">(<span class="string">"~"</span>)</span></span>;</span><br><span class="line">ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">"chatter"</span>,<span class="number">1000</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>ä½†å¦‚æœè¯é¢˜ä»¥<code>/</code>å¼€å¤´åˆ™è¯é¢˜ä»ä¸ºå…¨å±€(å…¨å±€è¯é¢˜ä¼˜å…ˆçº§æ›´é«˜)</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ros::NodeHandle <span class="title">nh</span><span class="params">(<span class="string">"~"</span>)</span></span>;</span><br><span class="line">ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;std_msgs::String&gt;(<span class="string">"/chatter"</span>,<span class="number">1000</span>);</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong>ï¼š</p>
<p>å…¨å±€åç§°ï¼šä»¥<code>/</code>å¼€å¤´ï¼Œå’ŒèŠ‚ç‚¹åç§°æ— å…³</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pub = rospy.Publisher(<span class="string">"/chatter"</span>,String,queue_size=<span class="number">1000</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>ç›¸å¯¹åç§°ï¼šé<code>/</code>å¼€å¤´ï¼Œå‚è€ƒå‘½åç©ºé—´(ä¸èŠ‚ç‚¹åç§°å¹³çº§)æ¥ç¡®å®šè¯é¢˜åç§°</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pub = rospy.Publisher(<span class="string">"chatter"</span>,String,queue_size=<span class="number">1000</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>ç§æœ‰åç§°ï¼šä»¥<code>~</code>å¼€å¤´çš„åç§°</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pub = rospy.Publisher(<span class="string">"~chatter"</span>,String,queue_size=<span class="number">1000</span>)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="å‚æ•°åç§°é‡å"><a href="#å‚æ•°åç§°é‡å" class="headerlink" title="å‚æ•°åç§°é‡å"></a>å‚æ•°åç§°é‡å</h3><p>åœ¨ROSä¸­èŠ‚ç‚¹åç§°è¯é¢˜åç§°å¯èƒ½å‡ºç°é‡åçš„æƒ…å†µï¼ŒåŒç†å‚æ•°åç§°ä¹Ÿå¯èƒ½é‡å</p>
<p>å½“å‚æ•°åç§°é‡åæ—¶ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿè¦†ç›–</p>
<p>å…³äºå‚æ•°é‡åçš„å¤„ç†ï¼Œæ²¡æœ‰é‡æ˜ å°„å®ç°ï¼Œä¸ºäº†å°½é‡çš„é¿å…å‚æ•°é‡åï¼Œéƒ½æ˜¯ä½¿ç”¨ä¸ºå‚æ•°åæ·»åŠ å‰ç¼€çš„æ–¹å¼ï¼Œå®ç°ç±»ä¼¼äºè¯é¢˜åç§°ï¼Œæœ‰å…¨å±€ã€ç›¸å¯¹ã€å’Œç§æœ‰ä¸‰ç§ç±»å‹ä¹‹åˆ†</p>
<h4 id="rosrunå®ç°-2"><a href="#rosrunå®ç°-2" class="headerlink" title="rosrunå®ç°"></a>rosrunå®ç°</h4><p>è¯­æ³•ï¼šrosrun åŒ…å èŠ‚ç‚¹åç§° _å‚æ•°å:=å‚æ•°å€¼</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun turtlesim turtlesim_node _A:=100</span><br></pre></td></tr></tbody></table></figure>

<p>rosparam list æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/turtlesim/A</span><br></pre></td></tr></tbody></table></figure>

<p>è¿™ç§æ–¹æ³•åˆ›å»ºå‡ºæ¥çš„å‚æ•°ä¸ºç§æœ‰æ¨¡å¼</p>
<h4 id="launchå®ç°-2"><a href="#launchå®ç°-2" class="headerlink" title="launchå®ç°"></a>launchå®ç°</h4><p>åœ¨launchæ–‡ä»¶é‚£éƒ¨åˆ†ç»†è®²è¿‡äº†ï¼Œä¸å†èµ˜è¿°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;param name="radius" value="0.2" /&gt;</span><br><span class="line">    &lt;node pkg="turtlesim" type="turtlesim_node" name="t1" ns="xxx"&gt;</span><br><span class="line">        &lt;param name="radius" value="0.08" /&gt;</span><br><span class="line">    &lt;/node&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ç¼–ç å®ç°-2"><a href="#ç¼–ç å®ç°-2" class="headerlink" title="ç¼–ç å®ç°"></a>ç¼–ç å®ç°</h4><p><strong>c++</strong></p>
<p>ä½¿ç”¨ ros::param æˆ–è€… ros::NodeHandle æ¥è®¾ç½®å‚æ•°</p>
<p>å…·ä½“å†…å®¹æŸ¥çœ‹ - ROSé€šä¿¡æœºåˆ¶ -&gt; å‚æ•°æœåŠ¡å™¨</p>
<p>ros::param::setï¼Œå‚æ•°1ä¼ å…¥å‚æ•°åç§°ï¼Œå‚æ•°2ä¼ å…¥å‚æ•°å€¼</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ros::param::<span class="built_in">set</span>(<span class="string">"/set_A"</span>,<span class="number">100</span>); <span class="comment">//å…¨å±€,å’Œå‘½åç©ºé—´ä»¥åŠèŠ‚ç‚¹åç§°æ— å…³</span></span><br><span class="line">ros::param::<span class="built_in">set</span>(<span class="string">"set_B"</span>,<span class="number">100</span>); <span class="comment">//ç›¸å¯¹,å‚è€ƒå‘½åç©ºé—´</span></span><br><span class="line">ros::param::<span class="built_in">set</span>(<span class="string">"~set_C"</span>,<span class="number">100</span>); <span class="comment">//ç§æœ‰,å‚è€ƒå‘½åç©ºé—´ä¸èŠ‚ç‚¹åç§°</span></span><br></pre></td></tr></tbody></table></figure>

<p>ros::NodeHandleï¼Œé¦–å…ˆéœ€è¦åˆ›å»º NodeHandle å¯¹è±¡ï¼Œç„¶åè°ƒç”¨è¯¥å¯¹è±¡çš„ setParam å‡½æ•°ï¼Œè¯¥å‡½æ•°å‚æ•°1ä¸ºå‚æ•°åï¼Œå‚æ•°2ä¸ºè¦è®¾ç½®çš„å‚æ•°å€¼</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ros::NodeHandle nh;</span><br><span class="line">nh.<span class="built_in">setParam</span>(<span class="string">"/nh_A"</span>,<span class="number">100</span>); <span class="comment">//å…¨å±€,å’Œå‘½åç©ºé—´ä»¥åŠèŠ‚ç‚¹åç§°æ— å…³</span></span><br><span class="line"></span><br><span class="line">nh.<span class="built_in">setParam</span>(<span class="string">"nh_B"</span>,<span class="number">100</span>); <span class="comment">//ç›¸å¯¹,å‚è€ƒå‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line"><span class="function">ros::NodeHandle <span class="title">nh_private</span><span class="params">(<span class="string">"~"</span>)</span></span>;</span><br><span class="line">nh_private.<span class="built_in">setParam</span>(<span class="string">"nh_C"</span>,<span class="number">100</span>);<span class="comment">//ç§æœ‰,å‚è€ƒå‘½åç©ºé—´ä¸èŠ‚ç‚¹åç§°</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rospy.set_param(<span class="string">"/py_A"</span>,<span class="number">100</span>)  <span class="comment">#å…¨å±€,å’Œå‘½åç©ºé—´ä»¥åŠèŠ‚ç‚¹åç§°æ— å…³</span></span><br><span class="line">rospy.set_param(<span class="string">"py_B"</span>,<span class="number">100</span>)  <span class="comment">#ç›¸å¯¹,å‚è€ƒå‘½åç©ºé—´</span></span><br><span class="line">rospy.set_param(<span class="string">"~py_C"</span>,<span class="number">100</span>)  <span class="comment">#ç§æœ‰,å‚è€ƒå‘½åç©ºé—´ä¸èŠ‚ç‚¹åç§°</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="åˆ†å¸ƒå¼é€šä¿¡"><a href="#åˆ†å¸ƒå¼é€šä¿¡" class="headerlink" title="åˆ†å¸ƒå¼é€šä¿¡"></a>åˆ†å¸ƒå¼é€šä¿¡</h3><p>ROSæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—ç¯å¢ƒï¼Œä¸€ä¸ªè¿è¡Œä¸­çš„ROSç³»ç»Ÿå¯ä»¥åŒ…å«åˆ†å¸ƒåœ¨å¤šå°è®¡ç®—æœºä¸Šå¤šä¸ªèŠ‚ç‚¹</p>
<p>ROSå¯¹ç½‘ç»œé…ç½®æœ‰æŸäº›è¦æ±‚ï¼š</p>
<ul>
<li>æ‰€æœ‰ç«¯å£ä¸Šçš„æ‰€æœ‰æœºå™¨ä¹‹é—´å¿…é¡»æœ‰å®Œæ•´çš„åŒå‘è¿æ¥</li>
<li>æ¯å°è®¡ç®—æœºå¿…é¡»é€šè¿‡æ‰€æœ‰å…¶ä»–è®¡ç®—æœºéƒ½å¯ä»¥è§£æçš„åç§°æ¥å…¬å‘Šè‡ªå·±</li>
</ul>
<p><strong>å®ç°</strong></p>
<ol>
<li><p>å‡†å¤‡</p>
<p>å…ˆè¦ä¿è¯ä¸åŒè®¡ç®—æœºå¤„äºåŒä¸€ç½‘ç»œä¸­ï¼Œæœ€å¥½åˆ†åˆ«è®¾ç½®å›ºå®šIPï¼Œå¦‚æœä¸ºè™šæ‹Ÿæœºï¼Œéœ€è¦å°†ç½‘ç»œé€‚é…å™¨æ”¹ä¸ºæ¡¥æ¥æ¨¡å¼</p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/Snipaste_2025-05-31_13-04-06.webp" alt="Snipaste_2025-05-31_13-04-06" style="zoom: 67%;">

<p>ä¿®æ”¹æœ‰çº¿è¿æ¥çš„IPv4</p>
<p>ä¸‹è½½åŒ… </p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install net-tools</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifconfig</span><br></pre></td></tr></tbody></table></figure>

<p>æŸ¥çœ‹ç½‘ç»œä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ros-VirtualBox (ROS1)</span><br><span class="line">inet 10.129.163.127 # ipåœ°å€</span><br><span class="line">netmask 255.255.248.0 # å­ç½‘æ©ç </span><br><span class="line"># ROS2</span><br><span class="line">inet 10.129.164.127 # ipåœ°å€</span><br><span class="line">netmask 255.255.248.0 # å­ç½‘æ©ç </span><br></pre></td></tr></tbody></table></figure>

<p>ç½‘å…³å’Œåœ°å€ä¸€æ ·ï¼Œä½†æ˜¯æœ€åä¸€ç»„æ•°åªç•™1</p>
</li>
<li><p>é…ç½®æ–‡ä»¶ä¿®æ”¹</p>
<p>åˆ†åˆ«ä¿®æ”¹ä¸åŒè®¡ç®—æœºçš„ /etc/hosts æ–‡ä»¶ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­åŠ å…¥å¯¹æ–¹çš„IPåœ°å€å’Œè®¡ç®—æœºå</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc</span><br><span class="line">sudo gedit hosts</span><br></pre></td></tr></tbody></table></figure>

<p>å¯ä»¥é€šè¿‡hostnameæŸ¥çœ‹è®¡ç®—æœºå</p>
<p>è®¾ç½®å®Œæ¯•ï¼Œå¯ä»¥é€šè¿‡ ping å‘½ä»¤æµ‹è¯•ç½‘ç»œé€šä¿¡æ˜¯å¦æ­£å¸¸</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ping 10.129.164.127 #åœ°å€ </span><br><span class="line">ping ROS2 #è®¡ç®—æœºå</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>é…ç½®ä¸»æœº</p>
<p>~/.bashrc è¿½åŠ </p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># export ROS_MASTER_URI=http://ä¸»æœºIP:11311</span><br><span class="line"># export ROS_HOSTNAME=ä¸»æœºIP</span><br><span class="line"></span><br><span class="line">export ROS_MASTER_URI=http://10.129.163.127:11311</span><br><span class="line">export ROS_HOSTNAME=10.129.163.127</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>é…ç½®ä»æœº</p>
<p>ä»æœºå¯ä»¥æœ‰å¤šå°ï¼Œæ¯å°éƒ½åšè®¾ç½®ï¼Œ~/.bashrc è¿½åŠ </p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># export ROS_MASTER_URI=http://ä¸»æœºIP:11311</span><br><span class="line"># export ROS_HOSTNAME=ä»æœºIP</span><br><span class="line"></span><br><span class="line">export ROS_MASTER_URI=http://10.129.163.127:11311</span><br><span class="line">export ROS_HOSTNAME=10.129.164.127</span><br></pre></td></tr></tbody></table></figure>

<p>source .bashrc  åˆ·æ–°ç¯å¢ƒå˜é‡</p>
</li>
</ol>
<p><strong>æµ‹è¯•</strong></p>
<ol>
<li><p>ä¸»æœºå¯åŠ¨ roscore(å¿…é¡»)</p>
</li>
<li><p>ä¸»æœºå¯åŠ¨è®¢é˜…èŠ‚ç‚¹ï¼Œä»æœºå¯åŠ¨å‘å¸ƒèŠ‚ç‚¹ï¼Œæµ‹è¯•é€šä¿¡æ˜¯å¦æ­£å¸¸</p>
</li>
<li><p>åå‘æµ‹è¯•ï¼Œä¸»æœºå¯åŠ¨å‘å¸ƒèŠ‚ç‚¹ï¼Œä»æœºå¯åŠ¨è®¢é˜…èŠ‚ç‚¹ï¼Œæµ‹è¯•é€šä¿¡æ˜¯å¦æ­£å¸¸</p>
</li>
</ol>
<h2 id="ROSå¸¸ç”¨ç»„ä»¶"><a href="#ROSå¸¸ç”¨ç»„ä»¶" class="headerlink" title="ROSå¸¸ç”¨ç»„ä»¶"></a>ROSå¸¸ç”¨ç»„ä»¶</h2><p>ç« ä¸»è¦ä»‹ç»ROSä¸­å†…ç½®çš„å¦‚ä¸‹ç»„ä»¶:</p>
<ul>
<li>TFåæ ‡å˜æ¢ï¼Œå®ç°ä¸åŒç±»å‹çš„åæ ‡ç³»ä¹‹é—´çš„è½¬æ¢ï¼›</li>
<li>rosbag ç”¨äºå½•åˆ¶ROSèŠ‚ç‚¹çš„æ‰§è¡Œè¿‡ç¨‹å¹¶å¯ä»¥é‡æ”¾è¯¥è¿‡ç¨‹ï¼›</li>
<li>rqt å·¥å…·ç®±ï¼Œé›†æˆäº†å¤šæ¬¾å›¾å½¢åŒ–çš„è°ƒè¯•å·¥å…·</li>
</ul>
<p>æ¡ˆä¾‹æ¼”ç¤º: å°ä¹Œé¾Ÿè·Ÿéšå®ç°</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">roslaunch turtle_tf2 turtle_tf2_demo_cpp.launch</span><br><span class="line">roslaunch turtle_tf2 turtle_tf2_demo.launch </span><br><span class="line"># å¦‚æœæŠ¥é”™ sudo ln -s /usr/bin/python3 /usr/bin/python</span><br></pre></td></tr></tbody></table></figure>

<h3 id="TFåæ ‡å˜æ¢"><a href="#TFåæ ‡å˜æ¢" class="headerlink" title="TFåæ ‡å˜æ¢"></a>TFåæ ‡å˜æ¢</h3><p>æœºå™¨äººç³»ç»Ÿä¸Šæœ‰å¤šä¸ªä¼ æ„Ÿå™¨ï¼Œå¦‚æ¿€å…‰é›·è¾¾ã€æ‘„åƒå¤´ç­‰ï¼Œæœ‰çš„æ˜¯å¯ä»¥æ„ŸçŸ¥æœºå™¨äººå‘¨è¾¹çš„ç‰©ä½“æ–¹ä½(åæ ‡ï¼Œæ¨ªå‘ã€çºµå‘ã€é«˜åº¦çš„è·ç¦»ä¿¡æ¯)çš„ï¼Œä»¥ååŠ©æœºå™¨äººå®šä½éšœç¢ç‰©</p>
<p>ä½†ä¸å¯ä»¥ç›´æ¥å°†ç‰©ä½“ç›¸å¯¹è¯¥ä¼ æ„Ÿå™¨çš„æ–¹ä½ä¿¡æ¯ï¼Œç­‰ä»·äºç‰©ä½“ç›¸å¯¹äºæœºå™¨äººç³»ç»Ÿæˆ–æœºå™¨äººå…¶å®ƒç»„ä»¶çš„æ–¹ä½ä¿¡æ¯</p>
<p>ROS ä¸­ç›´æ¥å°è£…äº†ç›¸å…³çš„æ¨¡å—: åæ ‡å˜æ¢(TransForm Frameï¼ŒTF)</p>
<p>tf2å¸¸ç”¨åŠŸèƒ½åŒ…æœ‰ï¼š</p>
<ul>
<li><p>tf2_geometry_msgsï¼šå°†ROSæ¶ˆæ¯è½¬æ¢æˆtf2æ¶ˆæ¯</p>
</li>
<li><p>tf2ï¼šå°è£…äº†åæ ‡å˜æ¢çš„å¸¸ç”¨æ¶ˆæ¯</p>
<ul>
<li>æ¬§æ‹‰è§’è½¬å››å…ƒæ•°ï¼štf2/LinearMath/Quaternion.h (pythonï¼štf.transformations)</li>
</ul>
</li>
<li><p>tf2_rosï¼šä¸ºtf2æä¾›äº†roscppå’Œrospyç»‘å®šï¼Œå°è£…äº†åæ ‡å˜æ¢å¸¸ç”¨çš„API(pythonæ¯”è¾ƒç®€æ´ï¼Œç›´æ¥import tf2_roså°±è¡Œ)ï¼Œä¸€èˆ¬åˆ›å»ºç±»å¯¹è±¡</p>
<ul>
<li>é™æ€å˜æ¢å¹¿æ’­å™¨ï¼štf2_ros/static_transform_broadcaster.h</li>
<li>è½¬æ¢å…³ç³»è®¢é˜…å™¨ï¼štf2_ros/transform_listener.h</li>
<li>ç¼“å­˜æ•°æ®ï¼štf2_ros/buffer.h</li>
</ul>
</li>
</ul>
<p>å¯ä»¥å€ŸåŠ©äºrvizæ˜¾ç¤ºåæ ‡ç³»å…³ç³»</p>
<ul>
<li>æ–°å»ºçª—å£è¾“å…¥å‘½ä»¤rviz</li>
<li>åœ¨å¯åŠ¨çš„ rviz ä¸­è®¾ç½®Fixed Frame ä¸º base_link;</li>
<li>ç‚¹å‡»å·¦ä¸‹çš„ add æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹© TF ç»„ä»¶ï¼Œå³å¯æ˜¾ç¤ºåæ ‡å…³ç³»</li>
</ul>
<h4 id="åæ ‡msgæ¶ˆæ¯"><a href="#åæ ‡msgæ¶ˆæ¯" class="headerlink" title="åæ ‡msgæ¶ˆæ¯"></a>åæ ‡msgæ¶ˆæ¯</h4><p>åœ¨åæ ‡è½¬æ¢å®ç°ä¸­å¸¸ç”¨çš„ msgï¼š</p>
<p><font color="Violetred">geometry_msgs/TransformStamped   ä¼ è¾“åæ ‡ç³»ç›¸å…³ä½ç½®ä¿¡æ¯</font></p>
<p><font color="Violetred">geometry_msgs/PointStamped&nbsp;ä¼ è¾“åæ ‡ç³»å†…åæ ‡ç‚¹çš„ä¿¡æ¯</font>     </p>
<blockquote>
<p>c++: è°ƒç”¨PointStampedéœ€è¦è°ƒç”¨tf2_geometry_msgs/tf2_geometry_msgs.h</p>
<p>python: éœ€è¦from tf2_geometry_msgs import PointStampedè°ƒç”¨</p>
</blockquote>
<p>å‘½ä»¤è¡Œé”®å…¥:<code>rosmsg info geometry_msgs/TransformStamped</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">std_msgs/Header header                     #å¤´ä¿¡æ¯</span><br><span class="line">  uint32 seq                                #|-- åºåˆ—å·</span><br><span class="line">  time stamp                                #|-- æ—¶é—´æˆ³</span><br><span class="line">  string frame_id                           #|-- åæ ‡ ID</span><br><span class="line">string child_frame_id                    #å­åæ ‡ç³»çš„ id</span><br><span class="line">geometry_msgs/Transform transform        #åæ ‡ä¿¡æ¯</span><br><span class="line">  geometry_msgs/Vector3 translation        #åç§»é‡</span><br><span class="line">    float64 x                                #|-- X æ–¹å‘çš„åç§»é‡</span><br><span class="line">    float64 y                                #|-- Y æ–¹å‘çš„åç§»é‡</span><br><span class="line">    float64 z                                #|-- Z æ–¹å‘ä¸Šçš„åç§»é‡</span><br><span class="line">  geometry_msgs/Quaternion rotation        #å››å…ƒæ•°</span><br><span class="line">    float64 x                                </span><br><span class="line">    float64 y                                </span><br><span class="line">    float64 z                                </span><br><span class="line">    float64 w</span><br><span class="line"># å››å…ƒæ•°ç”¨äºè¡¨ç¤ºåæ ‡çš„ç›¸å¯¹å§¿æ€</span><br></pre></td></tr></tbody></table></figure>

<p>å‘½ä»¤è¡Œé”®å…¥:<code>rosmsg info geometry_msgs/PointStamped</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">std_msgs/Header header                    #å¤´</span><br><span class="line">  uint32 seq                                #|-- åºå·</span><br><span class="line">  time stamp                                #|-- æ—¶é—´æˆ³</span><br><span class="line">  string frame_id                           #|-- æ‰€å±åæ ‡ç³»çš„ id</span><br><span class="line">geometry_msgs/Point point                #ç‚¹åæ ‡</span><br><span class="line">  float64 x                                 #|-- x y z åæ ‡</span><br><span class="line">  float64 y</span><br><span class="line">  float64 z</span><br></pre></td></tr></tbody></table></figure>

<h4 id="é™æ€åæ ‡å˜æ¢"><a href="#é™æ€åæ ‡å˜æ¢" class="headerlink" title="é™æ€åæ ‡å˜æ¢"></a>é™æ€åæ ‡å˜æ¢</h4><p>é™æ€åæ ‡å˜æ¢ï¼Œæ˜¯æŒ‡ä¸¤ä¸ªåæ ‡ç³»ä¹‹é—´çš„ç›¸å¯¹ä½ç½®æ˜¯å›ºå®šçš„</p>
<p><strong>éœ€æ±‚</strong>ï¼š</p>
<p>ç°æœ‰ä¸€æœºå™¨äººæ¨¡å‹ï¼Œæ ¸å¿ƒæ„æˆåŒ…å«ä¸»ä½“ä¸é›·è¾¾ï¼Œå„å¯¹åº”ä¸€åæ ‡ç³»ï¼Œåæ ‡ç³»çš„åŸç‚¹åˆ†åˆ«ä½äºä¸»ä½“ä¸é›·è¾¾çš„ç‰©ç†ä¸­å¿ƒï¼Œå·²çŸ¥é›·è¾¾åŸç‚¹ç›¸å¯¹äºä¸»ä½“åŸç‚¹ä½ç§»å…³ç³»å¦‚ä¸‹: x 0.2 y0.0 z0.5ã€‚å½“å‰é›·è¾¾æ£€æµ‹åˆ°ä¸€éšœç¢ç‰©ï¼Œåœ¨é›·è¾¾åæ ‡ç³»ä¸­éšœç¢ç‰©çš„åæ ‡ä¸º (2.0 3.0 5.0),è¯·é—®ï¼Œè¯¥éšœç¢ç‰©ç›¸å¯¹äºä¸»ä½“çš„åæ ‡æ˜¯å¤šå°‘ï¼Ÿ</p>
<p>æ·»åŠ ä¾èµ–</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roscpp rospy std_msgs geometry_msgs tf2 tf2_ros tf2_geometry_msgs </span><br></pre></td></tr></tbody></table></figure>

<p><strong>c++</strong></p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/static_transform_broadcaster.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/TransformStamped.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2/LinearMath/Quaternion.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"static_pub"</span>);</span><br><span class="line">    ros::NodeHandle nh; <span class="comment">// éå¿…éœ€</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºå‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    tf2_ros::StaticTransformBroadcaster pub;</span><br><span class="line">    <span class="comment">// ç»„ç»‡å‘å¸ƒæ¶ˆæ¯ </span></span><br><span class="line">    geometry_msgs::TransformStamped tfs;</span><br><span class="line">    <span class="comment">// è®¾ç½®å¤´ä¿¡æ¯</span></span><br><span class="line">    tfs.header.stamp = ros::Time::<span class="built_in">now</span>(); <span class="comment">// æ—¶é—´æˆ³</span></span><br><span class="line">    tfs.header.frame_id = <span class="string">"base_link"</span>; <span class="comment">// åŸç‚¹åæ ‡ç³»</span></span><br><span class="line">    <span class="comment">// éƒ¨ä»¶åæ ‡ç³»</span></span><br><span class="line">    tfs.child_frame_id = <span class="string">"laser"</span>; </span><br><span class="line">    <span class="comment">// éƒ¨ä»¶ç›¸å¯¹åŸç‚¹çš„ä½ç§»</span></span><br><span class="line">    tfs.transform.translation.x = <span class="number">0.2</span>;</span><br><span class="line">    tfs.transform.translation.y = <span class="number">0.0</span>;</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0.5</span>;</span><br><span class="line">    <span class="comment">// è®¾ç½®å››å…ƒæ•°</span></span><br><span class="line">    tf2::Quaternion qtn; </span><br><span class="line">    <span class="comment">// å‘è¯¥å¯¹è±¡è®¾ç½®æ¬§æ‹‰è§’,å¯ä»¥å°†æ¬§æ‹‰è§’è½¬åŒ–ä¸ºå››å…ƒæ•°</span></span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>); <span class="comment">// ç¿»æ»šroll,ä¿¯ä»°pitch,åèˆªyaw,å€¼ä¸ºå¼§åº¦</span></span><br><span class="line">    tfs.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    tfs.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    tfs.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    tfs.transform.rotation.w = qtn.<span class="built_in">getW</span>();  </span><br><span class="line">    <span class="comment">// å‘å¸ƒæ•°æ®</span></span><br><span class="line">    pub.<span class="built_in">sendTransform</span>(tfs);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/æ¬§æ‹‰è§’1.webp" alt="æ¬§æ‹‰è§’1" style="zoom: 67%;">

<blockquote>
<p>æ¬§æ‹‰è§’ï¼šç¿»æ»šroll,ä¿¯ä»°pitch,åèˆªyawï¼Œå¯¹åº”ç»•xyzè½´æ—‹è½¬å¤šå°‘åº¦</p>
<p>è½¬åŒ–ä¸ºå››å…ƒæ•°æ˜¯ä¸ºäº†é¿å…å‡ºç°ä¸‡å‘èŠ‚æ­»é”ï¼Œå½“ä¿¯ä»°è§’è¾¾åˆ°90Â°æ—¶ï¼ˆæœºå¤´å‚ç›´å‘ä¸‹ï¼‰ï¼Œæ­¤æ—¶æ¨ªæ»šï¼ˆXè½´ï¼‰å’Œåèˆªï¼ˆZè½´ï¼‰<code>é‡åˆä¸ºåŒä¸€æ—‹è½¬è½´</code>ï¼Œæ— æ³•åŒºåˆ†å·¦å³å€¾æ–œå’Œæ°´å¹³è½¬å‘</p>
<p>å››å…ƒæ•°ï¼šç”±1ä¸ªå®éƒ¨ + 3ä¸ªè™šéƒ¨ç»„æˆï¼Œè¿™ä¸ªè½¬åŒ–è¿‡ç¨‹è®¡ç®—å¤ªå¤æ‚äº†ï¼Œä¼šç”¨å°±è¡Œ</p>
</blockquote>
<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_listener.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/buffer.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/PointStamped.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_geometry_msgs/tf2_geometry_msgs.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"static_sub"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºTFè®¢é˜…èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªBuffer ç¼“å­˜</span></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="comment">// åˆ›å»ºç›‘å¬å¯¹è±¡(å¯ä»¥å°†è®¢é˜…æ•°æ®æ”¾å…¥buffer)</span></span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line">    <span class="comment">// æ­£å¸¸é›·è¾¾ä¸æ–­æ‰«æåæ ‡</span></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// ç»„ç»‡ä¸€ä¸ªéƒ¨ä»¶åæ ‡ç³»</span></span><br><span class="line">        geometry_msgs::PointStamped point_laser;</span><br><span class="line">        <span class="comment">// éƒ¨ä»¶åæ ‡ç³»åç§° ä¸å‘å¸ƒæ–¹çš„child_frame_id ç›¸åŒ</span></span><br><span class="line">        point_laser.header.frame_id = <span class="string">"laser"</span>; </span><br><span class="line">        point_laser.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">        <span class="comment">// æ£€æµ‹ç‰©ä½“ä¿¡æ¯(éƒ¨ä»¶åæ ‡ç³»ä½ç½®)</span></span><br><span class="line">        point_laser.point.x = <span class="number">2.0</span>;</span><br><span class="line">        point_laser.point.y = <span class="number">3.0</span>;</span><br><span class="line">        point_laser.point.z = <span class="number">5.0</span>;</span><br><span class="line">        <span class="comment">// æ·»åŠ ä¼‘çœ ,é¿å…å¼€å§‹çš„æ—¶å€™æ²¡æœ‰æ‰¾åˆ°å‘å¸ƒçš„åæ ‡ç³»ç›¸å¯¹å…³ç³»,å¯¼è‡´å¼‚å¸¸</span></span><br><span class="line">        <span class="comment">// ros::Duration(2); ä½†æ˜¯ç”¨tryçš„æ–¹æ³•æ›´å¥½</span></span><br><span class="line">        <span class="comment">// è½¬æ¢åæ ‡ç‚¹(ç›¸å¯¹äºåŸç‚¹åæ ‡ç³»)</span></span><br><span class="line">        <span class="comment">// æ–°å»ºä¸€ä¸ªåæ ‡ç‚¹ï¼Œç”¨äºæ¥æ”¶è½¬æ¢ç»“æœ </span></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ try è¯­å¥æˆ–ä¼‘çœ ï¼Œå¦åˆ™å¯èƒ½ç”±äºç¼“å­˜æ¥æ”¶å»¶è¿Ÿè€Œå¯¼è‡´åæ ‡è½¬æ¢å¤±è´¥</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        {</span><br><span class="line">            <span class="comment">// æ ¸å¿ƒä»£ç ,å°†éƒ¨ä»¶åæ ‡ç³»åæ ‡ç‚¹è½¬åŒ–ä¸ºåŸç‚¹åæ ‡ç³»åæ ‡ç‚¹</span></span><br><span class="line">            geometry_msgs::PointStamped point_base;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">                è°ƒç”¨çš„æ˜¯bufferçš„è½¬æ¢å‡½æ•°transform</span></span><br><span class="line"><span class="comment">                å‚æ•°1æ˜¯è¢«è½¬æ¢çš„åæ ‡ç‚¹</span></span><br><span class="line"><span class="comment">                å‚æ•°2æ˜¯ç›®æ ‡åæ ‡ç³»</span></span><br><span class="line"><span class="comment">                è¿”å›è¾“å‡ºçš„åæ ‡ç‚¹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                PS:è°ƒç”¨æ—¶éœ€è¦åŠ å¤´æ–‡ä»¶ tf2_geometry_msgs/tf2_geometry_msgs.h</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            point_base = buffer.<span class="built_in">transform</span>(point_laser,<span class="string">"base_link"</span>); </span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"è½¬æ¢åçš„åæ ‡å€¼:(%.2f,%.2f,%.2f),å‚è€ƒçš„åæ ‡ç³»:%s"</span>,</span><br><span class="line">                point_base.point.x,</span><br><span class="line">                point_base.point.y,</span><br><span class="line">                point_base.point.z,</span><br><span class="line">                point_base.header.frame_id.<span class="built_in">c_str</span>());</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"ç¨‹åºå¼‚å¸¸....."</span>);</span><br><span class="line">        }</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>tos::NodeHandle nh æ³¨å†ŒèŠ‚ç‚¹åˆ°ROS Masterï¼Œæä¾›è®¿é—®ROSåŠŸèƒ½ï¼ˆå¦‚è¯é¢˜ã€æœåŠ¡ã€å‚æ•°ï¼‰çš„æ¥å£ï¼Œå¦‚å¦‚æœåˆ é™¤ ros::NodeHandle nhï¼Œ<code>TransformListener</code> çš„è®¢é˜…å¤±è´¥ï¼Œ<code>buffer</code> æ”¶ä¸åˆ°TFæ•°æ®</p>
<p><strong>python</strong></p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> tf.transformations</span><br><span class="line"><span class="keyword">import</span> tf2_ros</span><br><span class="line"><span class="keyword">import</span> tf</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> TransformStamped</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"static_pub_p"</span>)</span><br><span class="line">    pub = tf2_ros.StaticTransformBroadcaster()</span><br><span class="line">    <span class="comment"># ç»„ç»‡å‘å¸ƒçš„æ•°æ®</span></span><br><span class="line">    tfs = TransformStamped()</span><br><span class="line">    <span class="comment"># è®¾ç½®å¤´ä¿¡æ¯</span></span><br><span class="line">    tfs.header.stamp = rospy.Time.now()  <span class="comment"># æ—¶é—´æˆ³ä¿¡æ¯</span></span><br><span class="line">    tfs.header.frame_id = <span class="string">"base_link"</span>  <span class="comment"># åŸç‚¹åæ ‡ç³»id</span></span><br><span class="line">    <span class="comment"># è®¾ç½®éƒ¨ä»¶åæ ‡ç³»id</span></span><br><span class="line">    tfs.child_frame_id = <span class="string">"laser"</span></span><br><span class="line">    <span class="comment"># éƒ¨ä»¶ç›¸å¯¹åŸç‚¹çš„ä½ç§»</span></span><br><span class="line">    tfs.transform.translation.x = <span class="number">0.2</span></span><br><span class="line">    tfs.transform.translation.y = <span class="number">0.0</span></span><br><span class="line">    tfs.transform.translation.z = <span class="number">0.5</span></span><br><span class="line">    <span class="comment"># è®¾ç½®å››å…ƒæ•°</span></span><br><span class="line">    qtn = tf.transformations.quaternion_from_euler(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    tfs.transform.rotation.x = qtn[<span class="number">0</span>]</span><br><span class="line">    tfs.transform.rotation.y = qtn[<span class="number">1</span>]</span><br><span class="line">    tfs.transform.rotation.z = qtn[<span class="number">2</span>]</span><br><span class="line">    tfs.transform.rotation.w = qtn[<span class="number">3</span>]</span><br><span class="line">    <span class="comment"># å¹¿æ’­å‘é€</span></span><br><span class="line">    pub.sendTransform(tfs)</span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> tf2_ros</span><br><span class="line"><span class="comment"># ä¸è¦ä½¿ç”¨ geometry_msgs,éœ€è¦ä½¿ç”¨ tf2 å†…ç½®çš„æ¶ˆæ¯ç±»å‹</span></span><br><span class="line"><span class="keyword">from</span> tf2_geometry_msgs <span class="keyword">import</span> PointStamped</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"static_sub_p"</span>)</span><br><span class="line">    buffer = tf2_ros.Buffer()</span><br><span class="line">    listener = tf2_ros.TransformListener(buffer)</span><br><span class="line">    rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        <span class="comment"># ç»„ç»‡ä¸€ä¸ªéƒ¨ä»¶åæ ‡ç³» </span></span><br><span class="line">        point_laser = PointStamped()</span><br><span class="line">        <span class="comment"># éƒ¨ä»¶åæ ‡ç³»åç§°</span></span><br><span class="line">        point_laser.header.frame_id = <span class="string">"laser"</span></span><br><span class="line">        <span class="comment"># åæ ‡ç‚¹æ•°æ®</span></span><br><span class="line">        point_laser.header.stamp = rospy.Time.now()</span><br><span class="line">        point_laser.point.x = <span class="number">2.0</span></span><br><span class="line">        point_laser.point.y = <span class="number">3.0</span></span><br><span class="line">        point_laser.point.z = <span class="number">5.0</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ç»„ç»‡ä¸€ä¸ªè½¬æ¢å‚è€ƒç³»</span></span><br><span class="line">            point_base = PointStamped()</span><br><span class="line">            <span class="comment"># åæ ‡è½¬æ¢</span></span><br><span class="line">            point_base = buffer.transform(point_laser,<span class="string">"base_link"</span>)</span><br><span class="line">            rospy.loginfo(<span class="string">"è½¬æ¢åçš„åæ ‡å€¼:(%.2f,%.2f,%.2f),å‚è€ƒçš„åæ ‡ç³»:%s"</span>,</span><br><span class="line">                point_base.point.x,</span><br><span class="line">                point_base.point.y,</span><br><span class="line">                point_base.point.z,</span><br><span class="line">                point_base.header.frame_id)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            rospy.logerr(<span class="string">"å¼‚å¸¸:%s"</span>,e)</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></tbody></table></figure>

<p>python è¿™é‡Œä¸å†™spinæ˜¯å› ä¸ºpythonæ²¡æœ‰spinOnceï¼Œæ— æ³•è·³è¿‡å¾ªç¯</p>
<p>å½“åæ ‡ç³»ä¹‹é—´çš„ç›¸å¯¹ä½ç½®å›ºå®šæ—¶ï¼Œé‚£ä¹ˆæ‰€éœ€å‚æ•°ä¹Ÿæ˜¯å›ºå®šçš„ï¼Œå®ç°é€»è¾‘ç›¸åŒï¼Œå‚æ•°ä¸åŒï¼Œé‚£ä¹ˆ ROS ç³»ç»Ÿå°±å·²ç»å°è£…å¥½äº†ä¸“é—¨çš„èŠ‚ç‚¹ï¼Œä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun tf2_ros static_transform_publisher xåç§»é‡ yåç§»é‡ zåç§»é‡ zåèˆªè§’åº¦ yä¿¯ä»°è§’åº¦ xç¿»æ»šè§’åº¦ çˆ¶çº§åæ ‡ç³» å­çº§åæ ‡ç³»</span><br></pre></td></tr></tbody></table></figure>

<p>å…¶å®çˆ¶ç³»å°±æ˜¯ä»£ç ä¸­çš„åŸç‚¹åæ ‡ç³»ï¼Œå­çº§å°±æ˜¯ä»£ç ä¸­çš„éƒ¨ä»¶åæ ‡ç³»</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun tf2_ros static_transform_publisher 0.2 0 0.5 0 0 0 /base_link /laser</span><br></pre></td></tr></tbody></table></figure>

<p><font color="Violetred">å»ºè®®ä½¿ç”¨è¯¥ç§æ–¹å¼ç›´æ¥å®ç°é™æ€åæ ‡ç³»ç›¸å¯¹ä¿¡æ¯å‘å¸ƒ</font></p>
<h4 id="åŠ¨æ€åæ ‡å˜æ¢"><a href="#åŠ¨æ€åæ ‡å˜æ¢" class="headerlink" title="åŠ¨æ€åæ ‡å˜æ¢"></a>åŠ¨æ€åæ ‡å˜æ¢</h4><p><strong>éœ€æ±‚</strong>ï¼š</p>
<p>å¯åŠ¨ turtlesim_nodeï¼Œè¯¥èŠ‚ç‚¹ä¸­çª—ä½“æœ‰ä¸€ä¸ªä¸–ç•Œåæ ‡ç³»(å·¦ä¸‹è§’ä¸ºåæ ‡ç³»åŸç‚¹)ï¼Œä¹Œé¾Ÿæ˜¯å¦ä¸€ä¸ªåæ ‡ç³»ï¼Œé”®ç›˜æ§åˆ¶ä¹Œé¾Ÿè¿åŠ¨ï¼Œå°†ä¸¤ä¸ªåæ ‡ç³»çš„ç›¸å¯¹ä½ç½®åŠ¨æ€å‘å¸ƒ</p>
<p>ä¾èµ–åŒé™æ€</p>
<p><strong>c++</strong></p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"turtlesim/Pose.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_broadcaster.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/TransformStamped.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2/LinearMath/Quaternion.h"</span> </span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    å‘å¸ƒæ–¹ï¼šéœ€è¦è®¢é˜…ä¹Œé¾Ÿçš„ä½å§¿ä¿¡æ¯ï¼Œè½¬æ¢æˆç›¸å¯¹äºçª—ä½“çš„åæ ‡å…³ç³»ï¼Œå¹¶å‘å¸ƒ</span></span><br><span class="line"><span class="comment">    å‡† å¤‡</span></span><br><span class="line"><span class="comment">        è¯é¢˜ï¼š/turtle1/pose</span></span><br><span class="line"><span class="comment">        æ¶ˆæ¯ï¼š/turtlesim/Pose</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPose</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr&amp; pose)</span></span>{</span><br><span class="line">    <span class="comment">// è·å–ä½å§¿ä¿¡æ¯ï¼Œè½¬æ¢æˆåæ ‡ç³»ç›¸å¯¹å…³ç³»(æ ¸å¿ƒ),å¹¶å‘å¸ƒ</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºå‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// tf2_ros::TransformBroadcaster pub; å¦‚æœè¿™ä¹ˆå†™æ¯æ¬¡å¤„ç†éƒ½è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="type">static</span> tf2_ros::TransformBroadcaster pub; <span class="comment">// é™æ€å‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// å¤„ç†å‘å¸ƒæ•°æ®</span></span><br><span class="line">    geometry_msgs::TransformStamped tfs;</span><br><span class="line">    tfs.header.frame_id = <span class="string">"world"</span>;</span><br><span class="line">    tfs.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">    tfs.child_frame_id = <span class="string">"turtle1"</span>;</span><br><span class="line">    <span class="comment">// ä»ä¹Œé¾Ÿä½å§¿ä¿¡æ¯è·å–åæ ‡</span></span><br><span class="line">    tfs.transform.translation.x = pose-&gt;x;</span><br><span class="line">    tfs.transform.translation.y = pose-&gt;y;</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// åæ ‡ç³»å››å…ƒæ•°</span></span><br><span class="line">    <span class="comment">// pose ä¿¡æ¯ä¸­åªæœ‰åèˆªyaw -&gt; theta,äºŒç»´æ²¡æœ‰ç¿»æ»šroll,ä¿¯ä»°pitch</span></span><br><span class="line">    <span class="comment">// æ¬§æ‹‰è§’ä¸º (0,0,theta)</span></span><br><span class="line">    tf2::Quaternion qtn;</span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,pose-&gt;theta);</span><br><span class="line">    tfs.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    tfs.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    tfs.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    tfs.transform.rotation.w = qtn.<span class="built_in">getW</span>();</span><br><span class="line">    <span class="comment">// å‘å¸ƒ</span></span><br><span class="line">    pub.<span class="built_in">sendTransform</span>(tfs);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"dynamic_pub"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè®¢é˜…å¯¹è±¡</span></span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>(<span class="string">"turtle1/pose"</span>,<span class="number">100</span>,doPose);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<p>ä»£ç å’Œé™æ€çš„ç±»ä¼¼ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç²˜è´´æ”¹</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_listener.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/buffer.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/PointStamped.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_geometry_msgs/tf2_geometry_msgs.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"dynamic_sub"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºTFè®¢é˜…èŠ‚ç‚¹ -&gt; è®¢é˜…ç›¸å¯¹å…³ç³»</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªBuffer ç¼“å­˜</span></span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="comment">// åˆ›å»ºç›‘å¬å¯¹è±¡(å¯ä»¥å°†è®¢é˜…æ•°æ®æ”¾å…¥buffer)</span></span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>;</span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="comment">// ç»„ç»‡ä¸€ä¸ªéƒ¨ä»¶åæ ‡ç³»</span></span><br><span class="line">    geometry_msgs::PointStamped point_turtle;</span><br><span class="line">    point_turtle.header.frame_id = <span class="string">"turtle1"</span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ try è¯­å¥æˆ–ä¼‘çœ ï¼Œå¦åˆ™å¯èƒ½ç”±äºç¼“å­˜æ¥æ”¶å»¶è¿Ÿè€Œå¯¼è‡´åæ ‡è½¬æ¢å¤±è´¥</span></span><br><span class="line">        point_turtle.header.stamp = ros::<span class="built_in">Time</span>(<span class="number">0.0</span>);</span><br><span class="line">        point_turtle.point.x = <span class="number">1</span>;</span><br><span class="line">        point_turtle.point.y = <span class="number">1</span>;</span><br><span class="line">        point_turtle.point.z = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        {</span><br><span class="line">            <span class="comment">// æ ¸å¿ƒä»£ç ,å°†éƒ¨ä»¶åæ ‡ç³»åæ ‡ç‚¹è½¬åŒ–ä¸ºåŸç‚¹åæ ‡ç³»åæ ‡ç‚¹</span></span><br><span class="line">            geometry_msgs::PointStamped point_world;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">                è°ƒç”¨çš„æ˜¯bufferçš„è½¬æ¢å‡½æ•°transform</span></span><br><span class="line"><span class="comment">                å‚æ•°1æ˜¯è¢«è½¬æ¢çš„åæ ‡ç‚¹</span></span><br><span class="line"><span class="comment">                å‚æ•°2æ˜¯ç›®æ ‡åæ ‡ç³»</span></span><br><span class="line"><span class="comment">                è¿”å›è¾“å‡ºçš„åæ ‡ç‚¹</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                PS:è°ƒç”¨æ—¶éœ€è¦åŠ å¤´æ–‡ä»¶ tf2_geometry_msgs/tf2_geometry_msgs.h</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            point_world = buffer.<span class="built_in">transform</span>(point_turtle,<span class="string">"world"</span>); </span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"è½¬æ¢åçš„åæ ‡å€¼:(%.2f,%.2f,%.2f),å‚è€ƒçš„åæ ‡ç³»:%s"</span>,</span><br><span class="line">                point_world.point.x,</span><br><span class="line">                point_world.point.y,</span><br><span class="line">                point_world.point.z,</span><br><span class="line">                point_world.header.frame_id.<span class="built_in">c_str</span>());</span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"ç¨‹åºå¼‚å¸¸....."</span>);</span><br><span class="line">        }</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>æ³¨æ„è¿™é‡Œ<code>ros::Time</code>ä¸å¯ä»¥ç”¨now äº†ï¼Œå› ä¸ºåŠ¨æ€ä½¿å¾—éƒ¨ä»¶ä½ç½®ä¸€ç›´åœ¨å‘ç”Ÿå˜åŒ–ï¼Œbufferæ¥æ”¶æœ‰å»¶è¿Ÿï¼Œä½¿å¾—éƒ¨ä»¶ç›¸å¯¹ä½ç½®å’Œæ£€æµ‹ç‰©ä½“ä½ç½®çš„æ—¶é—´æˆ³åŒ¹é…ä¸ä¸Šï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œè®¾ç½®ros::time(0.0)æˆ–è€…ç©ºæ•°å€¼å°±å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜(ä¸è€ƒè™‘æ—¶é—´æˆ³ç»§ç»­è½¬åŒ–)</p>
<p><strong>python</strong></p>
<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">from</span> turtlesim.msg <span class="keyword">import</span> Pose</span><br><span class="line"><span class="keyword">import</span> tf2_ros</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> TransformStamped</span><br><span class="line"><span class="keyword">import</span> tf.transformations</span><br><span class="line"><span class="string">"""  </span></span><br><span class="line"><span class="string">    å‘å¸ƒæ–¹ï¼šéœ€è¦è®¢é˜…ä¹Œé¾Ÿçš„ä½å§¿ä¿¡æ¯ï¼Œè½¬æ¢æˆç›¸å¯¹äºçª—ä½“çš„åæ ‡å…³ç³»ï¼Œå¹¶å‘å¸ƒ</span></span><br><span class="line"><span class="string">    å‡† å¤‡</span></span><br><span class="line"><span class="string">        è¯é¢˜ï¼š/turtle1/pose</span></span><br><span class="line"><span class="string">        æ¶ˆæ¯ï¼š/turtlesim/Pose</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">doPose</span>(<span class="params">pose</span>):</span><br><span class="line">	<span class="comment"># 1. åˆ›å»ºå‘å¸ƒåæ ‡ç³»ç›¸å¯¹å…³ç³»çš„å¯¹è±¡</span></span><br><span class="line">    pub = tf2_ros.TransformBroadcaster()</span><br><span class="line">    <span class="comment"># 2. å°†poseè½¬æ¢æˆåæ ‡ç³»ç›¸å¯¹å…³ç³»æ¶ˆæ¯</span></span><br><span class="line">    tfs = TransformStamped()</span><br><span class="line">    tfs.header.frame_id = <span class="string">"world"</span></span><br><span class="line">    tfs.header.stamp = rospy.Time.now()</span><br><span class="line">    tfs.child_frame_id = <span class="string">"turtle1"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆéƒ¨ä»¶åæ ‡ç³»ç›¸å¯¹äºåŸç‚¹åæ ‡ç³»çš„åç§»é‡</span></span><br><span class="line">    tfs.transform.translation.x = pose.x</span><br><span class="line">    tfs.transform.translation.y = pose.y</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å››å…ƒæ•°,ä»æ¬§æ‹‰è§’è½¬æ¢</span></span><br><span class="line">    qtn = tf.transformations.quaternion_from_euler(<span class="number">0</span>,<span class="number">0</span>,pose.theta)</span><br><span class="line">    tfs.transform.rotation.x = qtn[<span class="number">0</span>]</span><br><span class="line">    tfs.transform.rotation.y = qtn[<span class="number">1</span>]</span><br><span class="line">    tfs.transform.rotation.z = qtn[<span class="number">2</span>]</span><br><span class="line">    tfs.transform.rotation.w = qtn[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. å‘å¸ƒ</span></span><br><span class="line">    pub.sendTransform(tfs)</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"dynamic_pub_p"</span>)</span><br><span class="line">    sub = rospy.Subscriber(<span class="string">"/turtle1/pose"</span>,Pose,doPose,queue_size=<span class="number">100</span>)</span><br><span class="line">    rospy.spin()</span><br></pre></td></tr></tbody></table></figure>

<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> tf2_ros</span><br><span class="line"><span class="comment"># ä¸è¦ä½¿ç”¨ geometry_msgs,éœ€è¦ä½¿ç”¨ tf2 å†…ç½®çš„æ¶ˆæ¯ç±»å‹</span></span><br><span class="line"><span class="keyword">from</span> tf2_geometry_msgs <span class="keyword">import</span> PointStamped</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    rospy.init_node(<span class="string">"dynamic_sub_p"</span>)</span><br><span class="line">    buffer = tf2_ros.Buffer()</span><br><span class="line">    listener = tf2_ros.TransformListener(buffer)</span><br><span class="line">    rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line">    point_turtle = PointStamped()</span><br><span class="line">    point_turtle.header.frame_id = <span class="string">"turtle1"</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">        point_turtle.header.stamp = rospy.Time()</span><br><span class="line">        point_turtle.point.x = <span class="number">1</span></span><br><span class="line">        point_turtle.point.y = <span class="number">1</span> </span><br><span class="line">        point_turtle.point.z = <span class="number">1</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            point_world = buffer.transform(point_turtle,<span class="string">"world"</span>)</span><br><span class="line">            rospy.loginfo(<span class="string">"è½¬æ¢åçš„åæ ‡å€¼:(%.2f,%.2f,%.2f)"</span>,</span><br><span class="line">                point_world.point.x,</span><br><span class="line">                point_world.point.y,</span><br><span class="line">                point_world.point.z,)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            rospy.loginfo(<span class="string">"å¼‚å¸¸:%s"</span>,e)</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></tbody></table></figure>

<h4 id="å¤šåæ ‡ç³»å˜æ¢"><a href="#å¤šåæ ‡ç³»å˜æ¢" class="headerlink" title="å¤šåæ ‡ç³»å˜æ¢"></a>å¤šåæ ‡ç³»å˜æ¢</h4><p><strong>éœ€æ±‚</strong>ï¼š</p>
<p>ç°æœ‰åæ ‡ç³»ç»Ÿï¼Œçˆ¶çº§åæ ‡ç³»ç»Ÿ world,ä¸‹æœ‰ä¸¤å­çº§ç³»ç»Ÿ son1ï¼Œson2ï¼Œson1 ç›¸å¯¹äº worldï¼Œä»¥åŠ son2 ç›¸å¯¹äº world çš„å…³ç³»æ˜¯å·²çŸ¥çš„ï¼Œæ±‚ son1åŸç‚¹åœ¨ son2ä¸­çš„åæ ‡ï¼Œåˆå·²çŸ¥åœ¨ son1ä¸­ä¸€ç‚¹çš„åæ ‡ï¼Œè¦æ±‚æ±‚å‡ºè¯¥ç‚¹åœ¨ son2 ä¸­çš„åæ ‡</p>
<p>å‘å¸ƒæ–¹ï¼š</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;launch&gt;</span><br><span class="line">    &lt;node pkg="tf2_ros" type="static_transform_publisher" name="son1" args="5 1 0 0 0 0 /world /son1" output="screen"/&gt;</span><br><span class="line">    &lt;node pkg="tf2_ros" type="static_transform_publisher" name="son2" args="-5 -1 0 0 0 0 /world /son2" output="screen"/&gt;</span><br><span class="line">&lt;/launch&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>ä½¿ç”¨launchæ–‡ä»¶å»ºç«‹ä¸¤ä¸ªå­åæ ‡ç³»</p>
<p>è®¢é˜…æ–¹ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_listener.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/buffer.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/PointStamped.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_geometry_msgs/tf2_geometry_msgs.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/TransformStamped.h"</span></span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    è®¢é˜…æ–¹å®ç°ï¼š</span></span><br><span class="line"><span class="comment">        1. è®¡ç®—son1ä¸son2çš„ç›¸å¯¹å…³ç³»</span></span><br><span class="line"><span class="comment">        2. è®¡ç®—son1ä¸­çš„æŸä¸ªç‚¹åœ¨son2ä¸­çš„åæ ‡å€¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"tfs_sub"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">sub</span><span class="params">(buffer)</span></span>;</span><br><span class="line">    <span class="function">ros::Rate <span class="title">rate</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">    <span class="comment">// åˆ›å»ºåæ ‡ç‚¹</span></span><br><span class="line">    geometry_msgs::PointStamped psAtSon1;</span><br><span class="line">    psAtSon<span class="number">1.</span>header.frame_id = <span class="string">"son1"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>()){</span><br><span class="line"></span><br><span class="line">        psAtSon<span class="number">1.</span>header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">        psAtSon<span class="number">1.</span>point.x = <span class="number">1.0</span>;</span><br><span class="line">        psAtSon<span class="number">1.</span>point.y = <span class="number">2.0</span>;</span><br><span class="line">        psAtSon<span class="number">1.</span>point.z = <span class="number">3.0</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        {</span><br><span class="line">            geometry_msgs::PointStamped psAtSon2;</span><br><span class="line">            <span class="comment">// è®¡ç®—son1 å’Œson2 çš„åæ ‡å…³ç³»</span></span><br><span class="line">            <span class="comment">// lookupTransform:å‚æ•°1çˆ¶çº§åæ ‡ç³»,å‚æ•°2å­åæ ‡ç³»,å‚æ•°3ros::Time(0) å–é—´éš”æœ€å°çš„ä¸¤ä¸ªæ—¶é—´æˆ³è¿›è¡Œè®¡ç®—</span></span><br><span class="line">            geometry_msgs::TransformStamped son1Toson2 = buffer.<span class="built_in">lookupTransform</span>(<span class="string">"son2"</span>,<span class="string">"son1"</span>,ros::<span class="built_in">Time</span>(<span class="number">0</span>));</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"son1 ç›¸å¯¹ son2 çš„ä¿¡æ¯: çˆ¶çº§:%s,å­çº§:%s, åç§»é‡:(%.2f,%.2f,%.2f)"</span>,</span><br><span class="line">                    son1Toson<span class="number">2.</span>header.frame_id.<span class="built_in">c_str</span>(),</span><br><span class="line">                    son1Toson<span class="number">2.</span>child_frame_id.<span class="built_in">c_str</span>(),</span><br><span class="line">                    son1Toson<span class="number">2.</span>transform.translation.x,</span><br><span class="line">                    son1Toson<span class="number">2.</span>transform.translation.y,</span><br><span class="line">                    son1Toson<span class="number">2.</span>transform.translation.z</span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¡ç®—son1ä¸­æŸä¸ªç‚¹åœ¨son2ä¸­çš„åæ ‡å€¼</span></span><br><span class="line">            psAtSon2 = buffer.<span class="built_in">transform</span>(psAtSon1,<span class="string">"son2"</span>);</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"åæ ‡ç‚¹åœ¨Son2ä¸­çš„å€¼:(%.2f,%.2f,%.2f)"</span>,</span><br><span class="line">                    psAtSon<span class="number">2.</span>point.x,</span><br><span class="line">                    psAtSon<span class="number">2.</span>point.y,</span><br><span class="line">                    psAtSon<span class="number">2.</span>point.z);</span><br><span class="line">            </span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"é”™è¯¯æç¤º:%s"</span>,e.<span class="built_in">what</span>());</span><br><span class="line">        }</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.å¯¼åŒ…</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> tf2_ros</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> TransformStamped</span><br><span class="line"><span class="keyword">from</span> tf2_geometry_msgs <span class="keyword">import</span> PointStamped</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.åˆå§‹åŒ– ROS èŠ‚ç‚¹</span></span><br><span class="line">    rospy.init_node(<span class="string">"frames_sub_p"</span>)</span><br><span class="line">    <span class="comment"># 3.åˆ›å»º TF è®¢é˜…å¯¹è±¡</span></span><br><span class="line">    buffer = tf2_ros.Buffer()</span><br><span class="line">    listener = tf2_ros.TransformListener(buffer)</span><br><span class="line"></span><br><span class="line">    rate = rospy.Rate(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 4.è°ƒç”¨ API æ±‚å‡º son1 ç›¸å¯¹äº son2 çš„åæ ‡å…³ç³»</span></span><br><span class="line">            <span class="comment">#lookup_transform(self, target_frame, source_frame, time, timeout=rospy.Duration(0.0)):</span></span><br><span class="line">            tfs = buffer.lookup_transform(<span class="string">"son2"</span>,<span class="string">"son1"</span>,rospy.Time(<span class="number">0</span>))</span><br><span class="line">            rospy.loginfo(<span class="string">"son1 ä¸ son2 ç›¸å¯¹å…³ç³»:"</span>)</span><br><span class="line">            rospy.loginfo(<span class="string">"çˆ¶çº§åæ ‡ç³»:%s"</span>,tfs.header.frame_id)</span><br><span class="line">            rospy.loginfo(<span class="string">"å­çº§åæ ‡ç³»:%s"</span>,tfs.child_frame_id)</span><br><span class="line">            rospy.loginfo(<span class="string">"ç›¸å¯¹åæ ‡:x=%.2f, y=%.2f, z=%.2f"</span>,</span><br><span class="line">                        tfs.transform.translation.x,</span><br><span class="line">                        tfs.transform.translation.y,</span><br><span class="line">                        tfs.transform.translation.z,</span><br><span class="line">            )</span><br><span class="line">        <span class="comment"># 5.åˆ›å»ºä¸€ä¾èµ–äº son1 çš„åæ ‡ç‚¹ï¼Œè°ƒç”¨ API æ±‚å‡ºè¯¥ç‚¹åœ¨ son2 ä¸­çš„åæ ‡</span></span><br><span class="line">            point_source = PointStamped()</span><br><span class="line">            point_source.header.frame_id = <span class="string">"son1"</span></span><br><span class="line">            point_source.header.stamp = rospy.Time.now()</span><br><span class="line">            point_source.point.x = <span class="number">1</span></span><br><span class="line">            point_source.point.y = <span class="number">1</span></span><br><span class="line">            point_source.point.z = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            point_target = buffer.transform(point_source,<span class="string">"son2"</span>,rospy.Duration(<span class="number">0.5</span>))</span><br><span class="line"></span><br><span class="line">            rospy.loginfo(<span class="string">"point_target æ‰€å±çš„åæ ‡ç³»:%s"</span>,point_target.header.frame_id)</span><br><span class="line">            rospy.loginfo(<span class="string">"åæ ‡ç‚¹ç›¸å¯¹äº son2 çš„åæ ‡:(%.2f,%.2f,%.2f)"</span>,</span><br><span class="line">                        point_target.point.x,</span><br><span class="line">                        point_target.point.y,</span><br><span class="line">                        point_target.point.z</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            rospy.logerr(<span class="string">"é”™è¯¯æç¤º:%s"</span>,e)</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></tbody></table></figure>

<h4 id="åæ ‡ç³»å…³ç³»æŸ¥çœ‹"><a href="#åæ ‡ç³»å…³ç³»æŸ¥çœ‹" class="headerlink" title="åæ ‡ç³»å…³ç³»æŸ¥çœ‹"></a>åæ ‡ç³»å…³ç³»æŸ¥çœ‹</h4><p>åœ¨æœºå™¨äººç³»ç»Ÿä¸­ï¼Œæ¶‰åŠçš„åæ ‡ç³»æœ‰å¤šä¸ªï¼Œä¸ºäº†æ–¹ä¾¿æŸ¥çœ‹ï¼Œros æä¾›äº†ä¸“é—¨çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºç”Ÿæˆæ˜¾ç¤ºåæ ‡ç³»å…³ç³»çš„ pdf æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æ ‘å½¢ç»“æ„çš„åæ ‡ç³»å›¾è°±</p>
<p>å®‰è£…æŒ‡ä»¤</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ros-noetic-tf2-tools</span><br></pre></td></tr></tbody></table></figure>

<p>å¯åŠ¨åæ ‡ç³»å¹¿æ’­ç¨‹åºä¹‹åï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun tf2_tools view_frames.py</span><br></pre></td></tr></tbody></table></figure>

<p>ä¼šäº§ç”Ÿç±»ä¼¼äºä¸‹é¢çš„æ—¥å¿—ä¿¡æ¯:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[INFO] [1592920556.827549]: Listening to tf data during 5 seconds...</span><br><span class="line">[INFO] [1592920561.841536]: Generating graph in frames.pdf file...</span><br></pre></td></tr></tbody></table></figure>

<p>æŸ¥çœ‹å½“å‰ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ª frames.pdf æ–‡ä»¶</p>
<p>å¯ä»¥ç›´æ¥è¿›å…¥ç›®å½•æ‰“å¼€æ–‡ä»¶ï¼Œæˆ–è€…è°ƒç”¨å‘½ä»¤æŸ¥çœ‹æ–‡ä»¶:<code>evince frames.pdf</code></p>
<h4 id="åæ ‡å˜æ¢å®æ“"><a href="#åæ ‡å˜æ¢å®æ“" class="headerlink" title="åæ ‡å˜æ¢å®æ“"></a>åæ ‡å˜æ¢å®æ“</h4><p>éœ€æ±‚æè¿°ï¼šç¨‹åºå¯åŠ¨ä¹‹åˆäº§ç”Ÿä¸¤åªä¹Œé¾Ÿï¼Œä¸­é—´çš„ä¹Œé¾Ÿ(A) å’Œ å·¦ä¸‹ä¹Œé¾Ÿ(B)ï¼ŒB ä¼šè‡ªåŠ¨è¿è¡Œè‡³Açš„ä½ç½®ï¼Œå¹¶ä¸”é”®ç›˜æ§åˆ¶æ—¶ï¼Œåªæ˜¯æ§åˆ¶ A çš„è¿åŠ¨ï¼Œä½†æ˜¯ B å¯ä»¥è·Ÿéš A è¿è¡Œ</p>
<p>å®ç°åˆ†æï¼š</p>
<p>ä¹Œé¾Ÿè·Ÿéšå®ç°çš„æ ¸å¿ƒï¼Œæ˜¯ä¹Œé¾ŸAå’ŒBéƒ½è¦å‘å¸ƒç›¸å¯¹ä¸–ç•Œåæ ‡ç³»çš„åæ ‡ä¿¡æ¯ï¼Œç„¶åï¼Œè®¢é˜…åˆ°è¯¥ä¿¡æ¯éœ€è¦è½¬æ¢è·å–Aç›¸å¯¹äºBåæ ‡ç³»çš„ä¿¡æ¯ï¼Œæœ€åï¼Œå†ç”Ÿæˆé€Ÿåº¦ä¿¡æ¯ï¼Œå¹¶æ§åˆ¶Bè¿åŠ¨ã€‚</p>
<ol>
<li>å¯åŠ¨ä¹Œé¾Ÿæ˜¾ç¤ºèŠ‚ç‚¹</li>
<li>åœ¨ä¹Œé¾Ÿæ˜¾ç¤ºçª—ä½“ä¸­ç”Ÿæˆä¸€åªæ–°çš„ä¹Œé¾Ÿ(éœ€è¦ä½¿ç”¨æœåŠ¡)</li>
<li>ç¼–å†™ä¸¤åªä¹Œé¾Ÿå‘å¸ƒåæ ‡ä¿¡æ¯çš„èŠ‚ç‚¹</li>
<li>ç¼–å†™è®¢é˜…èŠ‚ç‚¹è®¢é˜…åæ ‡ä¿¡æ¯å¹¶ç”Ÿæˆæ–°çš„ç›¸å¯¹å…³ç³»ç”Ÿæˆé€Ÿåº¦ä¿¡æ¯</li>
</ol>
<p>å®ç°æµç¨‹ï¼š</p>
<ol>
<li>æ–°å»ºåŠŸèƒ½åŒ…ï¼Œæ·»åŠ ä¾èµ–</li>
<li>ç¼–å†™æœåŠ¡å®¢æˆ·ç«¯ï¼Œç”¨äºç”Ÿæˆä¸€åªæ–°çš„ä¹Œé¾Ÿ</li>
<li>ç¼–å†™å‘å¸ƒæ–¹ï¼Œå‘å¸ƒä¸¤åªä¹Œé¾Ÿçš„åæ ‡ä¿¡æ¯</li>
<li>ç¼–å†™è®¢é˜…æ–¹ï¼Œè®¢é˜…ä¸¤åªä¹Œé¾Ÿä¿¡æ¯ï¼Œç”Ÿæˆé€Ÿåº¦ä¿¡æ¯å¹¶å‘å¸ƒ</li>
<li>è¿è¡Œ</li>
</ol>
<p>åˆ›å»ºç¬¬äºŒåªä¹Œé¾Ÿéœ€è¦ä½¿ç”¨rosserviceï¼Œè¯é¢˜ä½¿ç”¨çš„æ˜¯ spawn</p>
<p>ä½ç½®ä¿¡æ¯é€šè¿‡è¯é¢˜ /ä¹Œé¾Ÿåç§°/pose æ¥è·å–çš„</p>
<p>åˆ›å»ºåŠŸèƒ½åŒ…ä¾èµ–äº tf2ã€tf2_rosã€tf2_geometry_msgsã€roscpp rospy std_msgs geometry_msgsã€turtlesim</p>
<p><strong>æœåŠ¡å®¢æˆ·ç«¯(ç”Ÿæˆä¹Œé¾Ÿ)</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"turtlesim/Spawn.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"turtle_new"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºå®¢æˆ·ç«¯</span></span><br><span class="line">    ros::ServiceClient client = nh.<span class="built_in">serviceClient</span>&lt;turtlesim::Spawn&gt;(<span class="string">"/spawn"</span>);</span><br><span class="line">    <span class="comment">// è¯·æ±‚å†…å®¹</span></span><br><span class="line">    turtlesim::Spawn spawn;</span><br><span class="line">    spawn.request.x = <span class="number">1</span>;</span><br><span class="line">    spawn.request.y = <span class="number">3</span>;</span><br><span class="line">    spawn.request.theta = <span class="number">1.57</span>;</span><br><span class="line">    spawn.request.name = <span class="string">"turtle2"</span>;</span><br><span class="line">    <span class="comment">// ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨</span></span><br><span class="line">    client.<span class="built_in">waitForExistence</span>();</span><br><span class="line">    <span class="comment">// call å‘é€è¯·æ±‚,flagååº”ç»“æœ</span></span><br><span class="line">    <span class="type">bool</span> flag = client.<span class="built_in">call</span>(spawn);</span><br><span class="line">    <span class="keyword">if</span>(flag)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"æ–°çš„ä¹Œé¾Ÿç”Ÿæˆ,åç§°:%s"</span>,spawn.response.name.<span class="built_in">c_str</span>());</span><br><span class="line">    }<span class="keyword">else</span> {</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"ä¹Œé¾Ÿç”Ÿæˆå¤±è´¥ï¼ï¼ï¼"</span>);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>å‘å¸ƒæ–¹(å‘å¸ƒä¸¤åªä¹Œé¾Ÿçš„åæ ‡ä¿¡æ¯)</strong></p>
<ul>
<li>è¯¥èŠ‚ç‚¹éœ€è¦å¯åŠ¨ä¸¤æ¬¡</li>
<li>æ¯æ¬¡å¯åŠ¨æ—¶éƒ½éœ€è¦ä¼ å…¥ä¹Œé¾ŸèŠ‚ç‚¹åç§°(ç¬¬ä¸€æ¬¡æ˜¯ turtle1 ç¬¬äºŒæ¬¡æ˜¯ turtle2)</li>
</ul>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"turtlesim/Pose.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_broadcaster.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/TransformStamped.h"</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2/LinearMath/Quaternion.h"</span> </span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    å‘å¸ƒæ–¹ï¼šéœ€è¦è®¢é˜…ä¹Œé¾Ÿçš„ä½å§¿ä¿¡æ¯ï¼Œè½¬æ¢æˆç›¸å¯¹äºçª—ä½“çš„åæ ‡å…³ç³»ï¼Œå¹¶å‘å¸ƒ</span></span><br><span class="line"><span class="comment">    å‡† å¤‡</span></span><br><span class="line"><span class="comment">        è¯é¢˜ï¼š/turtle1/pose</span></span><br><span class="line"><span class="comment">        æ¶ˆæ¯ï¼š/turtlesim/Pose</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¼ å…¥çš„å˜é‡</span></span><br><span class="line">std::string turtle_name;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">doPose</span><span class="params">(<span class="type">const</span> turtlesim::Pose::ConstPtr&amp; pose)</span></span>{</span><br><span class="line">    <span class="comment">// è·å–ä½å§¿ä¿¡æ¯ï¼Œè½¬æ¢æˆåæ ‡ç³»ç›¸å¯¹å…³ç³»(æ ¸å¿ƒ),å¹¶å‘å¸ƒ</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºå‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// tf2_ros::TransformBroadcaster pub; å¦‚æœè¿™ä¹ˆå†™æ¯æ¬¡å¤„ç†éƒ½è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="type">static</span> tf2_ros::TransformBroadcaster pub; <span class="comment">// é™æ€å‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    <span class="comment">// å¤„ç†å‘å¸ƒæ•°æ®</span></span><br><span class="line">    geometry_msgs::TransformStamped tfs;</span><br><span class="line">    tfs.header.frame_id = <span class="string">"world"</span>;</span><br><span class="line">    tfs.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">    <span class="comment">// tfs.child_frame_id åŠ¨æ€ä¼ å…¥</span></span><br><span class="line">    tfs.child_frame_id = turtle_name;</span><br><span class="line">    <span class="comment">// ä»ä¹Œé¾Ÿä½å§¿ä¿¡æ¯è·å–åæ ‡</span></span><br><span class="line">    tfs.transform.translation.x = pose-&gt;x;</span><br><span class="line">    tfs.transform.translation.y = pose-&gt;y;</span><br><span class="line">    tfs.transform.translation.z = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// åæ ‡ç³»å››å…ƒæ•°</span></span><br><span class="line">    <span class="comment">// pose ä¿¡æ¯ä¸­åªæœ‰åèˆªyaw -&gt; theta,äºŒç»´æ²¡æœ‰ç¿»æ»šroll,ä¿¯ä»°pitch</span></span><br><span class="line">    <span class="comment">// æ¬§æ‹‰è§’ä¸º (0,0,theta)</span></span><br><span class="line">    tf2::Quaternion qtn;</span><br><span class="line">    qtn.<span class="built_in">setRPY</span>(<span class="number">0</span>,<span class="number">0</span>,pose-&gt;theta);</span><br><span class="line">    tfs.transform.rotation.x = qtn.<span class="built_in">getX</span>();</span><br><span class="line">    tfs.transform.rotation.y = qtn.<span class="built_in">getY</span>();</span><br><span class="line">    tfs.transform.rotation.z = qtn.<span class="built_in">getZ</span>();</span><br><span class="line">    tfs.transform.rotation.w = qtn.<span class="built_in">getW</span>();</span><br><span class="line">    <span class="comment">// å‘å¸ƒ</span></span><br><span class="line">    pub.<span class="built_in">sendTransform</span>(tfs);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"dynamic_pub"</span>);</span><br><span class="line">    <span class="comment">// è§£æargcä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span>(argc != <span class="number">2</span>)</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_ERROR</span>(<span class="string">"è¯·ä¼ å…¥ä¸€ä¸ªå‚æ•°"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    }<span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">        turtle_name = argv[<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"ä¹Œé¾Ÿ %s åæ ‡å‘é€å¯åŠ¨"</span>,turtle_name.<span class="built_in">c_str</span>());</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºè®¢é˜…å¯¹è±¡,è®¢é˜…è¯é¢˜åŠ¨æ€ä¼ å…¥</span></span><br><span class="line">    ros::Subscriber sub = nh.<span class="built_in">subscribe</span>(turtle_name + <span class="string">"/pose"</span>,<span class="number">100</span>,doPose);</span><br><span class="line">    ros::<span class="built_in">spin</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>è®¢é˜…æ–¹(è§£æåæ ‡ä¿¡æ¯å¹¶ç”Ÿæˆé€Ÿåº¦ä¿¡æ¯)</strong></p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/transform_listener.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_ros/buffer.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/PointStamped.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"tf2_geometry_msgs/tf2_geometry_msgs.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/TransformStamped.h"</span> <span class="comment">// buffer.lookupTransform è¿”å›å€¼ç±»å‹</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"geometry_msgs/Twist.h"</span> <span class="comment">//é€Ÿåº¦ä¿¡æ¯</span></span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">    è®¢é˜…æ–¹å®ç°ï¼š</span></span><br><span class="line"><span class="comment">        1. è®¡ç®—turtle1ç›¸å¯¹turtle2çš„å…³ç³»</span></span><br><span class="line"><span class="comment">        2. è®¡ç®—çº¿é€Ÿåº¦å’Œè§’é€Ÿåº¦å‘å¸ƒ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"control"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    tf2_ros::Buffer buffer;</span><br><span class="line">    <span class="function">tf2_ros::TransformListener <span class="title">listener</span><span class="params">(buffer)</span></span>; <span class="comment">// ä¸èƒ½åˆ ç›‘å¬å™¨</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºå‘å¸ƒå¯¹è±¡</span></span><br><span class="line">    ros::Publisher pub = nh.<span class="built_in">advertise</span>&lt;geometry_msgs::Twist&gt;(<span class="string">"/turtle2/cmd_vel"</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="function">ros::Rate <span class="title">rate</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>()){</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        {</span><br><span class="line">            <span class="comment">// å‚æ•°1çˆ¶çº§åæ ‡ç³»,å‚æ•°2å­åæ ‡ç³»,å‚æ•°3ros::Time(0) å–é—´éš”æœ€å°çš„ä¸¤ä¸ªæ—¶é—´æˆ³è¿›è¡Œè®¡ç®—</span></span><br><span class="line">            geometry_msgs::TransformStamped tfs = buffer.<span class="built_in">lookupTransform</span>(<span class="string">"turtle2"</span>,<span class="string">"turtle1"</span>,ros::<span class="built_in">Time</span>(<span class="number">0</span>));</span><br><span class="line">            <span class="comment">// ROS_INFO("%s ç›¸å¯¹ %s çš„åç§»é‡:(%.2f,%.2f,%.2f)",</span></span><br><span class="line">            <span class="comment">//         tfs.child_frame_id.c_str(),</span></span><br><span class="line">            <span class="comment">//         tfs.header.frame_id.c_str(),</span></span><br><span class="line">            <span class="comment">//         tfs.transform.translation.x,</span></span><br><span class="line">            <span class="comment">//         tfs.transform.translation.y,</span></span><br><span class="line">            <span class="comment">//         tfs.transform.translation.z</span></span><br><span class="line">            <span class="comment">//     );</span></span><br><span class="line">            geometry_msgs::Twist twist;</span><br><span class="line">            <span class="comment">// 2Dåªéœ€è¦é…ç½®è§’é€Ÿåº¦zå’Œçº¿é€Ÿåº¦x</span></span><br><span class="line">            <span class="comment">// x = ç³»æ•°*\sqrt{(y^2+x^2)}</span></span><br><span class="line">            <span class="comment">// z = ç³»æ•°*arctan(y/x)</span></span><br><span class="line">            twist.linear.x = <span class="number">0.5</span> * <span class="built_in">sqrt</span>(<span class="built_in">pow</span>(tfs.transform.translation.x,<span class="number">2</span>)+<span class="built_in">pow</span>(tfs.transform.translation.y,<span class="number">2</span>));</span><br><span class="line">            twist.angular.z = <span class="number">0.5</span> * <span class="built_in">atan2</span>(tfs.transform.translation.y,tfs.transform.translation.x);</span><br><span class="line">            <span class="comment">// å‘å¸ƒ</span></span><br><span class="line">            pub.<span class="built_in">publish</span>(twist);</span><br><span class="line">            </span><br><span class="line">        }</span><br><span class="line">        <span class="built_in">catch</span>(<span class="type">const</span> std::exception&amp; e)</span><br><span class="line">        {</span><br><span class="line">            <span class="built_in">ROS_INFO</span>(<span class="string">"é”™è¯¯æç¤º:%s"</span>,e.<span class="built_in">what</span>());</span><br><span class="line">        }</span><br><span class="line">        rate.<span class="built_in">sleep</span>();</span><br><span class="line">        ros::<span class="built_in">spinOnce</span>(); </span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>è¿è¡Œ</strong></p>
<p>ä½¿ç”¨launchæ–‡ä»¶</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">launch</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1. å¯åŠ¨ä¹Œé¾ŸGUIèŠ‚ç‚¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"turtlesim"</span> <span class="attr">type</span>=<span class="string">"turtlesim_node"</span> <span class="attr">name</span>=<span class="string">"turtle1"</span> <span class="attr">output</span>=<span class="string">"screen"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"turtlesim"</span> <span class="attr">type</span>=<span class="string">"turtle_teleop_key"</span> <span class="attr">name</span>=<span class="string">"key"</span> <span class="attr">output</span>=<span class="string">"screen"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2. ç”Ÿæˆæ–°ä¹Œé¾ŸèŠ‚ç‚¹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"tf04_test"</span> <span class="attr">type</span>=<span class="string">"new_turtle"</span> <span class="attr">name</span>=<span class="string">"turtle2"</span> <span class="attr">output</span>=<span class="string">"screen"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 3. è®¾ç½®ä¸¤ä¸ªä¹Œé¾Ÿç›¸å¯¹äºä¸–ç•Œåæ ‡çš„å‘å¸ƒ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"tf04_test"</span> <span class="attr">type</span>=<span class="string">"dynamic_pub"</span> <span class="attr">name</span>=<span class="string">"pub1"</span> <span class="attr">args</span>=<span class="string">"turtle1"</span> <span class="attr">output</span>=<span class="string">"screen"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"tf04_test"</span> <span class="attr">type</span>=<span class="string">"dynamic_pub"</span> <span class="attr">name</span>=<span class="string">"pub2"</span> <span class="attr">args</span>=<span class="string">"turtle2"</span> <span class="attr">output</span>=<span class="string">"screen"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 4. è®¢é˜…ä¸¤åªä¹Œé¾Ÿç›¸å¯¹äºä¸–ç•Œåæ ‡ç³»çš„ä¿¡æ¯,å¹¶è½¬åŒ–ä¸ºturtle1ç›¸å¯¹äºturtle2çš„åæ ‡å…³ç³»</span></span><br><span class="line"><span class="comment">            å†ç”Ÿæˆé€Ÿåº¦ä¿¡æ¯ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">node</span> <span class="attr">pkg</span>=<span class="string">"tf04_test"</span> <span class="attr">type</span>=<span class="string">"control"</span> <span class="attr">name</span>=<span class="string">"control"</span> <span class="attr">output</span>=<span class="string">"screen"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">launch</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="rosbag"><a href="#rosbag" class="headerlink" title="rosbag"></a>rosbag</h3><p>æœºå™¨äººä¼ æ„Ÿå™¨è·å–åˆ°çš„ä¿¡æ¯ï¼Œæœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦æ—¶æ—¶å¤„ç†ï¼Œæœ‰æ—¶å¯èƒ½åªæ˜¯é‡‡é›†æ•°æ®ï¼Œäº‹ååˆ†æ</p>
<p>æœºå™¨äººå¯¼èˆªå®ç°ä¸­ï¼Œå¯èƒ½éœ€è¦ç»˜åˆ¶å¯¼èˆªæ‰€éœ€çš„å…¨å±€åœ°å›¾ï¼Œåœ°å›¾ç»˜åˆ¶å®ç°ï¼Œæœ‰ä¸¤ç§æ–¹å¼</p>
<ul>
<li>æ–¹å¼1ï¼šæ§åˆ¶æœºå™¨äººè¿åŠ¨ï¼Œå°†æœºå™¨äººä¼ æ„Ÿå™¨æ„ŸçŸ¥åˆ°çš„æ•°æ®æ—¶æ—¶å¤„ç†ï¼Œç”Ÿæˆåœ°å›¾ä¿¡æ¯</li>
<li>æ–¹å¼2ï¼šæ§åˆ¶æœºå™¨äººè¿åŠ¨ï¼Œå°†æœºå™¨äººä¼ æ„Ÿå™¨æ„ŸçŸ¥åˆ°çš„æ•°æ®ç•™å­˜ï¼Œäº‹åå†é‡æ–°è¯»å–æ•°æ®ï¼Œç”Ÿæˆåœ°å›¾ä¿¡æ¯</li>
</ul>
<p>ä¸¤ç§æ–¹å¼æ¯”è¾ƒï¼Œæ˜¾ç„¶æ–¹å¼2ä½¿ç”¨ä¸Šæ›´ä¸ºçµæ´»æ–¹ä¾¿</p>
<p>åœ¨ROSä¸­å…³äºæ•°æ®çš„ç•™å­˜ä»¥åŠè¯»å–å®ç°ï¼Œæä¾›äº†ä¸“é—¨çš„å·¥å…·: rosbag</p>
<p>rosbagæ˜¯ç”¨äºå½•åˆ¶å’Œå›æ”¾ ROS ä¸»é¢˜çš„ä¸€ä¸ªå·¥å…·é›†</p>
<p>æœ¬è´¨ä¹Ÿæ˜¯rosçš„èŠ‚ç‚¹ï¼Œå½“å½•åˆ¶æ—¶ï¼Œrosbagæ˜¯ä¸€ä¸ªè®¢é˜…èŠ‚ç‚¹ï¼Œå¯ä»¥è®¢é˜…è¯é¢˜æ¶ˆæ¯å¹¶å°†è®¢é˜…åˆ°çš„æ•°æ®å†™å…¥ç£ç›˜æ–‡ä»¶ï¼›å½“é‡æ”¾æ—¶ï¼Œrosbagæ˜¯ä¸€ä¸ªå‘å¸ƒèŠ‚ç‚¹ï¼Œå¯ä»¥è¯»å–ç£ç›˜æ–‡ä»¶ï¼Œå‘å¸ƒæ–‡ä»¶ä¸­çš„è¯é¢˜æ¶ˆæ¯</p>
<h4 id="é€šè¿‡å‘½ä»¤è¡Œ"><a href="#é€šè¿‡å‘½ä»¤è¡Œ" class="headerlink" title="é€šè¿‡å‘½ä»¤è¡Œ"></a>é€šè¿‡å‘½ä»¤è¡Œ</h4><p>åˆ›å»ºç›®å½•ä¿å­˜å½•åˆ¶çš„æ–‡ä»¶ æ¯”å¦‚æ ¹ç›®å½•ä¸‹åˆ›å»ºbsgsæ–‡ä»¶å¤¹</p>
<p>å¼€å§‹å½•åˆ¶ï¼ˆ-aæŒ‡çš„æ˜¯å…¨éƒ¨ï¼‰</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag record -a -O [bags/turtle.bag]</span><br></pre></td></tr></tbody></table></figure>

<p>æ“ä½œå°ä¹Œé¾Ÿä¸€æ®µæ—¶é—´ï¼Œç»“æŸå½•åˆ¶ä½¿ç”¨ ctrl + cï¼Œåœ¨åˆ›å»ºçš„ç›®å½•ä¸­ä¼šç”Ÿæˆbagæ–‡ä»¶</p>
<p>æ­¤æ—¶æ–‡ä»¶å‘½åä¸ºturtle_[æ—¶é—´æˆ³]</p>
<p>æŸ¥çœ‹æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag info [bags/turtle TAB]</span><br></pre></td></tr></tbody></table></figure>

<p>å›æ”¾æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosbag play [bags/turtle TAB]</span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rosrun rosbag play [bags/turtle TAB]</span><br></pre></td></tr></tbody></table></figure>

<p>é‡å¯ä¹Œé¾ŸèŠ‚ç‚¹ï¼Œä¼šå‘ç°ï¼Œä¹Œé¾ŸæŒ‰ç…§å½•åˆ¶æ—¶çš„è½¨è¿¹è¿åŠ¨</p>
<h4 id="é€šè¿‡ç¼–ç "><a href="#é€šè¿‡ç¼–ç " class="headerlink" title="é€šè¿‡ç¼–ç "></a>é€šè¿‡ç¼–ç </h4><p><strong>c++</strong></p>
<p>å†™ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"rosbag/bag.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"std_msgs/String.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"bag_write"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line">    <span class="comment">// åˆ›å»ºrosbagå¯¹è±¡</span></span><br><span class="line">    rosbag::Bag bag;</span><br><span class="line">    <span class="comment">// æ‰“å¼€æ–‡ä»¶æµ</span></span><br><span class="line">    bag.<span class="built_in">open</span>(<span class="string">"hello.bag"</span>,rosbag::BagMode::Write);</span><br><span class="line">    <span class="comment">// å†™æ•°æ®</span></span><br><span class="line">    std_msgs::String msg;</span><br><span class="line">    msg.data = <span class="string">"hello xxx"</span>;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">        å‚æ•°1:è¯é¢˜</span></span><br><span class="line"><span class="comment">        å‚æ•°2:æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">        å‚æ•°3:æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    bag.<span class="built_in">write</span>(<span class="string">"/chatter"</span>,ros::Time::<span class="built_in">now</span>(),msg);</span><br><span class="line">    <span class="comment">// å…³é—­æ–‡ä»¶æµ(å…»æˆä¹ æƒ¯,æ‰“å¼€å†™å®Œå°±å†™å…³)</span></span><br><span class="line">    bag.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>è¯»ï¼š</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"rosbag/bag.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"rosbag/view.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"std_msgs/String.h"</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"std_msgs/Int32.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setlocale</span>(LC_ALL,<span class="string">""</span>);</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"bag_read"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»º bag å¯¹è±¡</span></span><br><span class="line">    rosbag::Bag bag;</span><br><span class="line">    <span class="comment">// æ‰“å¼€ bag æ–‡ä»¶</span></span><br><span class="line">    bag.<span class="built_in">open</span>(<span class="string">"hello.bag"</span>,rosbag::BagMode::Read);</span><br><span class="line">    <span class="comment">// è¯»æ•°æ®</span></span><br><span class="line">    <span class="comment">// å¯ä»¥å…ˆè·å–æ¶ˆæ¯çš„é›†åˆï¼Œå†è¿­ä»£å–å‡ºæ¶ˆæ¯çš„å­—æ®µ</span></span><br><span class="line">    <span class="comment">// forrange å¢å¼ºforå¾ªç¯</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;&amp;m : rosbag::<span class="built_in">View</span>(bag)) <span class="comment">// rosbag::View è§£æä¿¡æ¯</span></span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// è§£æ, å¯¹åº”çš„å‡½æ•°ç±»å‹å¯ä»¥çœ‹å‡½æ•°è¿”å›å€¼</span></span><br><span class="line">        std::string topic =  m.<span class="built_in">getTopic</span>();</span><br><span class="line">        ros::Time time = m.<span class="built_in">getTime</span>();</span><br><span class="line">        std_msgs::StringPtr p = m.<span class="built_in">instantiate</span>&lt;std_msgs::String&gt;();</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"è§£æçš„æ•°æ®ä¸º:è¯é¢˜:%s,æ—¶é—´æˆ³:%.2f,æ¶ˆæ¯:%s"</span>,</span><br><span class="line">                topic.<span class="built_in">c_str</span>(),</span><br><span class="line">                time.<span class="built_in">toSec</span>(),</span><br><span class="line">                p-&gt;data.<span class="built_in">c_str</span>());</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// å…³é—­æ–‡ä»¶æµ</span></span><br><span class="line">    bag.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>python</strong></p>
<p>å†™ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> rosbag</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	rospy.init_node(<span class="string">"write_bag_p"</span>)</span><br><span class="line">	<span class="comment"># åˆ›å»ºbagå¯¹è±¡å¹¶æ‰“å¼€æ•°æ®æµ</span></span><br><span class="line">	bag = rosbag.Bag(<span class="string">"hello_p.bag"</span>,<span class="string">'w'</span>) <span class="comment"># æ³¨æ„è¿™é‡Œæ˜¯'w'ï¼Œä¸æ˜¯åŒå¼•å·</span></span><br><span class="line">	<span class="comment"># å†™æ•°æ®</span></span><br><span class="line">	msg = String()</span><br><span class="line">	msg.data = <span class="string">"hello bag"</span></span><br><span class="line">	bag.write(<span class="string">"/chatter"</span>,msg)</span><br><span class="line">    <span class="comment"># å…³é—­æ•°æ®æµ</span></span><br><span class="line">	bag.close()</span><br></pre></td></tr></tbody></table></figure>

<p>è¯»ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> rospy</span><br><span class="line"><span class="keyword">import</span> rosbag</span><br><span class="line"><span class="keyword">from</span> std_msgs.msg <span class="keyword">import</span> String</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">	rospy.init_node(<span class="string">"read_bag_p"</span>)</span><br><span class="line">	<span class="comment"># åˆ›å»ºbagå¯¹è±¡å¹¶æ‰“å¼€æ•°æ®æµ</span></span><br><span class="line">	bag = rosbag.Bag(<span class="string">"hello_p.bag"</span>,<span class="string">'r'</span>)</span><br><span class="line">	<span class="comment"># è¯»æ•°æ®</span></span><br><span class="line">	msgs = bag.read_messages(topics=<span class="string">"/chatter"</span>)</span><br><span class="line">	<span class="keyword">for</span> topic,msg,time <span class="keyword">in</span> msgs: <span class="comment"># å°†è¿”å›çš„topic, message, timestampèµ‹åˆ°topic,msg,time</span></span><br><span class="line">		rospy.loginfo(<span class="string">"è¯é¢˜:%s,æ¶ˆæ¯:%s,æ—¶é—´:%s"</span>,topic,msg,time)</span><br><span class="line">	bag.close()</span><br></pre></td></tr></tbody></table></figure>

<h3 id="rqtå·¥å…·ç®±"><a href="#rqtå·¥å…·ç®±" class="headerlink" title="rqtå·¥å…·ç®±"></a>rqtå·¥å…·ç®±</h3><p>ROSåŸºäº QT æ¡†æ¶ï¼Œé’ˆå¯¹æœºå™¨äººå¼€å‘æä¾›äº†ä¸€ç³»åˆ—å¯è§†åŒ–çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·çš„é›†åˆå°±æ˜¯rqt</p>
<p>rqt å·¥å…·ç®±ç»„æˆæœ‰ä¸‰å¤§éƒ¨åˆ†</p>
<ul>
<li>rqtâ€”â€”æ ¸å¿ƒå®ç°ï¼Œå¼€å‘äººå‘˜æ— éœ€å…³æ³¨</li>
<li>rqt_common_pluginsâ€”â€”rqt ä¸­å¸¸ç”¨çš„å·¥å…·å¥—ä»¶</li>
<li>rqt_robot_pluginsâ€”â€”è¿è¡Œä¸­å’Œæœºå™¨äººäº¤äº’çš„æ’ä»¶(æ¯”å¦‚: rviz)</li>
</ul>
<h4 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h4><p>ä¸€èˆ¬åªè¦å®‰è£…çš„æ˜¯desktop-fullç‰ˆæœ¬å°±ä¼šè‡ªå¸¦å·¥å…·ç®±</p>
<p>å¦‚æœéœ€è¦å®‰è£…å¯ä»¥ä»¥å¦‚ä¸‹æ–¹å¼å®‰è£…</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-noetic-rqt</span><br><span class="line">sudo apt-get install ros-noetic-rqt-common-plugins</span><br></pre></td></tr></tbody></table></figure>

<p><code>rqt</code>çš„å¯åŠ¨æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>æ–¹å¼1ï¼šrqt</li>
<li>æ–¹å¼2ï¼šrosrun rqt_gui rqt_gui</li>
</ul>
<p>å¯åŠ¨ rqt ä¹‹åï¼Œå¯ä»¥é€šè¿‡ plugins æ·»åŠ æ‰€éœ€çš„æ’ä»¶</p>
<h4 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶" class="headerlink" title="å¸¸ç”¨æ’ä»¶"></a>å¸¸ç”¨æ’ä»¶</h4><ul>
<li>rqt_graphï¼šplugins/introspection/Node Graph or rqt_graph</li>
</ul>
<p>åœ†æ¡†æ˜¯èŠ‚ç‚¹ï¼Œæ–¹æ¡†æ˜¯è¯é¢˜ï¼Œç®­å¤´æ˜¯æ•°æ®çš„è®¢é˜…å‘å¸ƒæ–¹å‘</p>
<ul>
<li>rqt_consoleï¼šplugins/Logging/Console or rqt_console</li>
</ul>
<p>ROS ä¸­ç”¨äºæ˜¾ç¤ºå’Œè¿‡æ»¤æ—¥å¿—çš„å›¾å½¢åŒ–æ’ä»¶</p>
<p>ç¼–å†™ Node èŠ‚ç‚¹è¾“å‡ºå„ä¸ªçº§åˆ«çš„æ—¥å¿—ä¿¡æ¯</p>
<figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">"ros/ros.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">    ros::<span class="built_in">init</span>(argc,argv,<span class="string">"log_demo"</span>);</span><br><span class="line">    ros::NodeHandle nh;</span><br><span class="line"></span><br><span class="line">    <span class="function">ros::Rate <span class="title">r</span><span class="params">(<span class="number">0.3</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span> (ros::<span class="built_in">ok</span>())</span><br><span class="line">    {</span><br><span class="line">        <span class="built_in">ROS_DEBUG</span>(<span class="string">"Debug message d"</span>);</span><br><span class="line">        <span class="built_in">ROS_INFO</span>(<span class="string">"Info message oooo"</span>);</span><br><span class="line">        <span class="built_in">ROS_WARN</span>(<span class="string">"Warn message wwww"</span>);</span><br><span class="line">        <span class="built_in">ROS_ERROR</span>(<span class="string">"Erroe message EEEE"</span>);</span><br><span class="line">        <span class="built_in">ROS_FATAL</span>(<span class="string">"Fatal message FFFF"</span>);</span><br><span class="line">        r.<span class="built_in">sleep</span>();</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/01_rqt_consoleæ’ä»¶.webp" alt="01_rqt_consoleæ’ä»¶" style="zoom: 67%;">

<ul>
<li>rqt_plotï¼šplugins/Visualization/plot or rqt_plot</li>
</ul>
<p>å›¾å½¢ç»˜åˆ¶æ’ä»¶ï¼Œå¯ä»¥ä»¥ 2D ç»˜å›¾çš„æ–¹å¼ç»˜åˆ¶å‘å¸ƒåœ¨ topic ä¸Šçš„æ•°æ®</p>
<ul>
<li>rqt_bagï¼šplugins/Logging/Bag or rqt_bag</li>
</ul>
<p>å½•åˆ¶å’Œé‡æ”¾ bag æ–‡ä»¶çš„å›¾å½¢åŒ–æ’ä»¶</p>
<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/14rqt_bag_å½•åˆ¶.webp" alt="14rqt_bag_å½•åˆ¶" style="zoom: 50%;">

<img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/YJS1/15rqt_bag_å›æ”¾.webp" alt="15rqt_bag_å›æ”¾" style="zoom: 50%;">
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://yhblogs.cn">ä»Šå¤©ç¡å¤Ÿäº†å—</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://yhblogs.cn/posts/626062709.html">http://yhblogs.cn/posts/626062709.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://yhblogs.cn" target="_blank">ãŒã‚“ã°ã‚ã†</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%F0%9F%A4%96ROS/">ğŸ¤–ROS</a></div><div class="post_share"><div class="social-share" data-image="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/ros-logo.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/3254549402.html" title="ROSæœºå™¨äººç³»ç»Ÿ"><img class="cover" src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/wallhaven-1q83qg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ROSæœºå™¨äººç³»ç»Ÿ</div></div></a></div><div class="next-post pull-right"><a href="/posts/4024736854.html" title="OpenAIä½¿ç”¨æŒ‡å—"><img class="cover" src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/what-is-openai.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">OpenAIä½¿ç”¨æŒ‡å—</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/3894864178.html" title="ROS2ç†è®º"><img class="cover" src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/wallhaven-5g22q5_1920x1080_compressed.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-30</div><div class="title">ROS2ç†è®º</div></div></a></div><div><a href="/posts/3254549402.html" title="ROSæœºå™¨äººç³»ç»Ÿ"><img class="cover" src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/wallhaven-1q83qg.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-10</div><div class="title">ROSæœºå™¨äººç³»ç»Ÿ</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/b_2a1aef95f351a5f7ef72eb81e6838fd6.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">ä»Šå¤©ç¡å¤Ÿäº†å—</div><div class="author-info__description">ç›¸é‡æ˜¯æœ€å°å•ä½çš„å¥‡è¿¹</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">81</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">15</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">1</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/202206071549233.webp" target="_blank" title="QQ"><i class="iconfont icon-QQ"></i></a><a class="social-icon" href="https://wuyaohui06022.oss-cn-chengdu.aliyuncs.com/blogwebp/202206071549234.webp" target="_blank" title="å¾®ä¿¡"><i class="iconfont icon-weixin"></i></a><a class="social-icon" href="https://space.bilibili.com/277953459?spm_id_from=333.1007.0.0" target="_blank" title="bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="https://github.com/YaoHui-Wu06022" target="_blank" title="Github"><i class="iconfont icon-GitHub"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä¿æŒç†æ™ºï¼Œç›¸ä¿¡æ˜å¤©</div><div class="twopeople"><div class="twopeople"><div class="container" style="height:200px;"><canvas class="illo" width="800" height="800" style="max-width: 200px; max-height: 200px; touch-action: none; width: 640px; height: 640px;"></canvas></div> <script src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/twopeople1.js"></script> <script src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/zdog.dist.js"></script> <script id="rendered-js" src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/js/twopeople.js"></script> <style>.twopeople{margin:0;align-items:center;justify-content:center;text-align:center}canvas{display:block;margin:0 auto;cursor:move}</style></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.</span> <span class="toc-text">ä»£ç æ¨¡æ¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%88%9D%E8%AE%A4%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">ROSç¯å¢ƒæ­å»ºä¸åˆè®¤è¯†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ROS%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.</span> <span class="toc-text">ROSå®‰è£…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ROS%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">2.2.</span> <span class="toc-text">ROSé›†æˆå¼€å‘ç¯å¢ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%88%E7%AB%AF"><span class="toc-number">2.2.1.</span> <span class="toc-text">ç»ˆç«¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VScode"><span class="toc-number">2.2.2.</span> <span class="toc-text">VScode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#launch%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.3.</span> <span class="toc-text">launchæ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ROS%E6%9E%B6%E6%9E%84"><span class="toc-number">2.3.</span> <span class="toc-text">ROSæ¶æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.3.1.</span> <span class="toc-text">æ–‡ä»¶ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.2.</span> <span class="toc-text">æ–‡ä»¶ç³»ç»Ÿç›¸å…³å‘½ä»¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%9B%BE"><span class="toc-number">2.3.3.</span> <span class="toc-text">è®¡ç®—å›¾</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6"><span class="toc-number">3.</span> <span class="toc-text">ROSé€šä¿¡æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%9D%E9%A2%98%E9%80%9A%E4%BF%A1"><span class="toc-number">3.1.</span> <span class="toc-text">è¯é¢˜é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%96%87%E6%9C%AC"><span class="toc-number">3.1.1.</span> <span class="toc-text">æ™®é€šæ–‡æœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89msg"><span class="toc-number">3.1.2.</span> <span class="toc-text">è‡ªå®šä¹‰msg</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%80%9A%E4%BF%A1"><span class="toc-number">3.2.</span> <span class="toc-text">æœåŠ¡é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89srv"><span class="toc-number">3.2.1.</span> <span class="toc-text">è‡ªå®šä¹‰srv</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">3.3.</span> <span class="toc-text">å‚æ•°æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">3.4.</span> <span class="toc-text">å¸¸ç”¨å‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6%E5%AE%9E%E6%93%8D"><span class="toc-number">3.5.</span> <span class="toc-text">é€šä¿¡æœºåˆ¶å®æ“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D1-%E8%AF%9D%E9%A2%98%E5%8F%91%E5%B8%83"><span class="toc-number">3.5.1.</span> <span class="toc-text">å®æ“1 è¯é¢˜å‘å¸ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D2-%E8%AF%9D%E9%A2%98%E8%AE%A2%E9%98%85"><span class="toc-number">3.5.2.</span> <span class="toc-text">å®æ“2 è¯é¢˜è®¢é˜…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D3-%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8"><span class="toc-number">3.5.3.</span> <span class="toc-text">å®æ“3 æœåŠ¡è°ƒç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%93%8D4-%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.5.4.</span> <span class="toc-text">å®æ“4 å‚æ•°è®¾ç½®</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6%E6%AF%94%E8%BE%83"><span class="toc-number">3.6.</span> <span class="toc-text">é€šä¿¡æœºåˆ¶æ¯”è¾ƒ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6%E8%BF%9B%E9%98%B6"><span class="toc-number">4.</span> <span class="toc-text">ROSé€šä¿¡æœºåˆ¶è¿›é˜¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8API"><span class="toc-number">4.1.</span> <span class="toc-text">å¸¸ç”¨API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.1.</span> <span class="toc-text">åˆå§‹åŒ–å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%9D%E9%A2%98%E4%B8%8E%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.1.2.</span> <span class="toc-text">è¯é¢˜ä¸æœåŠ¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.3.</span> <span class="toc-text">å›è°ƒå‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4"><span class="toc-number">4.1.4.</span> <span class="toc-text">æ—¶é—´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%87%BD%E6%95%B0"><span class="toc-number">4.1.5.</span> <span class="toc-text">å…¶å®ƒå‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B4%E6%96%87%E4%BB%B6%E4%B8%8E%E6%BA%90%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">å¤´æ–‡ä»¶ä¸æºæ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%A4%B4%E6%96%87%E4%BB%B6%E8%B0%83%E7%94%A8"><span class="toc-number">4.2.1.</span> <span class="toc-text">è‡ªå®šä¹‰å¤´æ–‡ä»¶è°ƒç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%BA%90%E6%96%87%E4%BB%B6%E8%B0%83%E7%94%A8"><span class="toc-number">4.2.2.</span> <span class="toc-text">è‡ªå®šä¹‰æºæ–‡ä»¶è°ƒç”¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">Pythonæ¨¡å—å¯¼å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E8%BF%90%E8%A1%8C%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">ROSè¿è¡Œç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E5%8A%9F%E8%83%BD%E5%8C%85"><span class="toc-number">5.1.</span> <span class="toc-text">å…ƒåŠŸèƒ½åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#launch%E6%96%87%E4%BB%B6-1"><span class="toc-number">5.2.</span> <span class="toc-text">launchæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4%E8%A6%86%E7%9B%96"><span class="toc-number">5.3.</span> <span class="toc-text">å·¥ä½œç©ºé—´è¦†ç›–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E5%90%8D%E7%A7%B0%E9%87%8D%E5%90%8D"><span class="toc-number">5.4.</span> <span class="toc-text">èŠ‚ç‚¹åç§°é‡å</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rosrun%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.4.1.</span> <span class="toc-text">rosrunå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#launch%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.4.2.</span> <span class="toc-text">launchå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.4.3.</span> <span class="toc-text">ç¼–ç å®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%9D%E9%A2%98%E5%90%8D%E7%A7%B0%E9%87%8D%E5%90%8D"><span class="toc-number">5.5.</span> <span class="toc-text">è¯é¢˜åç§°é‡å</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rosrun%E5%AE%9E%E7%8E%B0-1"><span class="toc-number">5.5.1.</span> <span class="toc-text">rosrunå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#launch%E5%AE%9E%E7%8E%B0-1"><span class="toc-number">5.5.2.</span> <span class="toc-text">launchå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0-1"><span class="toc-number">5.5.3.</span> <span class="toc-text">ç¼–ç å®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%90%8D%E7%A7%B0%E9%87%8D%E5%90%8D"><span class="toc-number">5.6.</span> <span class="toc-text">å‚æ•°åç§°é‡å</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#rosrun%E5%AE%9E%E7%8E%B0-2"><span class="toc-number">5.6.1.</span> <span class="toc-text">rosrunå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#launch%E5%AE%9E%E7%8E%B0-2"><span class="toc-number">5.6.2.</span> <span class="toc-text">launchå®ç°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E5%AE%9E%E7%8E%B0-2"><span class="toc-number">5.6.3.</span> <span class="toc-text">ç¼–ç å®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%80%9A%E4%BF%A1"><span class="toc-number">5.7.</span> <span class="toc-text">åˆ†å¸ƒå¼é€šä¿¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROS%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text">ROSå¸¸ç”¨ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TF%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">6.1.</span> <span class="toc-text">TFåæ ‡å˜æ¢</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%90%E6%A0%87msg%E6%B6%88%E6%81%AF"><span class="toc-number">6.1.1.</span> <span class="toc-text">åæ ‡msgæ¶ˆæ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">6.1.2.</span> <span class="toc-text">é™æ€åæ ‡å˜æ¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2"><span class="toc-number">6.1.3.</span> <span class="toc-text">åŠ¨æ€åæ ‡å˜æ¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%9D%90%E6%A0%87%E7%B3%BB%E5%8F%98%E6%8D%A2"><span class="toc-number">6.1.4.</span> <span class="toc-text">å¤šåæ ‡ç³»å˜æ¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E7%B3%BB%E5%85%B3%E7%B3%BB%E6%9F%A5%E7%9C%8B"><span class="toc-number">6.1.5.</span> <span class="toc-text">åæ ‡ç³»å…³ç³»æŸ¥çœ‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9D%90%E6%A0%87%E5%8F%98%E6%8D%A2%E5%AE%9E%E6%93%8D"><span class="toc-number">6.1.6.</span> <span class="toc-text">åæ ‡å˜æ¢å®æ“</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rosbag"><span class="toc-number">6.2.</span> <span class="toc-text">rosbag</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E8%A1%8C"><span class="toc-number">6.2.1.</span> <span class="toc-text">é€šè¿‡å‘½ä»¤è¡Œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E7%BC%96%E7%A0%81"><span class="toc-number">6.2.2.</span> <span class="toc-text">é€šè¿‡ç¼–ç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rqt%E5%B7%A5%E5%85%B7%E7%AE%B1"><span class="toc-number">6.3.</span> <span class="toc-text">rqtå·¥å…·ç®±</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">6.3.1.</span> <span class="toc-text">åŸºæœ¬ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6"><span class="toc-number">6.3.2.</span> <span class="toc-text">å¸¸ç”¨æ’ä»¶</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">Â©2022 - 2026 By ä»Šå¤©ç¡å¤Ÿäº†å—</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">You must always have faith in who you areï¼</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async="async" mobile="false"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>